var SnippetLogin=function(){var e=$("#m_login"),a=function(e,a,i){var t=$('<div class="m-alert m-alert--outline alert alert-'+a+' alert-dismissible" role="alert">\t\t\t<button type="button" class="close" data-dismiss="alert" aria-label="Close"></button>\t\t\t<span></span>\t\t</div>');e.find(".alert").remove(),t.prependTo(e),mUtil.animateClass(t[0],"fadeIn animated"),t.find("span").html(i)},i=function(e,a){e.removeClass("has-danger"),e.addClass("has-danger");var i=$('<div class = "form-control-feedback">'+a+"</div>");e.find(".form-control-feedback").remove(),i.appendTo(e),mUtil.animateClass(i[0],"fadeIn animated")},t=function(){e.removeClass("m-login--forget-password"),e.removeClass("m-login--signup"),e.addClass("m-login--signin"),mUtil.animateClass(e.find(".m-login__signin")[0],"flipInX animated")},o=function(){$("#m_login_forget_password").click(function(a){a.preventDefault(),e.removeClass("m-login--signin"),e.removeClass("m-login--signup"),e.addClass("m-login--forget-password"),mUtil.animateClass(e.find(".m-login__forget-password")[0],"flipInX animated")}),$("#m_login_forget_password_cancel").click(function(e){e.preventDefault(),t()}),$("#m_login_signup").click(function(a){a.preventDefault(),e.removeClass("m-login--forget-password"),e.removeClass("m-login--signin"),e.addClass("m-login--signup"),mUtil.animateClass(e.find(".m-login__signup")[0],"flipInX animated")}),$("#m_login_signup_cancel").click(function(e){e.preventDefault(),t()})},r=function(){$("#m_login_signin_submit").click(function(e){e.preventDefault();var t=$(this),o=$(this).closest("form"),r=$("#m-login__form_mobile"),l=$("#m-login__form_code");o.validate({rules:{mobile:{required:!0},password:{required:!0}}}),o.valid()&&(t.addClass("m-loader m-loader--right m-loader--light").attr("disabled",!0),o.ajaxSubmit({url:o.attr("action"),success:function(e,a,i,o){setTimeout(function(){var a;t.removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1),1===e.status&&(a=e.redirectTo,window.location.replace(a))},2e3)},error:function(e){var n=e.responseJSON.errors;setTimeout(function(){t.removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1),a(o,"danger","خطا در ورود اطلاعات!"),console.debug(n.nationalCode),void 0!==n.nationalCode&&i(l,n.nationalCode[0]),void 0!==n.mobile&&i(r,n.mobile[0])},2e3)}}))})};return{init:function(){o(),r(),$("#m_login_signup_submit").click(function(i){i.preventDefault();var o=$(this),r=$(this).closest("form");r.validate({rules:{fullname:{required:!0},email:{required:!0,email:!0},password:{required:!0},rpassword:{required:!0},agree:{required:!0}}}),r.valid()&&(o.addClass("m-loader m-loader--right m-loader--light").attr("disabled",!0),r.ajaxSubmit({url:r.attr("action"),success:function(i,l,n,s){setTimeout(function(){o.removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1),r.clearForm(),r.validate().resetForm(),t();var i=e.find(".m-login__signin form");i.clearForm(),i.validate().resetForm(),a(i,"success","Thank you. To complete your registration please check your email.")},2e3)}}))}),$("#m_login_forget_password_submit").click(function(i){i.preventDefault();var o=$(this),r=$(this).closest("form");r.validate({rules:{email:{required:!0,email:!0}}}),r.valid()&&(o.addClass("m-loader m-loader--right m-loader--light").attr("disabled",!0),r.ajaxSubmit({url:r.attr("action"),success:function(i,l,n,s){setTimeout(function(){o.removeClass("m-loader m-loader--right m-loader--light").attr("disabled",!1),r.clearForm(),r.validate().resetForm(),t();var i=e.find(".m-login__signin form");i.clearForm(),i.validate().resetForm(),a(i,"success","Cool! Password recovery instruction has been sent to your email.")},2e3)}}))})}}}();jQuery(document).ready(function(){SnippetLogin.init()});
