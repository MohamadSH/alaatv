var MultiLevelSearch=function(){var e=[],t="";function l(e){return $("#"+t+' .selectorItem[data-select-order="'+e+'"]')}function c(e){return $("#"+t+' .selectorItem[data-select-order="'+e+'"] .subItem')}function a(a){var r=l(a);if(0===r.length)return n(a),!1;e.fadeOut(0);var s=r.data("select-title"),o=r.data("select-display");if(void 0===o&&(o=c(a).length>10?"select2":"grid",r.attr("data-select-display",o)),"grid"===o)r.find(".selectorItemTitle").length>0?r.find(".selectorItemTitle").html(s):r.prepend('<div class="col-12 selectorItemTitle">'+s+"</div>"),r.length>0&&r.fadeIn();else if("select2"===o){var i=c(a);i.fadeOut(0);var d="",v="MultiLevelSearch-select2-"+t+"-"+a;for(var u in r.find(".selectorItemTitle").length>0?r.find(".selectorItemTitle").html(s):r.prepend('<div class="col-12 selectorItemTitle">'+s+"</div>"),i)if(!isNaN(u)){var f="";"selected"===$(i[u]).attr("selected")&&(f='selected="selected"'),d+='<option value="'+i[u].innerHTML+'" '+f+">"+i[u].innerHTML+"</option>"}if(r.find(".form-control.select2").length>0){var m=$("#"+v);m.data("select2")||m.select2("destroy"),r.find(".select2warper").remove(),r.append('<div class="col-12 col-sm-9 col-md-5 col-lg-4 select2warper"><div><select class="form-control select2" id="'+v+'">'+d+"</select></div></div>"),$("#"+v).select2({closeOnSelect:!0}).on("select2:select",function(e){$(".a--multi-level-search select").select2("close")}).on("select2:close",function(e){$(".a--multi-level-search select").select2("close")}),r.fadeIn()}else r.append('<div class="col-12 col-sm-9 col-md-5 col-lg-4 select2warper"><div><select class="form-control select2" id="'+v+'">'+d+"</select></div></div>"),$("#"+v).select2({closeOnSelect:!0}).on("select2:select",function(e){$(".a--multi-level-search select").select2("destroy"),$(".a--multi-level-search select").select2({closeOnSelect:!0}),$(".a--multi-level-search select").select2("close"),$(".a--multi-level-search select").select2("close")}).on("select2:close",function(e){$(".a--multi-level-search select").select2("destroy"),$(".a--multi-level-search select").select2({closeOnSelect:!0}),$(".a--multi-level-search select").select2("close"),$(".a--multi-level-search select").select2("close")}),r.fadeIn()}n(a)}function r(e,t){l(e).attr("data-select-value",t)}function s(e){var t=l(e).attr("data-select-value");return void 0!==t?t:null}function o(){return $("#"+t+' .selectorItem[data-select-active="true"]').length>0?parseInt($("#"+t+' .selectorItem[data-select-active="true"]').data("select-order")):0}function i(e){$("#"+t+" .selectorItem").attr("data-select-active","false"),l(e).attr("data-select-active","true")}function n(l){var c=$("#"+t+" .filterNavigationWarper");for(var a in c.html(""),e=$("#"+t+" .selectorItem"))if(!isNaN(a)){var o=$(e[a]).data("select-title"),i=$(e[a]).data("select-order"),n="deactive";parseInt(i)<parseInt(l)?n="active":parseInt(i)===parseInt(l)?n="current":r(i,"");var d="";"deactive"===n&&$(e[a]).attr("data-select-value",""),null!==(d=s(i))&&0!==d.trim().length||(d=o),"current"===n&&(d="(انتخاب "+o+")"),c.append('<li class="filterNavigationStep '+n+'" data-select-order="'+i+'">'+d+"</li>")}}function d(t,l){void 0!==l.selector&&void 0!==l.selector[t]&&void 0!==l.selector[t].ajax&&null!==l.selector[t].ajax||(a(parseInt(t)+1),function(){var t=0;for(var l in e)if(!isNaN(l)){var c=parseInt($(e[l]).data("select-order"));t<c&&(t=c)}return t}()>=parseInt(t)+1&&i(parseInt(t)+1))}return{init:function(l,c,r){var s,n=$("#"+l.selectorId);n.fadeOut(0),s=l.selectorId,t=s,e=$("#"+t+" .selectorItem"),a(o()),$(document).on("click","#"+l.selectorId+" .selectorItem .subItem",function(){var e=$(this).parents(".selectorItem"),t=e.data("select-order");e.attr("data-select-value",$(this).html());var a={selectorOrder:t,selectorType:"grid"};r(a),d(t,l),c(a)}),$(document).on("change","#"+l.selectorId+" .selectorItem .select2",function(){var e=$(this).parents(".selectorItem"),t=e.data("select-order");e.attr("data-select-value",$(this).select2("data")[0].text.trim());var a={selectorOrder:t,selectorType:"select2"};r(a),d(t,l),c(a)}),$(document).on("click","#"+l.selectorId+" .filterNavigationStep",function(){!function(e,t){void 0!==t.selector&&void 0!==t.selector[e]&&void 0!==t.selector[e].ajax&&null!==t.selector[e].ajax||e<o()&&(a(parseInt(e)),i(e))}($(this).data("select-order"),l),c("click on filterNavigationStep")}),n.fadeIn()},getSelectedData:function(){return function(){var l=[];for(var c in e=$("#"+t+" .selectorItem"))if(!isNaN(c)){var a=e[c],r=$(a).data("select-title"),s=$(a).data("select-order"),o=$(a).attr("data-select-value"),i=$(a).attr("data-select-active"),n=null;void 0!==o&&void 0!==i&&"true"!==i&&(n=o),l.push({title:r,order:s,selectedText:n})}return l}()}}}();
