var MultiLevelSearch=function(){var e=[],t="";function l(e){return $("#"+t+' .selectorItem[data-select-order="'+e+'"]')}function c(e){return $("#"+t+' .selectorItem[data-select-order="'+e+'"] .subItem')}function a(a){var s=l(a);if(0===s.length)return d(a),!1;e.fadeOut(0);var r=s.data("select-title"),o=s.data("select-display");if(void 0===o&&(o=c(a).length>10?"select2":"grid",s.attr("data-select-display",o)),"grid"===o)s.find(".selectorItemTitle").length>0?s.find(".selectorItemTitle").html(r):s.prepend('<div class="col-12 selectorItemTitle">'+r+"</div>"),s.length>0&&s.fadeIn();else if("select2"===o){var i=c(a);i.fadeOut(0);var n="",v="MultiLevelSearch-select2-"+t+"-"+a;for(var u in s.find(".selectorItemTitle").length>0?s.find(".selectorItemTitle").html(r):s.prepend('<div class="col-12 selectorItemTitle">'+r+"</div>"),i)if(!isNaN(u)){var f="";"selected"===$(i[u]).attr("selected")&&(f='selected="selected"'),n+='<option value="'+i[u].innerHTML+'" '+f+">"+i[u].innerHTML+"</option>"}if(s.find(".form-control.select2").length>0){var m=$("#"+v);m.data("select2")||m.select2("destroy"),s.find(".select2warper").remove(),s.append('<div class="col-12 col-sm-9 col-md-7 col-lg-6 select2warper"><div><select class="form-control select2" id="'+v+'">'+n+"</select></div></div>"),$("#"+v).select2({closeOnSelect:!0}).on("select2:select",function(e){$(".a--multi-level-search select").select2("close")}).on("select2:close",function(e){$(".a--multi-level-search select").select2("destroy"),$(".a--multi-level-search select").select2({closeOnSelect:!0}),$(".a--multi-level-search select").select2("close"),$(".a--multi-level-search select").select2("close")}),s.fadeIn()}else s.append('<div class="col-12 col-sm-9 col-md-7 col-lg-6 select2warper"><div><select class="form-control select2" id="'+v+'">'+n+"</select></div></div>"),$("#"+v).select2({closeOnSelect:!0}).on("select2:select",function(e){$(".a--multi-level-search select").select2("destroy"),$(".a--multi-level-search select").select2({closeOnSelect:!0}),$(".a--multi-level-search select").select2("close"),$(".a--multi-level-search select").select2("close")}).on("select2:close",function(e){$(".a--multi-level-search select").select2("destroy"),$(".a--multi-level-search select").select2({closeOnSelect:!0}),$(".a--multi-level-search select").select2("close"),$(".a--multi-level-search select").select2("close")}),s.fadeIn()}d(a)}function s(e,t){l(e).attr("data-select-value",t)}function r(e){var t=l(e).attr("data-select-value");return void 0!==t?t:null}function o(){return $("#"+t+' .selectorItem[data-select-active="true"]').length>0?parseInt($("#"+t+' .selectorItem[data-select-active="true"]').data("select-order")):0}function i(e){$("#"+t+" .selectorItem").attr("data-select-active","false"),l(e).attr("data-select-active","true")}function n(){var t=0;for(var l in e)if(!isNaN(l)){var c=parseInt($(e[l]).data("select-order"));t<c&&(t=c)}return t}function d(l){var c=$("#"+t+" .filterNavigationWarper");for(var a in c.html(""),e=$("#"+t+" .selectorItem"))if(!isNaN(a)){var o=$(e[a]).data("select-title"),i=$(e[a]).data("select-order"),n="deactive";parseInt(i)<parseInt(l)?n="active":parseInt(i)===parseInt(l)?n="current":s(i,"");var d="";"deactive"===n&&$(e[a]).attr("data-select-value",""),null!==(d=r(i))&&0!==d.trim().length||(d=o),"current"===n&&(d="(انتخاب "+o+")"),c.append('<li class="filterNavigationStep '+n+'" data-select-order="'+i+'">'+d+"</li>")}}function v(e,t){void 0!==t.selector&&void 0!==t.selector[e]&&void 0!==t.selector[e].ajax&&null!==t.selector[e].ajax||(a(parseInt(e)+1),n()>=parseInt(e)+1&&i(parseInt(e)+1))}return{init:function(l,c,s){var r,n=$("#"+l.selectorId);n.fadeOut(0),r=l.selectorId,t=r,e=$("#"+t+" .selectorItem"),a(o()),$(document).on("click","#"+l.selectorId+" .selectorItem .subItem",function(){var e=$(this).parents(".selectorItem"),t=e.data("select-order");e.attr("data-select-value",$(this).html());var a={selectorOrder:t,selectorType:"grid"};s(a),v(t,l),c(a)}),$(document).on("change","#"+l.selectorId+" .selectorItem .select2",function(){var e=$(this).parents(".selectorItem"),t=e.data("select-order");e.attr("data-select-value",$(this).select2("data")[0].text.trim());var a={selectorOrder:t,selectorType:"select2"};s(a),v(t,l),c(a)}),$(document).on("click","#"+l.selectorId+" .filterNavigationStep",function(){!function(e,t){void 0!==t.selector&&void 0!==t.selector[e]&&void 0!==t.selector[e].ajax&&null!==t.selector[e].ajax||e<o()&&(a(parseInt(e)),i(e))}($(this).data("select-order"),l),c("click on filterNavigationStep")}),n.fadeIn()},getSelectedData:function(){return function(){var l=[];for(var c in e=$("#"+t+" .selectorItem"))if(!isNaN(c)){var a=e[c],s=$(a).data("select-title"),r=$(a).data("select-order"),o=$(a).attr("data-select-value"),i=$(a).attr("data-select-active"),d=null;void 0===o||void 0===i||"true"===i&&n()!==r||(d=o),l.push({title:s,order:r,selectedText:d})}return l}()}}}();
