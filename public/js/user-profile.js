!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){"use strict";var t,i;e.fn.fileinputLocales={},e.fn.fileinputThemes={},String.prototype.setTokens=function(e){var t,i,a=this.toString();for(t in e)e.hasOwnProperty(t)&&(i=new RegExp("{"+t+"}","g"),a=a.replace(i,e[t]));return a},t={FRAMES:".kv-preview-thumb",SORT_CSS:"file-sortable",OBJECT_PARAMS:'<param name="controller" value="true" />\n<param name="allowFullScreen" value="true" />\n<param name="allowScriptAccess" value="always" />\n<param name="autoPlay" value="false" />\n<param name="autoStart" value="false" />\n<param name="quality" value="high" />\n',DEFAULT_PREVIEW:'<div class="file-preview-other">\n<span class="{previewFileIconClass}">{previewFileIcon}</span>\n</div>',MODAL_ID:"kvFileinputModal",MODAL_EVENTS:["show","shown","hide","hidden","loaded"],objUrl:window.URL||window.webkitURL,createObjectURL:function(e){return t.objUrl&&t.objUrl.createObjectURL&&e?t.objUrl.createObjectURL(e):""},revokeObjectURL:function(e){t.objUrl&&t.objUrl.revokeObjectURL&&e&&t.objUrl.revokeObjectURL(e)},compare:function(e,t,i){return void 0!==e&&(i?e===t:e.match(t))},isIE:function(e){var t,i;return"Microsoft Internet Explorer"===navigator.appName&&(10===e?new RegExp("msie\\s"+e,"i").test(navigator.userAgent):((t=document.createElement("div")).innerHTML="\x3c!--[if IE "+e+"]> <i></i> <![endif]--\x3e",i=t.getElementsByTagName("i").length,document.body.appendChild(t),t.parentNode.removeChild(t),i))},canAssignFilesToInput:function(){var e=document.createElement("input");try{return e.type="file",e.files=null,!0}catch(e){return!1}},getDragDropFolders:function(e){var t,i,a=e?e.length:0,n=0;if(a>0&&e[0].webkitGetAsEntry())for(t=0;t<a;t++)(i=e[t].webkitGetAsEntry())&&i.isDirectory&&n++;return n},initModal:function(t){var i=e("body");i.length&&t.appendTo(i)},isEmpty:function(t,i){return null==t||0===t.length||i&&""===e.trim(t)},isArray:function(e){return Array.isArray(e)||"[object Array]"===Object.prototype.toString.call(e)},ifSet:function(e,t,i){return i=i||"",t&&"object"==typeof t&&e in t?t[e]:i},cleanArray:function(e){return e instanceof Array||(e=[]),e.filter(function(e){return null!=e})},spliceArray:function(t,i,a){var n,r,o=0,s=[];if(!(t instanceof Array))return[];for(r=e.extend(!0,[],t),a&&r.reverse(),n=0;n<r.length;n++)n!==i&&(s[o]=r[n],o++);return a&&s.reverse(),s},getNum:function(e,t){return t=t||0,"number"==typeof e?e:("string"==typeof e&&(e=parseFloat(e)),isNaN(e)?t:e)},hasFileAPISupport:function(){return!(!window.File||!window.FileReader)},hasDragDropSupport:function(){var e=document.createElement("div");return!t.isIE(9)&&(void 0!==e.draggable||void 0!==e.ondragstart&&void 0!==e.ondrop)},hasFileUploadSupport:function(){return t.hasFileAPISupport()&&window.FormData},hasBlobSupport:function(){try{return!!window.Blob&&Boolean(new Blob)}catch(e){return!1}},hasArrayBufferViewSupport:function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}},dataURI2Blob:function(e){var i,a,n,r,o,s,l=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,d=t.hasBlobSupport();if(!((d||l)&&window.atob&&window.ArrayBuffer&&window.Uint8Array))return null;for(i=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):decodeURIComponent(e.split(",")[1]),a=new ArrayBuffer(i.length),n=new Uint8Array(a),r=0;r<i.length;r+=1)n[r]=i.charCodeAt(r);return o=e.split(",")[0].split(":")[1].split(";")[0],d?new Blob([t.hasArrayBufferViewSupport()?n:a],{type:o}):((s=new l).append(a),s.getBlob(o))},arrayBuffer2String:function(e){if(window.TextDecoder)return new TextDecoder("utf-8").decode(e);var t,i,a,n,r=Array.prototype.slice.apply(new Uint8Array(e)),o="",s=0;for(t=r.length;s<t;)switch((i=r[s++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(i);break;case 12:case 13:a=r[s++],o+=String.fromCharCode((31&i)<<6|63&a);break;case 14:a=r[s++],n=r[s++],o+=String.fromCharCode((15&i)<<12|(63&a)<<6|(63&n)<<0)}return o},isHtml:function(e){var t=document.createElement("div");t.innerHTML=e;for(var i=t.childNodes,a=i.length;a--;)if(1===i[a].nodeType)return!0;return!1},isSvg:function(e){return e.match(/^\s*<\?xml/i)&&(e.match(/<!DOCTYPE svg/i)||e.match(/<svg/i))},getMimeType:function(e,t,i){switch(e){case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":return"image/jpeg";case"89504E47":return"image/png";case"47494638":return"image/gif";case"49492a00":return"image/tiff";case"52494646":return"image/webp";case"66747970":return"video/3gp";case"4f676753":return"video/ogg";case"1a45dfa3":return"video/mkv";case"000001ba":case"000001b3":return"video/mpeg";case"3026b275":return"video/wmv";case"25504446":return"application/pdf";case"25215053":return"application/ps";case"504b0304":case"504b0506":case"504b0508":return"application/zip";case"377abcaf":return"application/7z";case"75737461":return"application/tar";case"7801730d":return"application/dmg";default:switch(e.substring(0,6)){case"435753":return"application/x-shockwave-flash";case"494433":return"audio/mp3";case"425a68":return"application/bzip";default:switch(e.substring(0,4)){case"424d":return"image/bmp";case"fffb":return"audio/mp3";case"4d5a":return"application/exe";case"1f9d":case"1fa0":return"application/zip";case"1f8b":return"application/gzip";default:return t&&!t.match(/[^\u0000-\u007f]/)?"application/text-plain":i}}}},addCss:function(e,t){e.removeClass(t).addClass(t)},getElement:function(i,a,n){return t.isEmpty(i)||t.isEmpty(i[a])?n:e(i[a])},uniqId:function(){return Math.round((new Date).getTime())+"_"+Math.round(100*Math.random())},htmlEncode:function(e,t){return void 0===e?t||null:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},replaceTags:function(t,i){var a=t;return i?(e.each(i,function(e,t){"function"==typeof t&&(t=t()),a=a.split(e).join(t)}),a):a},cleanMemory:function(e){var i=e.is("img")?e.attr("src"):e.find("source").attr("src");t.revokeObjectURL(i)},findFileName:function(e){var t=e.lastIndexOf("/");return-1===t&&(t=e.lastIndexOf("\\")),e.split(e.substring(t,t+1)).pop()},checkFullScreen:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},toggleFullScreen:function(e){var i=document,a=i.documentElement;a&&e&&!t.checkFullScreen()?a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):i.exitFullscreen?i.exitFullscreen():i.msExitFullscreen?i.msExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.webkitExitFullscreen&&i.webkitExitFullscreen()},moveArray:function(t,i,a,n){var r=e.extend(!0,[],t);if(n&&r.reverse(),a>=r.length)for(var o=a-r.length;1+o--;)r.push(void 0);return r.splice(a,0,r.splice(i,1)[0]),n&&r.reverse(),r},cleanZoomCache:function(e){var t=e.closest(".kv-zoom-cache-theme");t.length||(t=e.closest(".kv-zoom-cache")),t.remove()},closeButton:function(e){return'<button type="button" class="'+(e=e?"close "+e:"close")+'" aria-label="Close">\n  <span aria-hidden="true">&times;</span>\n</button>'},getRotation:function(e){switch(e){case 2:return"rotateY(180deg)";case 3:return"rotate(180deg)";case 4:return"rotate(180deg) rotateY(180deg)";case 5:return"rotate(270deg) rotateY(180deg)";case 6:return"rotate(90deg)";case 7:return"rotate(90deg) rotateY(180deg)";case 8:return"rotate(270deg)";default:return""}},setTransform:function(e,t){e&&(e.style.transform=t,e.style.webkitTransform=t,e.style["-moz-transform"]=t,e.style["-ms-transform"]=t,e.style["-o-transform"]=t)},setImageOrientation:function(e,i,a){if(e&&e.length){var n="load.fileinputimageorient";e.off(n).on(n,function(){var n=e.get(0),r=i&&i.length?i.get(0):null,o=n.offsetHeight,s=n.offsetWidth,l=t.getRotation(a);if(e.data("orientation",a),r&&i.data("orientation",a),a<5)return t.setTransform(n,l),void t.setTransform(r,l);var d=Math.atan(s/o),h=Math.sqrt(Math.pow(o,2)+Math.pow(s,2)),c=h?o/Math.cos(Math.PI/2+d)/h:1,u=" scale("+Math.abs(c)+")";t.setTransform(n,l+u),t.setTransform(r,l+u)})}}},(i=function(i,a){this.$element=e(i),this.$parent=this.$element.parent(),this._validate()&&(this.isPreviewable=t.hasFileAPISupport(),this.isIE9=t.isIE(9),this.isIE10=t.isIE(10),(this.isPreviewable||this.isIE9)&&(this._init(a),this._listen()),this.$element.removeClass("file-loading"))}).prototype={constructor:i,_cleanup:function(){this.reader=null,this.formdata={},this.uploadCount=0,this.uploadStatus={},this.uploadLog=[],this.uploadAsyncCount=0,this.loadedImages=[],this.totalImagesCount=0,this.ajaxRequests=[],this.clearStack(),this.fileBatchCompleted=!0,this.isPreviewable||(this.showPreview=!1),this.isError=!1,this.ajaxAborted=!1,this.cancelling=!1},_init:function(i,a){var n,r,o,s,l=this,d=l.$element;l.options=i,e.each(i,function(e,i){switch(e){case"minFileCount":case"maxFileCount":case"minFileSize":case"maxFileSize":case"maxFilePreviewSize":case"resizeImageQuality":case"resizeIfSizeMoreThan":case"progressUploadThreshold":case"initialPreviewCount":case"zoomModalHeight":case"minImageHeight":case"maxImageHeight":case"minImageWidth":case"maxImageWidth":l[e]=t.getNum(i);break;default:l[e]=i}}),l.rtl&&(s=l.previewZoomButtonIcons.prev,l.previewZoomButtonIcons.prev=l.previewZoomButtonIcons.next,l.previewZoomButtonIcons.next=s),a||l._cleanup(),l.$form=d.closest("form"),l._initTemplateDefaults(),l.uploadFileAttr=t.isEmpty(d.attr("name"))?"file_data":d.attr("name"),o=l._getLayoutTemplate("progress"),l.progressTemplate=o.replace("{class}",l.progressClass),l.progressCompleteTemplate=o.replace("{class}",l.progressCompleteClass),l.progressErrorTemplate=o.replace("{class}",l.progressErrorClass),l.isDisabled=d.attr("disabled")||d.attr("readonly"),l.isDisabled&&d.attr("disabled",!0),l.isClickable=l.browseOnZoneClick&&l.showPreview&&(l.dropZoneEnabled||!t.isEmpty(l.defaultPreviewContent)),l.isAjaxUpload=t.hasFileUploadSupport()&&!t.isEmpty(l.uploadUrl),l.dropZoneEnabled=t.hasDragDropSupport()&&l.dropZoneEnabled,l.isAjaxUpload||(l.dropZoneEnabled=l.dropZoneEnabled&&t.canAssignFilesToInput()),l.slug="function"==typeof i.slugCallback?i.slugCallback:l._slugDefault,l.mainTemplate=l.showCaption?l._getLayoutTemplate("main1"):l._getLayoutTemplate("main2"),l.captionTemplate=l._getLayoutTemplate("caption"),l.previewGenericTemplate=l._getPreviewTemplate("generic"),!l.imageCanvas&&l.resizeImage&&(l.maxImageWidth||l.maxImageHeight)&&(l.imageCanvas=document.createElement("canvas"),l.imageCanvasContext=l.imageCanvas.getContext("2d")),t.isEmpty(d.attr("id"))&&d.attr("id",t.uniqId()),l.namespace=".fileinput_"+d.attr("id").replace(/-/g,"_"),void 0===l.$container?l.$container=l._createContainer():l._refreshContainer(),r=l.$container,l.$dropZone=r.find(".file-drop-zone"),l.$progress=r.find(".kv-upload-progress"),l.$btnUpload=r.find(".fileinput-upload"),l.$captionContainer=t.getElement(i,"elCaptionContainer",r.find(".file-caption")),l.$caption=t.getElement(i,"elCaptionText",r.find(".file-caption-name")),t.isEmpty(l.msgPlaceholder)||(n=d.attr("multiple")?l.filePlural:l.fileSingle,l.$caption.attr("placeholder",l.msgPlaceholder.replace("{files}",n))),l.$captionIcon=l.$captionContainer.find(".file-caption-icon"),l.$previewContainer=t.getElement(i,"elPreviewContainer",r.find(".file-preview")),l.$preview=t.getElement(i,"elPreviewImage",r.find(".file-preview-thumbnails")),l.$previewStatus=t.getElement(i,"elPreviewStatus",r.find(".file-preview-status")),l.$errorContainer=t.getElement(i,"elErrorContainer",l.$previewContainer.find(".kv-fileinput-error")),l._validateDisabled(),t.isEmpty(l.msgErrorClass)||t.addCss(l.$errorContainer,l.msgErrorClass),a?l._errorsExist()||l.$errorContainer.hide():(l.$errorContainer.hide(),l.previewInitId="preview-"+t.uniqId(),l._initPreviewCache(),l._initPreview(!0),l._initPreviewActions(),l.$parent.hasClass("file-loading")&&(l.$container.insertBefore(l.$parent),l.$parent.remove())),l._setFileDropZoneTitle(),d.attr("disabled")&&l.disable(),l._initZoom(),l.hideThumbnailContent&&t.addCss(l.$preview,"hide-content")},_initTemplateDefaults:function(){var i,a,n,r,o,s,l,d,h,c=this;i=t.closeButton("fileinput-remove"),a='<div id="'+t.MODAL_ID+'" class="file-zoom-dialog modal fade" tabindex="-1" aria-labelledby="'+t.MODAL_ID+'Label"></div>',n='<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}"',r='<video class="kv-preview-data file-preview-video" controls {style}>\n<source src="{data}" type="{type}">\n'+t.DEFAULT_PREVIEW+"\n</video>\n",o='\x3c!--suppress ALL --\x3e<audio class="kv-preview-data file-preview-audio" controls {style}>\n<source src="{data}" type="{type}">\n'+t.DEFAULT_PREVIEW+"\n</audio>\n",l='<embed class="kv-preview-data file-preview-pdf" src="{data}" type="application/pdf" {style}>\n',s='<object class="kv-preview-data file-preview-object file-object {typeCss}" data="{data}" type="{type}" {style}>\n<param name="movie" value="{caption}" />\n'+t.OBJECT_PARAMS+" "+t.DEFAULT_PREVIEW+"\n</object>\n",d='<div class="kv-preview-data file-preview-other-frame" {style}>\n'+t.DEFAULT_PREVIEW+"\n</div>\n",h={width:"100%",height:"100%","min-height":"480px"},c._isPdfRendered()&&(l=c.pdfRendererTemplate.replace("{renderer}",c._encodeURI(c.pdfRendererUrl))),c.defaults={layoutTemplates:{main1:'{preview}\n<div class="kv-upload-progress kv-hidden"></div><div class="clearfix"></div>\n<div class="input-group {class}">\n  {caption}\n<div class="input-group-btn input-group-append">\n      {remove}\n      {cancel}\n      {upload}\n      {browse}\n    </div>\n</div>',main2:'{preview}\n<div class="kv-upload-progress kv-hidden"></div>\n<div class="clearfix"></div>\n{remove}\n{cancel}\n{upload}\n{browse}\n',preview:'<div class="file-preview {class}">\n    {close}    <div class="{dropClass}">\n    <div class="file-preview-thumbnails">\n    </div>\n    <div class="clearfix"></div>    <div class="file-preview-status text-center text-success"></div>\n    <div class="kv-fileinput-error"></div>\n    </div>\n</div>',close:i,fileIcon:'<i class="glyphicon glyphicon-file"></i>',caption:'<div class="file-caption form-control {class}" tabindex="500">\n  <span class="file-caption-icon"></span>\n  <input class="file-caption-name" onkeydown="return false;" onpaste="return false;">\n</div>',modalMain:a,modal:'<div class="modal-dialog modal-lg{rtl}" role="document">\n  <div class="modal-content">\n    <div class="modal-header">\n      <h5 class="modal-title">{heading}</h5>\n      <span class="kv-zoom-title"></span>\n      <div class="kv-zoom-actions">{toggleheader}{fullscreen}{borderless}{close}</div>\n    </div>\n    <div class="modal-body">\n      <div class="floating-buttons"></div>\n      <div class="kv-zoom-body file-zoom-content {zoomFrameClass}"></div>\n{prev} {next}\n    </div>\n  </div>\n</div>\n',progress:'<div class="progress">\n    <div class="{class}" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">\n        {status}\n     </div>\n</div>',size:" <samp>({sizeText})</samp>",footer:'<div class="file-thumbnail-footer">\n    <div class="file-footer-caption" title="{caption}">\n        <div class="file-caption-info">{caption}</div>\n        <div class="file-size-info">{size}</div>\n    </div>\n    {progress}\n{indicator}\n{actions}\n</div>',indicator:'<div class="file-upload-indicator" title="{indicatorTitle}">{indicator}</div>',actions:'<div class="file-actions">\n    <div class="file-footer-buttons">\n        {download} {upload} {delete} {zoom} {other}    </div>\n</div>\n{drag}\n<div class="clearfix"></div>',actionDelete:'<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}" {dataUrl}{dataKey}>{removeIcon}</button>\n',actionUpload:'<button type="button" class="kv-file-upload {uploadClass}" title="{uploadTitle}">{uploadIcon}</button>',actionDownload:'<a class="kv-file-download {downloadClass}" title="{downloadTitle}" href="{downloadUrl}" download="{caption}" target="_blank">{downloadIcon}</a>',actionZoom:'<button type="button" class="kv-file-zoom {zoomClass}" title="{zoomTitle}">{zoomIcon}</button>',actionDrag:'<span class="file-drag-handle {dragClass}" title="{dragTitle}">{dragIcon}</span>',btnDefault:'<button type="{type}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</button>',btnLink:'<a href="{href}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</a>',btnBrowse:'<div tabindex="500" class="{css}" {status}>{icon} {label}</div>',zoomCache:'<div class="kv-zoom-cache" style="display:none">{zoomContent}</div>'},previewMarkupTags:{tagBefore1:'<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}"><div class="kv-file-content">\n',tagBefore2:'<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}" title="{caption}"><div class="kv-file-content">\n',tagAfter:"</div>{footer}\n</div>\n"},previewContentTemplates:{generic:"{content}\n",html:'<div class="kv-preview-data file-preview-html" title="{caption}" {style}>{data}</div>\n',image:'<img src="{data}" class="file-preview-image kv-preview-data" title="{caption}" alt="{caption}" {style}>\n',text:'<textarea class="kv-preview-data file-preview-text" title="{caption}" readonly {style}>{data}</textarea>\n',office:'<iframe class="kv-preview-data file-preview-office" src="https://view.officeapps.live.com/op/embed.aspx?src={data}" {style}></iframe>',gdocs:'<iframe class="kv-preview-data file-preview-gdocs" src="https://docs.google.com/gview?url={data}&embedded=true" {style}></iframe>',video:r,audio:o,flash:'<embed class="kv-preview-data file-preview-flash" src="{data}" type="application/x-shockwave-flash" {style}>\n',object:s,pdf:l,other:d},allowedPreviewTypes:["image","html","text","video","audio","flash","pdf","object"],previewTemplates:{},previewSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:{width:"213px",height:"160px"},text:{width:"213px",height:"160px"},office:{width:"213px",height:"160px"},gdocs:{width:"213px",height:"160px"},video:{width:"213px",height:"160px"},audio:{width:"100%",height:"30px"},flash:{width:"213px",height:"160px"},object:{width:"213px",height:"160px"},pdf:{width:"100%",height:"160px"},other:{width:"213px",height:"160px"}},previewSettingsSmall:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:{width:"100%",height:"160px"},text:{width:"100%",height:"160px"},office:{width:"100%",height:"160px"},gdocs:{width:"100%",height:"160px"},video:{width:"100%",height:"auto"},audio:{width:"100%",height:"30px"},flash:{width:"100%",height:"auto"},object:{width:"100%",height:"auto"},pdf:{width:"100%",height:"160px"},other:{width:"100%",height:"160px"}},previewZoomSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:h,text:h,office:{width:"100%",height:"100%","max-width":"100%","min-height":"480px"},gdocs:{width:"100%",height:"100%","max-width":"100%","min-height":"480px"},video:{width:"auto",height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"480px"},object:{width:"auto",height:"100%","max-width":"100%","min-height":"480px"},pdf:h,other:{width:"auto",height:"100%","min-height":"480px"}},mimeTypeAliases:{"video/quicktime":"video/mp4"},fileTypeSettings:{image:function(e,i){return t.compare(e,"image.*")&&!t.compare(e,/(tiff?|wmf)$/i)||t.compare(i,/\.(gif|png|jpe?g)$/i)},html:function(e,i){return t.compare(e,"text/html")||t.compare(i,/\.(htm|html)$/i)},office:function(e,i){return t.compare(e,/(word|excel|powerpoint|office)$/i)||t.compare(i,/\.(docx?|xlsx?|pptx?|pps|potx?)$/i)},gdocs:function(e,i){return t.compare(e,/(word|excel|powerpoint|office|iwork-pages|tiff?)$/i)||t.compare(i,/\.(docx?|xlsx?|pptx?|pps|potx?|rtf|ods|odt|pages|ai|dxf|ttf|tiff?|wmf|e?ps)$/i)},text:function(e,i){return t.compare(e,"text.*")||t.compare(i,/\.(xml|javascript)$/i)||t.compare(i,/\.(txt|md|csv|nfo|ini|json|php|js|css)$/i)},video:function(e,i){return t.compare(e,"video.*")&&(t.compare(e,/(ogg|mp4|mp?g|mov|webm|3gp)$/i)||t.compare(i,/\.(og?|mp4|webm|mp?g|mov|3gp)$/i))},audio:function(e,i){return t.compare(e,"audio.*")&&(t.compare(i,/(ogg|mp3|mp?g|wav)$/i)||t.compare(i,/\.(og?|mp3|mp?g|wav)$/i))},flash:function(e,i){return t.compare(e,"application/x-shockwave-flash",!0)||t.compare(i,/\.(swf)$/i)},pdf:function(e,i){return t.compare(e,"application/pdf",!0)||t.compare(i,/\.(pdf)$/i)},object:function(){return!0},other:function(){return!0}},fileActionSettings:{showRemove:!0,showUpload:!0,showDownload:!0,showZoom:!0,showDrag:!0,removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",removeErrorClass:"btn btn-sm btn-kv btn-danger",removeTitle:"Remove file",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",uploadTitle:"Upload file",uploadRetryIcon:'<i class="glyphicon glyphicon-repeat"></i>',uploadRetryTitle:"Retry upload",downloadIcon:'<i class="glyphicon glyphicon-download"></i>',downloadClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",downloadTitle:"Download file",zoomIcon:'<i class="glyphicon glyphicon-zoom-in"></i>',zoomClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",zoomTitle:"View Details",dragIcon:'<i class="glyphicon glyphicon-move"></i>',dragClass:"text-info",dragTitle:"Move / Rearrange",dragSettings:{},indicatorNew:'<i class="glyphicon glyphicon-plus-sign text-warning"></i>',indicatorSuccess:'<i class="glyphicon glyphicon-ok-sign text-success"></i>',indicatorError:'<i class="glyphicon glyphicon-exclamation-sign text-danger"></i>',indicatorLoading:'<i class="glyphicon glyphicon-hourglass text-muted"></i>',indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading ..."}},e.each(c.defaults,function(t,i){"allowedPreviewTypes"!==t?c[t]=e.extend(!0,{},i,c[t]):void 0===c.allowedPreviewTypes&&(c.allowedPreviewTypes=i)}),c._initPreviewTemplates()},_initPreviewTemplates:function(){var i,a=this,n=a.previewMarkupTags,r=n.tagAfter;e.each(a.previewContentTemplates,function(e,o){t.isEmpty(a.previewTemplates[e])&&(i=n.tagBefore2,"generic"!==e&&"image"!==e&&"html"!==e&&"text"!==e||(i=n.tagBefore1),a._isPdfRendered()&&"pdf"===e&&(i=i.replace("kv-file-content","kv-file-content kv-pdf-rendered")),a.previewTemplates[e]=i+o+r)})},_initPreviewCache:function(){var i=this;i.previewCache={data:{},init:function(){var e=i.initialPreview;e.length>0&&!t.isArray(e)&&(e=e.split(i.initialPreviewDelimiter)),i.previewCache.data={content:e,config:i.initialPreviewConfig,tags:i.initialPreviewThumbTags}},count:function(){return i.previewCache.data&&i.previewCache.data.content?i.previewCache.data.content.length:0},get:function(a,n){var r,o,s,l,d,h,c,u="init_"+a,p=i.previewCache.data,m=p.config[a],f=p.content[a],v=i.previewInitId+"-"+u,g=t.ifSet("previewAsData",m,i.initialPreviewAsData),w=function(e,a,n,r,o,s,l,d,h){return d=" file-preview-initial "+t.SORT_CSS+(d?" "+d:""),i._generatePreviewTemplate(e,a,n,r,o,!1,null,d,s,l,h)};return f?(n=void 0===n||n,s=t.ifSet("type",m,i.initialPreviewFileType||"generic"),d=t.ifSet("filename",m,t.ifSet("caption",m)),h=t.ifSet("filetype",m,s),l=i.previewCache.footer(a,n,m&&m.size||null),c=t.ifSet("frameClass",m),r=g?w(s,f,d,h,v,l,u,c):w("generic",f,d,h,v,l,u,c,s).setTokens({content:p.content[a]}),p.tags.length&&p.tags[a]&&(r=t.replaceTags(r,p.tags[a])),t.isEmpty(m)||t.isEmpty(m.frameAttr)||((o=e(document.createElement("div")).html(r)).find(".file-preview-initial").attr(m.frameAttr),r=o.html(),o.remove()),r):""},add:function(e,a,n,r){var o,s=i.previewCache.data;return t.isArray(e)||(e=e.split(i.initialPreviewDelimiter)),r?(o=s.content.push(e)-1,s.config[o]=a,s.tags[o]=n):(o=e.length-1,s.content=e,s.config=a,s.tags=n),i.previewCache.data=s,o},set:function(e,a,n,r){var o,s=i.previewCache.data;if(e&&e.length&&(t.isArray(e)||(e=e.split(i.initialPreviewDelimiter)),e.filter(function(e){return null!==e}).length)){if(void 0===s.content&&(s.content=[]),void 0===s.config&&(s.config=[]),void 0===s.tags&&(s.tags=[]),r){for(o=0;o<e.length;o++)e[o]&&s.content.push(e[o]);for(o=0;o<a.length;o++)a[o]&&s.config.push(a[o]);for(o=0;o<n.length;o++)n[o]&&s.tags.push(n[o])}else s.content=e,s.config=a,s.tags=n;i.previewCache.data=s}},unset:function(e){var a=i.previewCache.count(),n=i.reversePreviewOrder;if(a){if(1===a)return i.previewCache.data.content=[],i.previewCache.data.config=[],i.previewCache.data.tags=[],i.initialPreview=[],i.initialPreviewConfig=[],void(i.initialPreviewThumbTags=[]);i.previewCache.data.content=t.spliceArray(i.previewCache.data.content,e,n),i.previewCache.data.config=t.spliceArray(i.previewCache.data.config,e,n),i.previewCache.data.tags=t.spliceArray(i.previewCache.data.tags,e,n)}},out:function(){var e,t,a="",n=i.previewCache.count();if(0===n)return{content:"",caption:""};for(e=0;e<n;e++)t=i.previewCache.get(e),a=i.reversePreviewOrder?t+a:a+t;return{content:a,caption:i._getMsgSelected(n)}},footer:function(e,a,n){var r=i.previewCache.data||{};if(t.isEmpty(r.content))return"";(t.isEmpty(r.config)||t.isEmpty(r.config[e]))&&(r.config[e]={}),a=void 0===a||a;var o,s=r.config[e],l=t.ifSet("caption",s),d=t.ifSet("width",s,"auto"),h=t.ifSet("url",s,!1),c=t.ifSet("key",s,null),u=i.fileActionSettings,p=i.initialPreviewShowDelete||!1,m=s.downloadUrl||i.initialPreviewDownloadUrl||"",f=s.filename||s.caption||"",v=!!m,g=t.ifSet("showRemove",s,t.ifSet("showRemove",u,p)),w=t.ifSet("showDownload",s,t.ifSet("showDownload",u,v)),y=t.ifSet("showZoom",s,t.ifSet("showZoom",u,!0)),b=t.ifSet("showDrag",s,t.ifSet("showDrag",u,!0)),_=!1===h&&a;return w=w&&!1!==s.downloadUrl&&!!m,o=i._renderFileActions(!1,w,g,y,b,_,h,c,!0,m,f),i._getLayoutTemplate("footer").setTokens({progress:i._renderThumbProgress(),actions:o,caption:l,size:i._getSize(n),width:d,indicator:""})}},i.previewCache.init()},_isPdfRendered:function(){var e=this.usePdfRenderer;return("function"==typeof e?e():!!e)&&this.pdfRendererUrl},_handler:function(e,t,i){var a=this.namespace,n=t.split(" ").join(a+" ")+a;e&&e.length&&e.off(n).on(n,i)},_encodeURI:function(e){return this.encodeUrl?encodeURI(e):e},_log:function(e){var t=this.$element.attr("id");t&&(e='"'+t+'": '+e),e="bootstrap-fileinput: "+e,void 0!==window.console.log?window.console.log(e):window.alert(e)},_validate:function(){var e="file"===this.$element.attr("type");return e||this._log('The input "type" must be set to "file" for initializing the "bootstrap-fileinput" plugin.'),e},_errorsExist:function(){var t;return!!this.$errorContainer.find("li").length||((t=e(document.createElement("div")).html(this.$errorContainer.html())).find(".kv-error-close").remove(),t.find("ul").remove(),!!e.trim(t.text()).length)},_errorHandler:function(e,t){var i=this,a=e.target.error,n=function(e){i._showError(e.replace("{name}",t))};a.code===a.NOT_FOUND_ERR?n(i.msgFileNotFound):a.code===a.SECURITY_ERR?n(i.msgFileSecured):a.code===a.NOT_READABLE_ERR?n(i.msgFileNotReadable):a.code===a.ABORT_ERR?n(i.msgFilePreviewAborted):n(i.msgFilePreviewError)},_addError:function(e){var t=this,i=t.$errorContainer;e&&i.length&&(i.html(t.errorCloseButton+e),t._handler(i.find(".kv-error-close"),"click",function(){setTimeout(function(){t.showPreview&&!t.getFrames().length&&t.clear(),i.fadeOut("slow")},10)}))},_setValidationError:function(e){e=(e?e+" ":"")+"has-error",this.$container.removeClass(e).addClass("has-error"),t.addCss(this.$captionContainer,"is-invalid")},_resetErrors:function(e){var t=this.$errorContainer;this.isError=!1,this.$container.removeClass("has-error"),this.$captionContainer.removeClass("is-invalid"),t.html(""),e?t.fadeOut("slow"):t.hide()},_showFolderError:function(e){var t,i=this.$errorContainer;e&&(this.isAjaxUpload||this._clearFileInput(),t=this.msgFoldersNotAllowed.replace("{n}",e),this._addError(t),this._setValidationError(),i.fadeIn(800),this._raise("filefoldererror",[e,t]))},_showUploadError:function(e,t,i){var a=this.$errorContainer,n=i||"fileuploaderror",r=t&&t.id?'<li data-file-id="'+t.id+'">'+e+"</li>":"<li>"+e+"</li>";return 0===a.find("ul").length?this._addError("<ul>"+r+"</ul>"):a.find("ul").append(r),a.fadeIn(800),this._raise(n,[t,e]),this._setValidationError("file-input-new"),!0},_showError:function(e,t,i){var a=this.$errorContainer,n=i||"fileerror";return(t=t||{}).reader=this.reader,this._addError(e),a.fadeIn(800),this._raise(n,[t,e]),this.isAjaxUpload||this._clearFileInput(),this._setValidationError("file-input-new"),this.$btnUpload.attr("disabled",!0),!0},_noFilesError:function(e){var t=this.minFileCount>1?this.filePlural:this.fileSingle,i=this.msgFilesTooLess.replace("{n}",this.minFileCount).replace("{files}",t),a=this.$errorContainer;this._addError(i),this.isError=!0,this._updateFileDetails(0),a.fadeIn(800),this._raise("fileerror",[e,i]),this._clearFileInput(),this._setValidationError()},_parseError:function(t,i,a,n){var r,o=e.trim(a+""),s=void 0!==i.responseJSON&&void 0!==i.responseJSON.error?i.responseJSON.error:i.responseText;return this.cancelling&&this.msgUploadAborted&&(o=this.msgUploadAborted),this.showAjaxErrorDetails&&s&&(r=(s=e.trim(s.replace(/\n\s*\n/g,"\n"))).length?"<pre>"+s+"</pre>":"",o+=o?r:s),o||(o=this.msgAjaxError.replace("{operation}",t)),this.cancelling=!1,n?"<b>"+n+": </b>"+o:o},_parseFileType:function(e,i){var a,n,r,o=this.allowedPreviewTypes||[];if("application/text-plain"===e)return"text";for(r=0;r<o.length;r++)if(n=o[r],a=(0,this.fileTypeSettings[n])(e,i)?n:"",!t.isEmpty(a))return a;return"other"},_getPreviewIcon:function(t){var i,a=this,n=null;return t&&t.indexOf(".")>-1&&(i=t.split(".").pop(),a.previewFileIconSettings&&(n=a.previewFileIconSettings[i]||a.previewFileIconSettings[i.toLowerCase()]||null),a.previewFileExtSettings&&e.each(a.previewFileExtSettings,function(e,t){a.previewFileIconSettings[e]&&t(i)&&(n=a.previewFileIconSettings[e])})),n},_parseFilePreviewIcon:function(e,t){var i=this._getPreviewIcon(t)||this.previewFileIcon,a=e;return a.indexOf("{previewFileIcon}")>-1&&(a=a.setTokens({previewFileIconClass:this.previewFileIconClass,previewFileIcon:i})),a},_raise:function(t,i){var a=e.Event(t);if(void 0!==i?this.$element.trigger(a,i):this.$element.trigger(a),a.isDefaultPrevented()||!1===a.result)return!1;switch(t){case"filebatchuploadcomplete":case"filebatchuploadsuccess":case"fileuploaded":case"fileclear":case"filecleared":case"filereset":case"fileerror":case"filefoldererror":case"fileuploaderror":case"filebatchuploaderror":case"filedeleteerror":case"filecustomerror":case"filesuccessremove":break;default:this.ajaxAborted||(this.ajaxAborted=a.result)}return!0},_listenFullScreen:function(e){var t,i,a=this.$modal;a&&a.length&&(t=a&&a.find(".btn-fullscreen"),i=a&&a.find(".btn-borderless"),t.length&&i.length&&(t.removeClass("active").attr("aria-pressed","false"),i.removeClass("active").attr("aria-pressed","false"),e?t.addClass("active").attr("aria-pressed","true"):i.addClass("active").attr("aria-pressed","true"),a.hasClass("file-zoom-fullscreen")?this._maximizeZoomDialog():e?this._maximizeZoomDialog():i.removeClass("active").attr("aria-pressed","false")))},_listen:function(){var i=this,a=i.$element,n=i.$form,r=i.$container;i._handler(a,"click",function(e){a.hasClass("file-no-browse")&&(a.data("zoneClicked")?a.data("zoneClicked",!1):e.preventDefault())}),i._handler(a,"change",e.proxy(i._change,i)),i.showBrowse&&i._handler(i.$btnFile,"click",e.proxy(i._browse,i)),i._handler(r.find(".fileinput-remove:not([disabled])"),"click",e.proxy(i.clear,i)),i._handler(r.find(".fileinput-cancel"),"click",e.proxy(i.cancel,i)),i._initDragDrop(),i._handler(n,"reset",e.proxy(i.clear,i)),i.isAjaxUpload||i._handler(n,"submit",e.proxy(i._submitForm,i)),i._handler(i.$container.find(".fileinput-upload"),"click",e.proxy(i._uploadClick,i)),i._handler(e(window),"resize",function(){i._listenFullScreen(screen.width===window.innerWidth&&screen.height===window.innerHeight)}),i._handler(e(document),"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){i._listenFullScreen(t.checkFullScreen())}),i._autoFitContent(),i._initClickable(),i._refreshPreview()},_autoFitContent:function(){var t,i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=this,n=i<400?a.previewSettingsSmall||a.defaults.previewSettingsSmall:a.previewSettings||a.defaults.previewSettings;e.each(n,function(e,i){t=".file-preview-frame .file-preview-"+e,a.$preview.find(t+".kv-preview-data,"+t+" .kv-preview-data").css(i)})},_scanDroppedItems:function(e,t,i){i=i||"";var a,n,r,o=this,s=function(e){o._log("Error scanning dropped files!"),o._log(e)};e.isFile?e.file(function(e){t.push(e)},s):e.isDirectory&&(n=e.createReader(),(r=function(){n.readEntries(function(n){if(n&&n.length>0){for(a=0;a<n.length;a++)o._scanDroppedItems(n[a],t,i+e.name+"/");r()}return null},s)})())},_initDragDrop:function(){var t=this.$dropZone;this.dropZoneEnabled&&this.showPreview&&(this._handler(t,"dragenter dragover",e.proxy(this._zoneDragEnter,this)),this._handler(t,"dragleave",e.proxy(this._zoneDragLeave,this)),this._handler(t,"drop",e.proxy(this._zoneDrop,this)),this._handler(e(document),"dragenter dragover drop",this._zoneDragDropInit))},_zoneDragDropInit:function(e){e.stopPropagation(),e.preventDefault()},_zoneDragEnter:function(i){var a=i.originalEvent.dataTransfer,n=e.inArray("Files",a.types)>-1;if(this._zoneDragDropInit(i),this.isDisabled||!n)return i.originalEvent.dataTransfer.effectAllowed="none",void(i.originalEvent.dataTransfer.dropEffect="none");this._raise("fileDragEnter",{sourceEvent:i,files:a.types.Files})&&t.addCss(this.$dropZone,"file-highlighted")},_zoneDragLeave:function(e){this._zoneDragDropInit(e),this.isDisabled||this._raise("fileDragLeave",{sourceEvent:e})&&this.$dropZone.removeClass("file-highlighted")},_zoneDrop:function(e){var i,a=this,n=a.$element,r=e.originalEvent.dataTransfer,o=r.files,s=r.items,l=t.getDragDropFolders(s),d=function(){a.isAjaxUpload?a._change(e,o):(a.changeTriggered=!0,n.get(0).files=o,setTimeout(function(){a.changeTriggered=!1,n.trigger("change"+a.namespace)},10)),a.$dropZone.removeClass("file-highlighted")};if(e.preventDefault(),!a.isDisabled&&!t.isEmpty(o)&&a._raise("fileDragDrop",{sourceEvent:e,files:o}))if(l>0){if(!a.isAjaxUpload)return void a._showFolderError(l);for(o=[],i=0;i<s.length;i++){var h=s[i].webkitGetAsEntry();h&&a._scanDroppedItems(h,o)}setTimeout(function(){d()},500)}else d()},_uploadClick:function(e){var i,a=this.$container.find(".fileinput-upload"),n=!a.hasClass("disabled")&&t.isEmpty(a.attr("disabled"));e&&e.isDefaultPrevented()||(this.isAjaxUpload?(e.preventDefault(),n&&this.upload()):n&&"submit"!==a.attr("type")&&((i=a.closest("form")).length&&i.trigger("submit"),e.preventDefault()))},_submitForm:function(){return this._isFileSelectionValid()&&!this._abort({})},_clearPreview:function(){var i=this.$preview;(this.showUploadedThumbs?this.getFrames(":not(.file-preview-success)"):this.getFrames()).each(function(){var a=e(this);a.remove(),t.cleanZoomCache(i.find("#zoom-"+a.attr("id")))}),this.getFrames().length&&this.showPreview||this._resetUpload(),this._validateDefaultPreview()},_initSortable:function(){var i,a=this,n=a.$preview,r="."+t.SORT_CSS,o=a.reversePreviewOrder;window.KvSortable&&0!==n.find(r).length&&(i={handle:".drag-handle-init",dataIdAttr:"data-preview-id",scroll:!1,draggable:r,onSort:function(i){var n=i.oldIndex,r=i.newIndex,s=0;a.initialPreview=t.moveArray(a.initialPreview,n,r,o),a.initialPreviewConfig=t.moveArray(a.initialPreviewConfig,n,r,o),a.previewCache.init(),a.getFrames(".file-preview-initial").each(function(){e(this).attr("data-fileindex","init_"+s),s++}),a._raise("filesorted",{previewId:e(i.item).attr("id"),oldIndex:n,newIndex:r,stack:a.initialPreviewConfig})}},n.data("kvsortable")&&n.kvsortable("destroy"),e.extend(!0,i,a.fileActionSettings.dragSettings),n.kvsortable(i))},_setPreviewContent:function(e){this.$preview.html(e),this._autoFitContent()},_initPreview:function(e){var i,a=this.initialCaption||"";if(!this.previewCache.count())return this._clearPreview(),void(e?this._setCaption(a):this._initCaption());i=this.previewCache.out(),a=e&&this.initialCaption?this.initialCaption:i.caption,this._setPreviewContent(i.content),this._setInitThumbAttr(),this._setCaption(a),this._initSortable(),t.isEmpty(i.content)||this.$container.removeClass("file-input-new")},_getZoomButton:function(e){var t=this.previewZoomButtonIcons[e],i=this.previewZoomButtonClasses[e],a=' title="'+(this.previewZoomButtonTitles[e]||"")+'" '+("close"===e?' data-dismiss="modal" aria-hidden="true"':"");return"fullscreen"!==e&&"borderless"!==e&&"toggleheader"!==e||(a+=' data-toggle="button" aria-pressed="false" autocomplete="off"'),'<button type="button" class="'+i+" btn-"+e+'"'+a+">"+t+"</button>"},_getModalContent:function(){return this._getLayoutTemplate("modal").setTokens({rtl:this.rtl?" kv-rtl":"",zoomFrameClass:this.frameClass,heading:this.msgZoomModalHeading,prev:this._getZoomButton("prev"),next:this._getZoomButton("next"),toggleheader:this._getZoomButton("toggleheader"),fullscreen:this._getZoomButton("fullscreen"),borderless:this._getZoomButton("borderless"),close:this._getZoomButton("close")})},_listenModalEvent:function(e){var i=this,a=i.$modal;a.on(e+".bs.modal",function(n){var r=a.find(".btn-fullscreen"),o=a.find(".btn-borderless");i._raise("filezoom"+e,function(e){return{sourceEvent:e,previewId:a.data("previewId"),modal:a}}(n)),"shown"===e&&(o.removeClass("active").attr("aria-pressed","false"),r.removeClass("active").attr("aria-pressed","false"),a.hasClass("file-zoom-fullscreen")&&(i._maximizeZoomDialog(),t.checkFullScreen()?r.addClass("active").attr("aria-pressed","true"):o.addClass("active").attr("aria-pressed","true")))})},_initZoom:function(){var i,a=this,n=a._getLayoutTemplate("modalMain"),r="#"+t.MODAL_ID;a.showPreview&&(a.$modal=e(r),a.$modal&&a.$modal.length||(i=e(document.createElement("div")).html(n).insertAfter(a.$container),a.$modal=e(r).insertBefore(i),i.remove()),t.initModal(a.$modal),a.$modal.html(a._getModalContent()),e.each(t.MODAL_EVENTS,function(e,t){a._listenModalEvent(t)}))},_initZoomButtons:function(){var t,i,a=this.$modal.data("previewId")||"",n=this.getFrames().toArray(),r=n.length,o=this.$modal.find(".btn-prev"),s=this.$modal.find(".btn-next");if(n.length<2)return o.hide(),void s.hide();o.show(),s.show(),r&&(t=e(n[0]),i=e(n[r-1]),o.removeAttr("disabled"),s.removeAttr("disabled"),t.length&&t.attr("id")===a&&o.attr("disabled",!0),i.length&&i.attr("id")===a&&s.attr("disabled",!0))},_maximizeZoomDialog:function(){var t=this.$modal,i=t.find(".modal-header:visible"),a=t.find(".modal-footer:visible"),n=t.find(".modal-body"),r=e(window).height();t.addClass("file-zoom-fullscreen"),i&&i.length&&(r-=i.outerHeight(!0)),a&&a.length&&(r-=a.outerHeight(!0)),n&&n.length&&(r-=n.outerHeight(!0)-n.height()),t.find(".kv-zoom-body").height(r)},_resizeZoomDialog:function(e){var i=this.$modal,a=i.find(".btn-fullscreen"),n=i.find(".btn-borderless");if(i.hasClass("file-zoom-fullscreen"))t.toggleFullScreen(!1),e?a.hasClass("active")||(i.removeClass("file-zoom-fullscreen"),this._resizeZoomDialog(!0),n.hasClass("active")&&n.removeClass("active").attr("aria-pressed","false")):a.hasClass("active")?a.removeClass("active").attr("aria-pressed","false"):(i.removeClass("file-zoom-fullscreen"),this.$modal.find(".kv-zoom-body").css("height",this.zoomModalHeight));else{if(!e)return void this._maximizeZoomDialog();t.toggleFullScreen(!0)}i.focus()},_setZoomContent:function(i,a){var n,r,o,s,l,d,h,c,u=this,p=i.attr("id"),m=u.$preview.find("#zoom-"+p),f=u.$modal,v=f.find(".btn-fullscreen"),g=f.find(".btn-borderless"),w=f.find(".btn-toggleheader");r=m.attr("data-template")||"generic",o=(n=m.find(".kv-file-content")).length?n.html():"",s=(i.data("caption")||"")+" "+(i.data("size")||""),f.find(".kv-zoom-title").attr("title",e("<div/>").html(s).text()).html(s),l=f.find(".kv-zoom-body"),f.removeClass("kv-single-content"),a?(c=l.addClass("file-thumb-loading").clone().insertAfter(l),l.html(o).hide(),c.fadeOut("fast",function(){l.fadeIn("fast",function(){l.removeClass("file-thumb-loading")}),c.remove()})):l.html(o),(h=u.previewZoomSettings[r])&&(d=l.find(".kv-preview-data"),t.addCss(d,"file-zoom-detail"),e.each(h,function(e,t){d.css(e,t),(d.attr("width")&&"width"===e||d.attr("height")&&"height"===e)&&d.removeAttr(e)})),f.data("previewId",p),u._handler(f.find(".btn-prev"),"click",function(){u._zoomSlideShow("prev",p)}),u._handler(f.find(".btn-next"),"click",function(){u._zoomSlideShow("next",p)}),u._handler(v,"click",function(){u._resizeZoomDialog(!0)}),u._handler(g,"click",function(){u._resizeZoomDialog(!1)}),u._handler(w,"click",function(){var e,t=f.find(".modal-header"),i=f.find(".modal-body .floating-buttons"),a=t.find(".kv-zoom-actions"),n=function(e){var i=u.$modal.find(".kv-zoom-body"),a=u.zoomModalHeight;f.hasClass("file-zoom-fullscreen")&&(a=i.outerHeight(!0),e||(a-=t.outerHeight(!0))),i.css("height",e?a+e:a)};t.is(":visible")?(e=t.outerHeight(!0),t.slideUp("slow",function(){a.find(".btn").appendTo(i),n(e)})):(i.find(".btn").appendTo(a),t.slideDown("slow",function(){n()})),f.focus()}),u._handler(f,"keydown",function(t){var i=t.which||t.keyCode,a=e(this).find(".btn-prev"),n=e(this).find(".btn-next"),r=e(this).data("previewId"),o=u.rtl?39:37,s=u.rtl?37:39;i===o&&a.length&&!a.attr("disabled")&&u._zoomSlideShow("prev",r),i===s&&n.length&&!n.attr("disabled")&&u._zoomSlideShow("next",r)})},_zoomPreview:function(e){var i,a=this.$modal;if(!e.length)throw"Cannot zoom to detailed preview!";t.initModal(a),a.html(this._getModalContent()),i=e.closest(t.FRAMES),this._setZoomContent(i),a.modal("show"),this._initZoomButtons()},_zoomSlideShow:function(t,i){var a,n,r,o=this.$modal.find(".kv-zoom-actions .btn-"+t),s=this.getFrames().toArray(),l=s.length;if(!o.attr("disabled")){for(n=0;n<l;n++)if(e(s[n]).attr("id")===i){r="prev"===t?n-1:n+1;break}r<0||r>=l||!s[r]||((a=e(s[r])).length&&this._setZoomContent(a,!0),this._initZoomButtons(),this._raise("filezoom"+t,{previewId:i,modal:this.$modal}))}},_initZoomButton:function(){var t=this;t.$preview.find(".kv-file-zoom").each(function(){var i=e(this);t._handler(i,"click",function(){t._zoomPreview(i)})})},_inputFileCount:function(){return this.$element.get(0).files.length},_refreshPreview:function(){var e;this._inputFileCount()&&this.showPreview&&this.isPreviewable&&(this.isAjaxUpload?(e=this.getFileStack(),this.filestack=[],e.length?this._clearFileInput():e=this.$element.get(0).files):e=this.$element.get(0).files,e&&e.length&&(this.readFiles(e),this._setFileDropZoneTitle()))},_clearObjects:function(t){t.find("video audio").each(function(){this.pause(),e(this).remove()}),t.find("img object div").each(function(){e(this).remove()})},_clearFileInput:function(){var t,i,a,n=this.$element;this._inputFileCount()&&(t=n.closest("form"),i=e(document.createElement("form")),a=e(document.createElement("div")),n.before(a),t.length?t.after(i):a.after(i),i.append(n).trigger("reset"),a.before(n).remove(),i.remove())},_resetUpload:function(){this.uploadCache={content:[],config:[],tags:[],append:!0},this.uploadCount=0,this.uploadStatus={},this.uploadLog=[],this.uploadAsyncCount=0,this.loadedImages=[],this.totalImagesCount=0,this.$btnUpload.removeAttr("disabled"),this._setProgress(0),this.$progress.hide(),this._resetErrors(!1),this.ajaxAborted=!1,this.ajaxRequests=[],this._resetCanvas(),this.cacheInitialPreview={},this.overwriteInitial&&(this.initialPreview=[],this.initialPreviewConfig=[],this.initialPreviewThumbTags=[],this.previewCache.data={content:[],config:[],tags:[]})},_resetCanvas:function(){this.canvas&&this.imageCanvasContext&&this.imageCanvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},_hasInitialPreview:function(){return!this.overwriteInitial&&this.previewCache.count()},_resetPreview:function(){var e,t;this.previewCache.count()?(e=this.previewCache.out(),this._setPreviewContent(e.content),this._setInitThumbAttr(),t=this.initialCaption?this.initialCaption:e.caption,this._setCaption(t)):(this._clearPreview(),this._initCaption()),this.showPreview&&(this._initZoom(),this._initSortable())},_clearDefaultPreview:function(){this.$preview.find(".file-default-preview").remove()},_validateDefaultPreview:function(){this.showPreview&&!t.isEmpty(this.defaultPreviewContent)&&(this._setPreviewContent('<div class="file-default-preview">'+this.defaultPreviewContent+"</div>"),this.$container.removeClass("file-input-new"),this._initClickable())},_resetPreviewThumbs:function(e){var t;if(e)return this._clearPreview(),void this.clearStack();this._hasInitialPreview()?(t=this.previewCache.out(),this._setPreviewContent(t.content),this._setInitThumbAttr(),this._setCaption(t.caption),this._initPreviewActions()):this._clearPreview()},_getLayoutTemplate:function(e){var i=this.layoutTemplates[e];return t.isEmpty(this.customLayoutTags)?i:t.replaceTags(i,this.customLayoutTags)},_getPreviewTemplate:function(e){var i=this.previewTemplates[e];return t.isEmpty(this.customPreviewTags)?i:t.replaceTags(i,this.customPreviewTags)},_getOutData:function(e,t,i){return e=e||{},t=t||{},i=i||this.filestack.slice(0)||{},{form:this.formdata,files:i,filenames:this.filenames,filescount:this.getFilesCount(),extra:this._getExtraData(),response:t,reader:this.reader,jqXHR:e}},_getMsgSelected:function(e){var t=1===e?this.fileSingle:this.filePlural;return e>0?this.msgSelected.replace("{n}",e).replace("{files}",t):this.msgNoFilesSelected},_getFrame:function(t){var i=e("#"+t);return i.length?i:(this._log('Invalid thumb frame with id: "'+t+'".'),null)},_getThumbs:function(e){return e=e||"",this.getFrames(":not(.file-preview-initial)"+e)},_getExtraData:function(e,t){var i=this.uploadExtraData;return"function"==typeof this.uploadExtraData&&(i=this.uploadExtraData(e,t)),i},_initXhr:function(e,t,i){var a=this;return e.upload&&e.upload.addEventListener("progress",function(e){var n=0,r=e.total,o=e.loaded||e.position;e.lengthComputable&&(n=Math.floor(o/r*100)),t?a._setAsyncUploadStatus(t,n,i):a._setProgress(n)},!1),e},_initAjaxSettings:function(){this._ajaxSettings=e.extend(!0,{},this.ajaxSettings),this._ajaxDeleteSettings=e.extend(!0,{},this.ajaxDeleteSettings)},_mergeAjaxCallback:function(e,t,i){var a,n=this._ajaxSettings,r=this.mergeAjaxCallbacks;"delete"===i&&(n=this._ajaxDeleteSettings,r=this.mergeAjaxDeleteCallbacks),a=n[e],n[e]=r&&"function"==typeof a?"before"===r?function(){a.apply(this,arguments),t.apply(this,arguments)}:function(){t.apply(this,arguments),a.apply(this,arguments)}:t},_ajaxSubmit:function(t,i,a,n,r,o){var s,l,d=this;d._raise("filepreajax",[r,o])&&(d._uploadExtra(r,o),d._initAjaxSettings(),d._mergeAjaxCallback("beforeSend",t),d._mergeAjaxCallback("success",i),d._mergeAjaxCallback("complete",a),d._mergeAjaxCallback("error",n),l=o&&d.uploadUrlThumb?d.uploadUrlThumb:d.uploadUrl,s=e.extend(!0,{},{xhr:function(){var t=e.ajaxSettings.xhr();return d._initXhr(t,r,d.getFileStack().length)},url:d._encodeURI(l),type:"POST",dataType:"json",data:d.formdata,cache:!1,processData:!1,contentType:!1},d._ajaxSettings),d.ajaxRequests.push(e.ajax(s)))},_mergeArray:function(e,i){var a=t.cleanArray(this[e]),n=t.cleanArray(i);this[e]=a.concat(n)},_initUploadSuccess:function(i,a,n){var r,o,s,l,d,h,c,u,p,m=this;m.showPreview&&"object"==typeof i&&!e.isEmptyObject(i)&&void 0!==i.initialPreview&&i.initialPreview.length>0&&(m.hasInitData=!0,h=i.initialPreview||[],c=i.initialPreviewConfig||[],u=i.initialPreviewThumbTags||[],r=void 0===i.append||i.append,h.length>0&&!t.isArray(h)&&(h=h.split(m.initialPreviewDelimiter)),m._mergeArray("initialPreview",h),m._mergeArray("initialPreviewConfig",c),m._mergeArray("initialPreviewThumbTags",u),void 0!==a?n?(p=a.attr("data-fileindex"),m.uploadCache.content[p]=h[0],m.uploadCache.config[p]=c[0]||[],m.uploadCache.tags[p]=u[0]||[],m.uploadCache.append=r):(s=m.previewCache.add(h,c[0],u[0],r),o=m.previewCache.get(s,!1),(d=(l=e(document.createElement("div")).html(o).hide().insertAfter(a)).find(".kv-zoom-cache"))&&d.length&&d.insertAfter(a),a.fadeOut("slow",function(){var e=l.find(".file-preview-frame");e&&e.length&&e.insertBefore(a).fadeIn("slow").css("display:inline-block"),m._initPreviewActions(),m._clearFileInput(),t.cleanZoomCache(m.$preview.find("#zoom-"+a.attr("id"))),a.remove(),l.remove(),m._initSortable()})):(m.previewCache.set(h,c,u,r),m._initPreview(),m._initPreviewActions()))},_initSuccessThumbs:function(){var i=this;i.showPreview&&i._getThumbs(t.FRAMES+".file-preview-success").each(function(){var a=e(this),n=i.$preview,r=a.find(".kv-file-remove");r.removeAttr("disabled"),i._handler(r,"click",function(){var e=a.attr("id"),r=i._raise("filesuccessremove",[e,a.attr("data-fileindex")]);t.cleanMemory(a),!1!==r&&a.fadeOut("slow",function(){t.cleanZoomCache(n.find("#zoom-"+e)),a.remove(),i.getFrames().length||i.reset()})})})},_checkAsyncComplete:function(){var t,i;for(i=0;i<this.filestack.length;i++)if(this.filestack[i]&&(t=this.previewInitId+"-"+i,-1===e.inArray(t,this.uploadLog)))return!1;return this.uploadAsyncCount===this.uploadLog.length},_uploadExtra:function(t,i){var a=this,n=a._getExtraData(t,i);0!==n.length&&e.each(n,function(e,t){a.formdata.append(e,t)})},_uploadSingle:function(i,a){var n,r,o,s,l,d,h,c,u,p,m,f=this,v=f.getFileStack().length,g=new FormData,w=f.previewInitId+"-"+i,y=f.filestack.length>0||!e.isEmptyObject(f.uploadExtraData),b=e("#"+w).find(".file-thumb-progress"),_={id:w,index:i};f.formdata=g,f.showPreview&&(r=e("#"+w+":not(.file-preview-initial)"),s=r.find(".kv-file-upload"),l=r.find(".kv-file-remove"),b.show()),0===v||!y||s&&s.hasClass("disabled")||f._abort(_)||(m=function(e,t){d||f.updateStack(e,void 0),f.uploadLog.push(t),f._checkAsyncComplete()&&(f.fileBatchCompleted=!0)},o=function(){var e,i,a,n=f.uploadCache,r=0,o=f.cacheInitialPreview;f.fileBatchCompleted&&(o&&o.content&&(r=o.content.length),setTimeout(function(){var s=0===f.getFileStack(!0).length;if(f.showPreview){if(f.previewCache.set(n.content,n.config,n.tags,n.append),r){for(i=0;i<n.content.length;i++)a=i+r,o.content[a]=n.content[i],o.config.length&&(o.config[a]=n.config[i]),o.tags.length&&(o.tags[a]=n.tags[i]);f.initialPreview=t.cleanArray(o.content),f.initialPreviewConfig=t.cleanArray(o.config),f.initialPreviewThumbTags=t.cleanArray(o.tags)}else f.initialPreview=n.content,f.initialPreviewConfig=n.config,f.initialPreviewThumbTags=n.tags;f.cacheInitialPreview={},f.hasInitData&&(f._initPreview(),f._initPreviewActions())}f.unlock(s),s&&f._clearFileInput(),e=f.$preview.find(".file-preview-initial"),f.uploadAsync&&e.length&&(t.addCss(e,t.SORT_CSS),f._initSortable()),f._raise("filebatchuploadcomplete",[f.filestack,f._getExtraData()]),f.uploadCount=0,f.uploadStatus={},f.uploadLog=[],f._setProgress(101),f.ajaxAborted=!1},100))},h=function(o){n=f._getOutData(o),f.fileBatchCompleted=!1,a||(f.ajaxAborted=!1),f.showPreview&&(r.hasClass("file-preview-success")||(f._setThumbStatus(r,"Loading"),t.addCss(r,"file-uploading")),s.attr("disabled",!0),l.attr("disabled",!0)),a||f.lock(),f._raise("filepreupload",[n,w,i]),e.extend(!0,_,n),f._abort(_)&&(o.abort(),a||(f._setThumbStatus(r,"New"),r.removeClass("file-uploading"),s.removeAttr("disabled"),l.removeAttr("disabled"),f.unlock()),f._setProgressCancelled())},c=function(o,l,h){var c=f.showPreview&&r.attr("id")?r.attr("id"):w;n=f._getOutData(h,o),e.extend(!0,_,n),setTimeout(function(){t.isEmpty(o)||t.isEmpty(o.error)?(f.showPreview&&(f._setThumbStatus(r,"Success"),s.hide(),f._initUploadSuccess(o,r,a),f._setProgress(101,b)),f._raise("fileuploaded",[n,c,i]),a?m(i,c):f.updateStack(i,void 0)):(d=!0,f._showUploadError(o.error,_),f._setPreviewError(r,i,f.filestack[i],f.retryErrorUploads),f.retryErrorUploads||s.hide(),a&&m(i,c),f._setProgress(101,e("#"+c).find(".file-thumb-progress"),f.msgUploadError))},100)},u=function(){setTimeout(function(){f.showPreview&&(s.removeAttr("disabled"),l.removeAttr("disabled"),r.removeClass("file-uploading")),a?o():(f.unlock(!1),f._clearFileInput()),f._initSuccessThumbs()},100)},p=function(t,n,o){var l=f.ajaxOperations.uploadThumb,h=f._parseError(l,t,o,a&&f.filestack[i].name?f.filestack[i].name:null);d=!0,setTimeout(function(){a&&m(i,w),f.uploadStatus[w]=100,f._setPreviewError(r,i,f.filestack[i],f.retryErrorUploads),f.retryErrorUploads||s.hide(),e.extend(!0,_,f._getOutData(t)),f._setProgress(101,b,f.msgAjaxProgressError.replace("{operation}",l)),f._setProgress(101,e("#"+w).find(".file-thumb-progress"),f.msgUploadError),f._showUploadError(h,_)},100)},g.append(f.uploadFileAttr,f.filestack[i],f.filenames[i]),g.append("file_id",i),f._ajaxSubmit(h,c,u,p,w,i))},_uploadBatch:function(){var i,a,n,r,o,s=this,l=s.filestack,d=l.length,h=s.filestack.length>0||!e.isEmptyObject(s.uploadExtraData);s.formdata=new FormData,0!==d&&h&&!s._abort({})&&(o=function(){e.each(l,function(e){s.updateStack(e,void 0)}),s._clearFileInput()},i=function(i){s.lock();var a=s._getOutData(i);s.ajaxAborted=!1,s.showPreview&&s._getThumbs().each(function(){var i=e(this),a=i.find(".kv-file-upload"),n=i.find(".kv-file-remove");i.hasClass("file-preview-success")||(s._setThumbStatus(i,"Loading"),t.addCss(i,"file-uploading")),a.attr("disabled",!0),n.attr("disabled",!0)}),s._raise("filebatchpreupload",[a]),s._abort(a)&&(i.abort(),s._getThumbs().each(function(){var t=e(this),i=t.find(".kv-file-upload"),a=t.find(".kv-file-remove");t.hasClass("file-preview-loading")&&(s._setThumbStatus(t,"New"),t.removeClass("file-uploading")),i.removeAttr("disabled"),a.removeAttr("disabled")}),s._setProgressCancelled())},a=function(i,a,n){var r=s._getOutData(n,i),l=0,d=s._getThumbs(":not(.file-preview-success)"),h=t.isEmpty(i)||t.isEmpty(i.errorkeys)?[]:i.errorkeys;t.isEmpty(i)||t.isEmpty(i.error)?(s._raise("filebatchuploadsuccess",[r]),o(),s.showPreview?(d.each(function(){var t=e(this);s._setThumbStatus(t,"Success"),t.removeClass("file-uploading"),t.find(".kv-file-upload").hide().removeAttr("disabled")}),s._initUploadSuccess(i)):s.reset(),s._setProgress(101)):(s.showPreview&&(d.each(function(){var t=e(this),i=t.attr("data-fileindex");t.removeClass("file-uploading"),t.find(".kv-file-upload").removeAttr("disabled"),t.find(".kv-file-remove").removeAttr("disabled"),0===h.length||-1!==e.inArray(l,h)?(s._setPreviewError(t,i,s.filestack[i],s.retryErrorUploads),s.retryErrorUploads||(t.find(".kv-file-upload").hide(),s.updateStack(i,void 0))):(t.find(".kv-file-upload").hide(),s._setThumbStatus(t,"Success"),s.updateStack(i,void 0)),t.hasClass("file-preview-error")&&!s.retryErrorUploads||l++}),s._initUploadSuccess(i)),s._showUploadError(i.error,r,"filebatchuploaderror"),s._setProgress(101,s.$progress,s.msgUploadError))},r=function(){s.unlock(),s._initSuccessThumbs(),s._clearFileInput(),s._raise("filebatchuploadcomplete",[s.filestack,s._getExtraData()])},n=function(t,i,a){var n=s._getOutData(t),r=s.ajaxOperations.uploadBatch,o=s._parseError(r,t,a);s._showUploadError(o,n,"filebatchuploaderror"),s.uploadFileCount=d-1,s.showPreview&&(s._getThumbs().each(function(){var t=e(this),i=t.attr("data-fileindex");t.removeClass("file-uploading"),void 0!==s.filestack[i]&&s._setPreviewError(t)}),s._getThumbs().removeClass("file-uploading"),s._getThumbs(" .kv-file-upload").removeAttr("disabled"),s._getThumbs(" .kv-file-delete").removeAttr("disabled"),s._setProgress(101,s.$progress,s.msgAjaxProgressError.replace("{operation}",r)))},e.each(l,function(e,i){t.isEmpty(l[e])||s.formdata.append(s.uploadFileAttr,i,s.filenames[e])}),s._ajaxSubmit(i,a,r,n))},_uploadExtraOnly:function(){var e,i,a,n,r=this,o={};r.formdata=new FormData,r._abort(o)||(e=function(e){r.lock();var t=r._getOutData(e);r._raise("filebatchpreupload",[t]),r._setProgress(50),o.data=t,o.xhr=e,r._abort(o)&&(e.abort(),r._setProgressCancelled())},i=function(e,i,a){var n=r._getOutData(a,e);t.isEmpty(e)||t.isEmpty(e.error)?(r._raise("filebatchuploadsuccess",[n]),r._clearFileInput(),r._initUploadSuccess(e),r._setProgress(101)):r._showUploadError(e.error,n,"filebatchuploaderror")},a=function(){r.unlock(),r._clearFileInput(),r._raise("filebatchuploadcomplete",[r.filestack,r._getExtraData()])},n=function(e,t,i){var a=r._getOutData(e),n=r.ajaxOperations.uploadExtra,s=r._parseError(n,e,i);o.data=a,r._showUploadError(s,a,"filebatchuploaderror"),r._setProgress(101,r.$progress,r.msgAjaxProgressError.replace("{operation}",n))},r._ajaxSubmit(e,i,a,n))},_deleteFileIndex:function(i){var a=i.attr("data-fileindex"),n=this.reversePreviewOrder;"init_"===a.substring(0,5)&&(a=parseInt(a.replace("init_","")),this.initialPreview=t.spliceArray(this.initialPreview,a,n),this.initialPreviewConfig=t.spliceArray(this.initialPreviewConfig,a,n),this.initialPreviewThumbTags=t.spliceArray(this.initialPreviewThumbTags,a,n),this.getFrames().each(function(){var t=e(this),i=t.attr("data-fileindex");"init_"===i.substring(0,5)&&(i=parseInt(i.replace("init_","")))>a&&(i--,t.attr("data-fileindex","init_"+i))}),this.uploadAsync&&(this.cacheInitialPreview=this.getPreview()))},_initFileActions:function(){var i=this,a=i.$preview;i.showPreview&&(i._initZoomButton(),i.getFrames(" .kv-file-remove").each(function(){var n,r,o,s=e(this),l=s.closest(t.FRAMES),d=l.attr("id"),h=l.attr("data-fileindex");i._handler(s,"click",function(){if(!1===i._raise("filepreremove",[d,h])||!i._validateMinCount())return!1;n=l.hasClass("file-preview-error"),t.cleanMemory(l),l.fadeOut("slow",function(){t.cleanZoomCache(a.find("#zoom-"+d)),i.updateStack(h,void 0),i._clearObjects(l),l.remove(),d&&n&&i.$errorContainer.find('li[data-file-id="'+d+'"]').fadeOut("fast",function(){e(this).remove(),i._errorsExist()||i._resetErrors()}),i._clearFileInput();var s=i.getFileStack(!0),c=i.previewCache.count(),u=s.length,p=i.showPreview&&i.getFrames().length;0!==u||0!==c||p?(o=(r=c+u)>1?i._getMsgSelected(r):s[0]?i._getFileNames()[0]:"",i._setCaption(o)):i.reset(),i._raise("fileremoved",[d,h])})})}),i.getFrames(" .kv-file-upload").each(function(){var a=e(this);i._handler(a,"click",function(){var e=a.closest(t.FRAMES),n=e.attr("data-fileindex");i.$progress.hide(),e.hasClass("file-preview-error")&&!i.retryErrorUploads||i._uploadSingle(n,!1)})}))},_initPreviewActions:function(){var i=this,a=i.$preview,n=i.deleteExtraData||{},r=t.FRAMES+" .kv-file-remove",o=i.fileActionSettings,s=o.removeClass,l=o.removeErrorClass,d=function(){var e=i.isAjaxUpload?i.previewCache.count():i._inputFileCount();a.find(t.FRAMES).length||e||(i._setCaption(""),i.reset(),i.initialCaption="")};i._initZoomButton(),a.find(r).each(function(){var r,o,h,c=e(this),u=c.data("url")||i.deleteUrl,p=c.data("key");if(!t.isEmpty(u)&&void 0!==p){var m,f,v,g,w=c.closest(t.FRAMES),y=i.previewCache.data,b=w.attr("data-fileindex");b=parseInt(b.replace("init_","")),v=t.isEmpty(y.config)&&t.isEmpty(y.config[b])?null:y.config[b],"function"==typeof(g=t.isEmpty(v)||t.isEmpty(v.extra)?n:v.extra)&&(g=g()),f={id:c.attr("id"),key:p,extra:g},r=function(e){i.ajaxAborted=!1,i._raise("filepredelete",[p,e,g]),i._abort()?e.abort():(c.removeClass(l),t.addCss(w,"file-uploading"),t.addCss(c,"disabled "+s))},o=function(e,n,r){var o,h;if(!t.isEmpty(e)&&!t.isEmpty(e.error))return f.jqXHR=r,f.response=e,i._showError(e.error,f,"filedeleteerror"),w.removeClass("file-uploading"),c.removeClass("disabled "+s).addClass(l),void d();w.removeClass("file-uploading").addClass("file-deleted"),w.fadeOut("slow",function(){b=parseInt(w.attr("data-fileindex").replace("init_","")),i.previewCache.unset(b),i._deleteFileIndex(w),o=i.previewCache.count(),h=o>0?i._getMsgSelected(o):"",i._setCaption(h),i._raise("filedeleted",[p,r,g]),t.cleanZoomCache(a.find("#zoom-"+w.attr("id"))),i._clearObjects(w),w.remove(),d()})},h=function(e,t,a){var n=i.ajaxOperations.deleteThumb,r=i._parseError(n,e,a);f.jqXHR=e,f.response={},i._showError(r,f,"filedeleteerror"),w.removeClass("file-uploading"),c.removeClass("disabled "+s).addClass(l),d()},i._initAjaxSettings(),i._mergeAjaxCallback("beforeSend",r,"delete"),i._mergeAjaxCallback("success",o,"delete"),i._mergeAjaxCallback("error",h,"delete"),m=e.extend(!0,{},{url:i._encodeURI(u),type:"POST",dataType:"json",data:e.extend(!0,{},{key:p},g)},i._ajaxDeleteSettings),i._handler(c,"click",function(){if(!i._validateMinCount())return!1;i.ajaxAborted=!1,i._raise("filebeforedelete",[p,g]),i.ajaxAborted instanceof Promise?i.ajaxAborted.then(function(t){t||e.ajax(m)}):i.ajaxAborted||e.ajax(m)})}})},_hideFileIcon:function(){this.overwriteInitial&&this.$captionContainer.removeClass("icon-visible")},_showFileIcon:function(){t.addCss(this.$captionContainer,"icon-visible")},_getSize:function(t){var i,a,n,r=parseFloat(t),o=this.fileSizeGetter;return e.isNumeric(t)&&e.isNumeric(r)?("function"==typeof o?n=o(r):0===r?n="0.00 B":(i=Math.floor(Math.log(r)/Math.log(1024)),a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],n=1*(r/Math.pow(1024,i)).toFixed(2)+" "+a[i]),this._getLayoutTemplate("size").replace("{sizeText}",n)):""},_getFileType:function(e){return this.mimeTypeAliases[e]||e},_generatePreviewTemplate:function(i,a,n,r,o,s,l,d,h,c,u){var p,m=this,f=m.slug(n),v="",g="",w=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<400?m.previewSettingsSmall[i]||m.defaults.previewSettingsSmall[i]:m.previewSettings[i]||m.defaults.previewSettings[i],y=h||m._renderFileFooter(f,l,"auto",s),b=m._getPreviewIcon(n),_="type-default",k=b&&m.preferIconicPreview,x=b&&m.preferIconicZoomPreview;return w&&e.each(w,function(e,t){g+=e+":"+t+";"}),p=function(a,s,l,h){var p=l?"zoom-"+o:o,v=m._getPreviewTemplate(a),w=(d||"")+" "+h;return m.frameClass&&(w=m.frameClass+" "+w),l&&(w=w.replace(" "+t.SORT_CSS,"")),v=m._parseFilePreviewIcon(v,n),"text"===a&&(s=t.htmlEncode(s)),"object"!==i||r||e.each(m.defaults.fileTypeSettings,function(e,t){"object"!==e&&"other"!==e&&t(n,r)&&(_="type-"+e)}),v.setTokens({previewId:p,caption:f,frameClass:w,type:m._getFileType(r),fileindex:c,typeCss:_,footer:y,data:s,template:u||i,style:g?'style="'+g+'"':""})},c=c||o.slice(o.lastIndexOf("-")+1),m.fileActionSettings.showZoom&&(v=p(x?"other":i,a,!0,"kv-zoom-thumb")),v="\n"+m._getLayoutTemplate("zoomCache").replace("{zoomContent}",v),p(k?"other":i,a,!1,"kv-preview-thumb")+v},_addToPreview:function(e,t){return this.reversePreviewOrder?e.prepend(t):e.append(t)},_previewDefault:function(i,a,n){var r=this.$preview;if(this.showPreview){var o,s=i?i.name:"",l=i?i.type:"",d=i.size||0,h=this.slug(s),c=!0===n&&!this.isAjaxUpload,u=t.createObjectURL(i);this._clearDefaultPreview(),o=this._generatePreviewTemplate("other",u,s,l,a,c,d),this._addToPreview(r,o),this._setThumbAttr(a,h,d),!0===n&&this.isAjaxUpload&&this._setThumbStatus(e("#"+a),"Error")}},_previewFile:function(e,t,i,a,n,r){if(this.showPreview){var o,s=t?t.name:"",l=r.type,d=r.name,h=this._parseFileType(l,s),c=this.allowedPreviewTypes,u=this.allowedPreviewMimeTypes,p=this.$preview,m=t.size||0,f=c&&c.indexOf(h)>=0,v=u&&-1!==u.indexOf(l),g="text"===h||"html"===h||"image"===h?i.target.result:n;if("html"===h&&this.purifyHtml&&window.DOMPurify&&(g=window.DOMPurify.sanitize(g)),f||v){o=this._generatePreviewTemplate(h,g,s,l,a,!1,m),this._clearDefaultPreview(),this._addToPreview(p,o);var w=p.find("#"+a+" img");this._validateImageOrientation(w,t,a,d,l,m,g)}else this._previewDefault(t,a);this._setThumbAttr(a,d,m),this._initSortable()}},_setThumbAttr:function(t,i,a){var n=e("#"+t);n.length&&(a=a&&a>0?this._getSize(a):"",n.data({caption:i,size:a}))},_setInitThumbAttr:function(){var e,i,a,n,r=this.previewCache.data,o=this.previewCache.count();if(0!==o)for(var s=0;s<o;s++)e=r.config[s],n=this.previewInitId+"-init_"+s,i=t.ifSet("caption",e,t.ifSet("filename",e)),a=t.ifSet("size",e),this._setThumbAttr(n,i,a)},_slugDefault:function(e){return t.isEmpty(e)?"":String(e).replace(/[\[\]\/\{}:;#%=\(\)\*\+\?\\\^\$\|<>&"']/g,"_")},_updateFileDetails:function(e){var i=this.$element,a=this.getFileStack(),n=t.isIE(9)&&t.findFileName(i.val())||i[0].files[0]&&i[0].files[0].name||a.length&&a[0].name||"",r=this.slug(n),o=this.isAjaxUpload?a.length:e,s=this.previewCache.count()+o,l=1===o?r:this._getMsgSelected(s);this.isError?(this.$previewContainer.removeClass("file-thumb-loading"),this.$previewStatus.html(""),this.$captionContainer.removeClass("icon-visible")):this._showFileIcon(),this._setCaption(l,this.isError),this.$container.removeClass("file-input-new file-input-ajax-new"),1===arguments.length&&this._raise("fileselect",[e,r]),this.previewCache.count()&&this._initPreviewActions()},_setThumbStatus:function(e,t){if(this.showPreview){var i="indicator"+t,a=i+"Title",n="file-preview-"+t.toLowerCase(),r=e.find(".file-upload-indicator"),o=this.fileActionSettings;e.removeClass("file-preview-success file-preview-error file-preview-loading"),"Success"===t&&e.find(".file-drag-handle").remove(),r.html(o[i]),r.attr("title",o[a]),e.addClass(n),"Error"!==t||this.retryErrorUploads||e.find(".kv-file-upload").attr("disabled",!0)}},_setProgressCancelled:function(){this._setProgress(101,this.$progress,this.msgCancelled)},_setProgress:function(e,i,a){var n,r=Math.min(e,100),o=this.progressUploadThreshold,s=e<=100?this.progressTemplate:this.progressCompleteTemplate,l=r<100?this.progressTemplate:a?this.progressErrorTemplate:s;i=i||this.$progress,t.isEmpty(l)||(n=o&&r>o&&e<=100?l.setTokens({percent:o,status:this.msgUploadThreshold}):l.setTokens({percent:r,status:e>100?this.msgUploadEnd:r+"%"}),i.html(n),a&&i.find('[role="progressbar"]').html(a))},_setFileDropZoneTitle:function(){var e,i=this.$container.find(".file-drop-zone"),a=this.dropZoneTitle;this.isClickable&&(e=t.isEmpty(this.$element.attr("multiple"))?this.fileSingle:this.filePlural,a+=this.dropZoneClickTitle.replace("{files}",e)),i.find("."+this.dropZoneTitleClass).remove(),!this.showPreview||0===i.length||this.getFileStack().length>0||!this.dropZoneEnabled||!this.isAjaxUpload&&this.$element.files||(0===i.find(t.FRAMES).length&&t.isEmpty(this.defaultPreviewContent)&&i.prepend('<div class="'+this.dropZoneTitleClass+'">'+a+"</div>"),this.$container.removeClass("file-input-new"),t.addCss(this.$container,"file-input-ajax-new"))},_setAsyncUploadStatus:function(t,i,a){var n=0;this._setProgress(i,e("#"+t).find(".file-thumb-progress")),this.uploadStatus[t]=i,e.each(this.uploadStatus,function(e,t){n+=t}),this._setProgress(Math.floor(n/a))},_validateMinCount:function(){var e=this.isAjaxUpload?this.getFileStack().length:this._inputFileCount();return!(this.validateInitialCount&&this.minFileCount>0&&this._getFileCount(e-1)<this.minFileCount)||(this._noFilesError({}),!1)},_getFileCount:function(e){return this.validateInitialCount&&!this.overwriteInitial&&(e+=this.previewCache.count()),e},_getFileId:function(e){var t,i=this.generateFileId;return"function"==typeof i?i(e,event):e&&(t=String(e.webkitRelativePath||e.fileName||e.name||null))?e.size+"-"+t.replace(/[^0-9a-zA-Z_-]/gim,""):null},_getFileName:function(e){return e&&e.name?this.slug(e.name):void 0},_getFileIds:function(e){return this.fileids.filter(function(t){return e?void 0!==t:null!=t})},_getFileNames:function(e){return this.filenames.filter(function(t){return e?void 0!==t:null!=t})},_setPreviewError:function(e,t,i,a){void 0!==t&&this.updateStack(t,i),this.showPreview&&(!this.removeFromPreviewOnError||a?(this._setThumbStatus(e,"Error"),this._refreshUploadButton(e,a)):e.remove())},_refreshUploadButton:function(e,t){var i=e.find(".kv-file-upload"),a=this.fileActionSettings,n=a.uploadIcon,r=a.uploadTitle;i.length&&(t&&(n=a.uploadRetryIcon,r=a.uploadRetryTitle),i.attr("title",r).html(n))},_checkDimensions:function(e,i,a,n,r,o,s){var l,d,h,c=this[("Small"===i?"min":"max")+"Image"+o];!t.isEmpty(c)&&a.length&&(h=a[0],d="Width"===o?h.naturalWidth||h.width:h.naturalHeight||h.height,("Small"===i?d>=c:d<=c)||(l=this["msgImage"+o+i].setTokens({name:r,size:c}),this._showUploadError(l,s),this._setPreviewError(n,e,null)))},_getExifObj:function(e){var t=null;try{t=window.piexif?window.piexif.load(e):null}catch(e){t=null}return t||this._log("Error loading the piexif.js library."),t},_validateImageOrientation:function(e,i,a,n,r,o,s){var l,d;(d=(l=e.length&&this.autoOrientImage?this._getExifObj(s):null)?l["0th"][piexif.ImageIFD.Orientation]:null)?(t.setImageOrientation(e,this.$preview.find("#zoom-"+a+" img"),d),this._raise("fileimageoriented",{$img:e,file:i}),this._validateImage(a,n,r,o,s,l)):this._validateImage(a,n,r,o,s,l)},_validateImage:function(t,i,a,n,r,o){var s,l,d,h=this,c=h.$preview,u=c.find("#"+t),p=u.attr("data-fileindex"),m=u.find("img");i=i||"Untitled",m.one("load",function(){l=u.width(),d=c.width(),l>d&&m.css("width","100%"),s={ind:p,id:t},h._checkDimensions(p,"Small",m,u,i,"Width",s),h._checkDimensions(p,"Small",m,u,i,"Height",s),h.resizeImage||(h._checkDimensions(p,"Large",m,u,i,"Width",s),h._checkDimensions(p,"Large",m,u,i,"Height",s)),h._raise("fileimageloaded",[t]),h.loadedImages.push({ind:p,img:m,thumb:u,pid:t,typ:a,siz:n,validated:!1,imgData:r,exifObj:o}),u.data("exif",o),h._validateAllImages()}).one("error",function(){h._raise("fileimageloaderror",[t])}).each(function(){this.complete?e(this).trigger("load"):this.error&&e(this).trigger("error")})},_validateAllImages:function(){var e,t,i,a={val:0},n=this.loadedImages.length,r=this.resizeIfSizeMoreThan;if(n===this.totalImagesCount&&(this._raise("fileimagesloaded"),this.resizeImage))for(e=0;e<this.loadedImages.length;e++)(t=this.loadedImages[e]).validated||((i=t.siz)&&i>1e3*r&&this._getResizedImage(t,a,n),this.loadedImages[e].validated=!0)},_getResizedImage:function(i,a,n){var r,o,s,l,d,h,c=this,u=e(i.img)[0],p=u.naturalWidth,m=u.naturalHeight,f=1,v=c.maxImageWidth||p,g=c.maxImageHeight||m,w=!(!p||!m),y=c.imageCanvas,b=c.imageCanvasContext,_=i.typ,k=i.pid,x=i.ind,C=i.thumb,T=i.exifObj;if(d=function(e,t,i){c.isAjaxUpload?c._showUploadError(e,t,i):c._showError(e,t,i),c._setPreviewError(C,x)},c.filestack[x]&&w&&!(p<=v&&m<=g)||(w&&c.filestack[x]&&c._raise("fileimageresized",[k,x]),a.val++,a.val===n&&c._raise("fileimagesresized"),w)){_=_||c.resizeDefaultImageType,o=p>v,s=m>g,f="width"===c.resizePreference?o?v/p:s?g/m:1:s?g/m:o?v/p:1,c._resetCanvas(),p*=f,m*=f,y.width=p,y.height=m;try{b.drawImage(u,0,0,p,m),l=y.toDataURL(_,c.resizeQuality),T&&(h=window.piexif.dump(T),l=window.piexif.insert(h,l)),r=t.dataURI2Blob(l),c.filestack[x]=r,c._raise("fileimageresized",[k,x]),a.val++,a.val===n&&c._raise("fileimagesresized",[void 0,void 0]),r instanceof Blob||d(c.msgImageResizeError,{id:k,index:x},"fileimageresizeerror")}catch(e){a.val++,a.val===n&&c._raise("fileimagesresized",[void 0,void 0]),d(c.msgImageResizeException.replace("{errors}",e.message),{id:k,index:x},"fileimageresizeexception")}}else d(c.msgImageResizeError,{id:k,index:x},"fileimageresizeerror")},_initBrowse:function(e){var i=this.$element;this.showBrowse?this.$btnFile=e.find(".btn-file").append(i):(i.appendTo(e).attr("tabindex",-1),t.addCss(i,"file-no-browse"))},_initClickable:function(){var i,a,n=this;n.isClickable&&(i=n.$dropZone,n.isAjaxUpload||(a=n.$preview.find(".file-default-preview")).length&&(i=a),t.addCss(i,"clickable"),i.attr("tabindex",-1),n._handler(i,"click",function(t){var a=e(t.target);e(n.elErrorContainer+":visible").length||a.parents(".file-preview-thumbnails").length&&!a.parents(".file-default-preview").length||(n.$element.data("zoneClicked",!0).trigger("click"),i.blur())}))},_initCaption:function(){var e=this.initialCaption||"";return this.overwriteInitial||t.isEmpty(e)?(this.$caption.val(""),!1):(this._setCaption(e),!0)},_setCaption:function(i,a){var n,r,o,s,l,d=this.getFileStack();if(this.$caption.length){if(this.$captionContainer.removeClass("icon-visible"),a)n=e("<div>"+this.msgValidationError+"</div>").text(),l=(s=d.length)?1===s&&d[0]?this._getFileNames()[0]:this._getMsgSelected(s):this._getMsgSelected(this.msgNo),r=t.isEmpty(i)?l:i,o='<span class="'+this.msgValidationErrorClass+'">'+this.msgValidationErrorIcon+"</span>";else{if(t.isEmpty(i))return;r=n=e("<div>"+i+"</div>").text(),o=this._getLayoutTemplate("fileIcon")}this.$captionContainer.addClass("icon-visible"),this.$caption.attr("title",n).val(r),this.$captionIcon.html(o)}},_createContainer:function(){var t={class:"file-input file-input-new"+(this.rtl?" kv-rtl":"")},i=e(document.createElement("div")).attr(t).html(this._renderMain());return i.insertBefore(this.$element),this._initBrowse(i),this.theme&&i.addClass("theme-"+this.theme),i},_refreshContainer:function(){var e=this.$container;this.$element.insertAfter(e),e.html(this._renderMain()),this._initBrowse(e),this._validateDisabled()},_validateDisabled:function(){this.$caption.attr({readonly:this.isDisabled})},_renderMain:function(){var e=this.dropZoneEnabled?" file-drop-zone":"file-drop-disabled",t=this.showClose?this._getLayoutTemplate("close"):"",i=this.showPreview?this._getLayoutTemplate("preview").setTokens({class:this.previewClass,dropClass:e}):"",a=this.isDisabled?this.captionClass+" file-caption-disabled":this.captionClass,n=this.captionTemplate.setTokens({class:a+" kv-fileinput-caption"});return this.mainTemplate.setTokens({class:this.mainClass+(!this.showBrowse&&this.showCaption?" no-browse":""),preview:i,close:t,caption:n,upload:this._renderButton("upload"),remove:this._renderButton("remove"),cancel:this._renderButton("cancel"),browse:this._renderButton("browse")})},_renderButton:function(e){var i=this._getLayoutTemplate("btnDefault"),a=this[e+"Class"],n=this[e+"Title"],r=this[e+"Icon"],o=this[e+"Label"],s=this.isDisabled?" disabled":"",l="button";switch(e){case"remove":if(!this.showRemove)return"";break;case"cancel":if(!this.showCancel)return"";a+=" kv-hidden";break;case"upload":if(!this.showUpload)return"";this.isAjaxUpload&&!this.isDisabled?i=this._getLayoutTemplate("btnLink").replace("{href}",this.uploadUrl):l="submit";break;case"browse":if(!this.showBrowse)return"";i=this._getLayoutTemplate("btnBrowse");break;default:return""}return a+="browse"===e?" btn-file":" fileinput-"+e+" fileinput-"+e+"-button",t.isEmpty(o)||(o=' <span class="'+this.buttonLabelClass+'">'+o+"</span>"),i.setTokens({type:l,css:a,title:n,status:s,icon:r,label:o})},_renderThumbProgress:function(){return'<div class="file-thumb-progress kv-hidden">'+this.progressTemplate.setTokens({percent:"0",status:this.msgUploadBegin})+"</div>"},_renderFileFooter:function(e,i,a,n){var r,o=this.fileActionSettings,s=o.showRemove,l=o.showDrag,d=o.showUpload,h=o.showZoom,c=this._getLayoutTemplate("footer"),u=this._getLayoutTemplate("indicator"),p=n?o.indicatorError:o.indicatorNew,m=n?o.indicatorErrorTitle:o.indicatorNewTitle,f=u.setTokens({indicator:p,indicatorTitle:m});return i=this._getSize(i),r=this.isAjaxUpload?c.setTokens({actions:this._renderFileActions(d,!1,s,h,l,!1,!1,!1),caption:e,size:i,width:a,progress:this._renderThumbProgress(),indicator:f}):c.setTokens({actions:this._renderFileActions(!1,!1,!1,h,l,!1,!1,!1),caption:e,size:i,width:a,progress:"",indicator:f}),r=t.replaceTags(r,this.previewThumbTags)},_renderFileActions:function(e,t,i,a,n,r,o,s,l,d,h){if(!(e||t||i||a||n))return"";var c,u=!1===o?"":' data-url="'+o+'"',p=!1===s?"":' data-key="'+s+'"',m="",f="",v="",g="",w="",y=this._getLayoutTemplate("actions"),b=this.fileActionSettings,_=this.otherActionButtons.setTokens({dataKey:p,key:s}),k=r?b.removeClass+" disabled":b.removeClass;return i&&(m=this._getLayoutTemplate("actionDelete").setTokens({removeClass:k,removeIcon:b.removeIcon,removeTitle:b.removeTitle,dataUrl:u,dataKey:p,key:s})),e&&(f=this._getLayoutTemplate("actionUpload").setTokens({uploadClass:b.uploadClass,uploadIcon:b.uploadIcon,uploadTitle:b.uploadTitle})),t&&(v=(v=this._getLayoutTemplate("actionDownload").setTokens({downloadClass:b.downloadClass,downloadIcon:b.downloadIcon,downloadTitle:b.downloadTitle,downloadUrl:d||this.initialPreviewDownloadUrl})).setTokens({filename:h,key:s})),a&&(g=this._getLayoutTemplate("actionZoom").setTokens({zoomClass:b.zoomClass,zoomIcon:b.zoomIcon,zoomTitle:b.zoomTitle})),n&&l&&(c="drag-handle-init "+b.dragClass,w=this._getLayoutTemplate("actionDrag").setTokens({dragClass:c,dragTitle:b.dragTitle,dragIcon:b.dragIcon})),y.setTokens({delete:m,upload:f,download:v,zoom:g,drag:w,other:_})},_browse:function(e){e&&e.isDefaultPrevented()||!this._raise("filebrowse")||(this.isError&&!this.isAjaxUpload&&this.clear(),this.$captionContainer.focus())},_filterDuplicate:function(e,t,i){var a=this._getFileId(e);a&&i&&i.indexOf(a)>-1||(i||(i=[]),t.push(e),i.push(a))},_change:function(i){var a=this;if(!a.changeTriggered){var n,r,o,s,l,d,h,c,u,p,m,f=a.$element,v=arguments.length>1,g=a.isAjaxUpload,w=[],y=v?arguments[1]:f.get(0).files,b=!g&&t.isEmpty(f.attr("multiple"))?1:a.maxFileCount,_=a.filestack.length,k=t.isEmpty(f.attr("multiple"))&&_>0,x=a._getFileIds();if(a.reader=null,a._resetUpload(),a._hideFileIcon(),a.dropZoneEnabled&&a.$container.find(".file-drop-zone ."+a.dropZoneTitleClass).remove(),g?e.each(y,function(e,t){a._filterDuplicate(t,w,x)}):(y=i.target&&void 0===i.target.files?i.target.value?[{name:i.target.value.replace(/^.+\\/,"")}]:[]:i.target.files||{},w=y),t.isEmpty(w)||0===w.length)return g||a.clear(),void a._raise("fileselectnone");if(a._resetErrors(),r=w.length,n=a._getFileCount(g?a.getFileStack().length+r:r),b>0&&n>b){if(!a.autoReplace||r>b)return o=a.autoReplace&&r>b?r:n,s=b,m=a.msgFilesTooMany.replace("{m}",s).replace("{n}",o),a.isError=(l=m,d=null,h=null,c=null,u=e.extend(!0,{},a._getOutData({},{},y),{id:h,index:c}),p={id:h,index:c,file:d,files:y},g?a._showUploadError(l,u):a._showError(l,p)),a.$captionContainer.removeClass("icon-visible"),a._setCaption("",!0),void a.$container.removeClass("file-input-new file-input-ajax-new");n>b&&a._resetPreviewThumbs(g)}else!g||k?(a._resetPreviewThumbs(!1),k&&a.clearStack()):!g||0!==_||a.previewCache.count()&&!a.overwriteInitial||a._resetPreviewThumbs(!0);a.isPreviewable?a.readFiles(w):a._updateFileDetails(1)}},_abort:function(t){var i;return this.ajaxAborted&&"object"==typeof this.ajaxAborted&&void 0!==this.ajaxAborted.message?((i=e.extend(!0,{},this._getOutData(),t)).abortData=this.ajaxAborted.data||{},i.abortMessage=this.ajaxAborted.message,this._setProgress(101,this.$progress,this.msgCancelled),this._showUploadError(this.ajaxAborted.message,i,"filecustomerror"),this.cancel(),!0):!!this.ajaxAborted},_resetFileStack:function(){var i=this,a=0,n=[],r=[],o=[];i._getThumbs().each(function(){var s=e(this),l=s.attr("data-fileindex"),d=i.filestack[l],h=s.attr("id");"-1"!==l&&-1!==l&&(void 0!==d?(n[a]=d,r[a]=i._getFileName(d),o[a]=i._getFileId(d),s.attr({id:i.previewInitId+"-"+a,"data-fileindex":a}),a++):s.attr({id:"uploaded-"+t.uniqId(),"data-fileindex":"-1"}),i.$preview.find("#zoom-"+h).attr({id:"zoom-"+s.attr("id"),"data-fileindex":s.attr("data-fileindex")}))}),i.filestack=n,i.filenames=r,i.fileids=o},_isFileSelectionValid:function(e){return e=e||0,this.required&&!this.getFilesCount()?(this.$errorContainer.html(""),this._showUploadError(this.msgFileRequired),!1):!(this.minFileCount>0&&this._getFileCount(e)<this.minFileCount)||(this._noFilesError({}),!1)},clearStack:function(){return this.filestack=[],this.filenames=[],this.fileids=[],this.$element},updateStack:function(e,t){return this.filestack[e]=t,this.filenames[e]=this._getFileName(t),this.fileids[e]=t&&this._getFileId(t)||null,this.$element},addToStack:function(e){return this.filestack.push(e),this.filenames.push(this._getFileName(e)),this.fileids.push(this._getFileId(e)),this.$element},getFileStack:function(e){return this.filestack.filter(function(t){return e?void 0!==t:null!=t})},getFilesCount:function(){var e=this.isAjaxUpload?this.getFileStack().length:this._inputFileCount();return this._getFileCount(e)},readFiles:function(i){this.reader=new FileReader;var a,n=this,r=n.$element,o=n.$preview,s=n.reader,l=n.$previewContainer,d=n.$previewStatus,h=n.msgLoading,c=n.msgProgress,u=n.previewInitId,p=i.length,m=n.fileTypeSettings,f=n.filestack.length,v=n.allowedFileTypes,g=v?v.length:0,w=n.allowedFileExtensions,y=t.isEmpty(w)?"":w.join(", "),b=n.maxFilePreviewSize&&parseFloat(n.maxFilePreviewSize),_=o.length&&(!b||isNaN(b)),k=function(t,r,o,s){var l,d=e.extend(!0,{},n._getOutData({},{},i),{id:o,index:s}),h={id:o,index:s,file:r,files:i};n._previewDefault(r,o,!0),n.isAjaxUpload?(n.addToStack(void 0),setTimeout(function(){a(s+1)},100)):p=0,n._initFileActions(),(l=e("#"+o)).find(".kv-file-upload").hide(),n.removeFromPreviewOnError&&l.remove(),n.isError=n.isAjaxUpload?n._showUploadError(t,d):n._showError(t,h),n._updateFileDetails(p)};n.loadedImages=[],n.totalImagesCount=0,e.each(i,function(e,t){var i=n.fileTypeSettings.image;i&&i(t.type)&&n.totalImagesCount++}),(a=function(x){if(t.isEmpty(r.attr("multiple"))&&(p=1),x>=p)return n.isAjaxUpload&&n.filestack.length>0?n._raise("filebatchselected",[n.getFileStack()]):n._raise("filebatchselected",[i]),l.removeClass("file-thumb-loading"),void d.html("");var C,T,D,S,P,E,M,A,F,O,I,$,j=u+"-"+(f+x),z=i[x],U=m.text,N=m.image,R=m.html,L=z&&z.name?n.slug(z.name):"",B=(z&&z.size||0)/1e3,Y="",Z=t.createObjectURL(z),V=0,H="",q=0,W=function(){var e=c.setTokens({index:x+1,files:p,percent:50,name:L});setTimeout(function(){d.html(e),n._updateFileDetails(p),a(x+1)},100),n._raise("fileloaded",[z,j,x,s])};if(z){if(g>0)for(T=0;T<g;T++)E=v[T],M=n.msgFileTypes[E]||E,H+=0===T?M:", "+M;if(!1!==L){if(0===L.length)return D=n.msgInvalidFileName.replace("{name}",t.htmlEncode(z.name,"[unknown]")),void k(D,z,j,x);if(t.isEmpty(w)||(Y=new RegExp("\\.("+w.join("|")+")$","i")),C=B.toFixed(2),n.maxFileSize>0&&B>n.maxFileSize)return D=n.msgSizeTooLarge.setTokens({name:L,size:C,maxSize:n.maxFileSize}),void k(D,z,j,x);if(null!==n.minFileSize&&B<=t.getNum(n.minFileSize))return D=n.msgSizeTooSmall.setTokens({name:L,size:C,minSize:n.minFileSize}),void k(D,z,j,x);if(!t.isEmpty(v)&&t.isArray(v)){for(T=0;T<v.length;T+=1)S=v[T],V+=(A=m[S])&&"function"==typeof A&&A(z.type,z.name)?1:0;if(0===V)return D=n.msgInvalidFileType.setTokens({name:L,types:H}),void k(D,z,j,x)}if(0===V&&!t.isEmpty(w)&&t.isArray(w)&&!t.isEmpty(Y)&&(P=t.compare(L,Y),0===(V+=t.isEmpty(P)?0:P.length)))return D=n.msgInvalidFileExtension.setTokens({name:L,extensions:y}),void k(D,z,j,x);if(!n.showPreview)return n.isAjaxUpload&&n.addToStack(z),setTimeout(function(){a(x+1),n._updateFileDetails(p)},100),void n._raise("fileloaded",[z,j,x,s]);if(!_&&B>b)return n.addToStack(z),l.addClass("file-thumb-loading"),n._previewDefault(z,j),n._initFileActions(),n._updateFileDetails(p),void a(x+1);o.length&&void 0!==FileReader?(F=U(z.type,L),O=R(z.type,L),I=N(z.type,L),d.html(h.replace("{index}",x+1).replace("{files}",p)),l.addClass("file-thumb-loading"),s.onerror=function(e){n._errorHandler(e,L)},s.onload=function(i){var a,r,o,l,d,h,c,u,p=[];if(r={name:L,type:z.type},e.each(m,function(e,t){"object"!==e&&"other"!==e&&"function"==typeof t&&t(z.type,L)&&q++}),0===q){for(o=new Uint8Array(i.target.result),T=0;T<o.length;T++)l=o[T].toString(16),p.push(l);if(a=p.join("").toLowerCase().substring(0,8),h=t.getMimeType(a,"",""),t.isEmpty(h)&&(d=t.arrayBuffer2String(s.result),h=t.isSvg(d)?"image/svg+xml":t.getMimeType(a,d,z.type)),r={name:L,type:h},F=U(h,""),O=R(h,""),I=N(h,""),($=F||O)||I)return c=$,(u=new FileReader).onerror=function(e){n._errorHandler(e,L)},u.onload=function(e){n._previewFile(x,z,e,j,Z,r),n._initFileActions(),W()},void(c?u.readAsText(z,n.textEncoding):u.readAsDataURL(z))}n._previewFile(x,z,i,j,Z,r),n._initFileActions(),W()},s.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100,i=Math.ceil(t);D=c.setTokens({index:x+1,files:p,percent:i,name:L}),setTimeout(function(){d.html(D)},100)}},F||O?s.readAsText(z,n.textEncoding):I?s.readAsDataURL(z):s.readAsArrayBuffer(z)):(n._previewDefault(z,j),setTimeout(function(){a(x+1),n._updateFileDetails(p)},100),n._raise("fileloaded",[z,j,x,s])),n.addToStack(z)}else a(x+1)}})(0),n._updateFileDetails(p,!1)},lock:function(){return this._resetErrors(),this.disable(),this.showRemove&&this.$container.find(".fileinput-remove").hide(),this.showCancel&&this.$container.find(".fileinput-cancel").show(),this._raise("filelock",[this.filestack,this._getExtraData()]),this.$element},unlock:function(e){return void 0===e&&(e=!0),this.enable(),this.showCancel&&this.$container.find(".fileinput-cancel").hide(),this.showRemove&&this.$container.find(".fileinput-remove").show(),e&&this._resetFileStack(),this._raise("fileunlock",[this.filestack,this._getExtraData()]),this.$element},cancel:function(){var t,i=this,a=i.ajaxRequests,n=a.length;if(n>0)for(t=0;t<n;t+=1)i.cancelling=!0,a[t].abort();return i._setProgressCancelled(),i._getThumbs().each(function(){var t=e(this),a=t.attr("data-fileindex");t.removeClass("file-uploading"),void 0!==i.filestack[a]&&(t.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled"),t.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled")),i.unlock()}),i.$element},clear:function(){var i,a=this;if(a._raise("fileclear"))return a.$btnUpload.removeAttr("disabled"),a._getThumbs().find("video,audio,img").each(function(){t.cleanMemory(e(this))}),a._clearFileInput(),a._resetUpload(),a.clearStack(),a._resetErrors(!0),a._hasInitialPreview()?(a._showFileIcon(),a._resetPreview(),a._initPreviewActions(),a.$container.removeClass("file-input-new")):(a._getThumbs().each(function(){a._clearObjects(e(this))}),a.isAjaxUpload&&(a.previewCache.data={}),a.$preview.html(""),i=!a.overwriteInitial&&a.initialCaption.length>0?a.initialCaption:"",a.$caption.attr("title","").val(i),t.addCss(a.$container,"file-input-new"),a._validateDefaultPreview()),0===a.$container.find(t.FRAMES).length&&(a._initCaption()||a.$captionContainer.removeClass("icon-visible")),a._hideFileIcon(),a._raise("filecleared"),a.$captionContainer.focus(),a._setFileDropZoneTitle(),a.$element},reset:function(){if(this._raise("filereset"))return this._resetPreview(),this.$container.find(".fileinput-filename").text(""),t.addCss(this.$container,"file-input-new"),(this.getFrames().length||this.dropZoneEnabled)&&this.$container.removeClass("file-input-new"),this.clearStack(),this.formdata={},this._setFileDropZoneTitle(),this.$element},disable:function(){return this.isDisabled=!0,this._raise("filedisabled"),this.$element.attr("disabled","disabled"),this.$container.find(".kv-fileinput-caption").addClass("file-caption-disabled"),this.$container.find(".fileinput-remove, .fileinput-upload, .file-preview-frame button").attr("disabled",!0),t.addCss(this.$container.find(".btn-file"),"disabled"),this._initDragDrop(),this.$element},enable:function(){return this.isDisabled=!1,this._raise("fileenabled"),this.$element.removeAttr("disabled"),this.$container.find(".kv-fileinput-caption").removeClass("file-caption-disabled"),this.$container.find(".fileinput-remove, .fileinput-upload, .file-preview-frame button").removeAttr("disabled"),this.$container.find(".btn-file").removeClass("disabled"),this._initDragDrop(),this.$element},upload:function(){var i,a,n,r=this.getFileStack().length,o=!e.isEmptyObject(this._getExtraData());if(this.isAjaxUpload&&!this.isDisabled&&this._isFileSelectionValid(r))if(this._resetUpload(),0!==r||o)if(this.$progress.show(),this.uploadCount=0,this.uploadStatus={},this.uploadLog=[],this.lock(),this._setProgress(2),0===r&&o)this._uploadExtraOnly();else{if(n=this.filestack.length,this.hasInitData=!1,!this.uploadAsync)return this._uploadBatch(),this.$element;for(a=this._getOutData(),this._raise("filebatchpreupload",[a]),this.fileBatchCompleted=!1,this.uploadCache={content:[],config:[],tags:[],append:!0},this.uploadAsyncCount=this.getFileStack().length,i=0;i<n;i++)this.uploadCache.content[i]=null,this.uploadCache.config[i]=null,this.uploadCache.tags[i]=null;for(this.$preview.find(".file-preview-initial").removeClass(t.SORT_CSS),this._initSortable(),this.cacheInitialPreview=this.getPreview(),i=0;i<n;i++)this.filestack[i]&&this._uploadSingle(i,!0)}else this._showUploadError(this.msgUploadEmpty)},destroy:function(){var t=this.$form,i=this.$container,a=this.$element,n=this.namespace;return e(document).off(n),e(window).off(n),t&&t.length&&t.off(n),this.isAjaxUpload&&this._clearFileInput(),this._cleanup(),this._initPreviewCache(),a.insertBefore(i).off(n).removeData(),i.off().remove(),a},refresh:function(i){var a=this.$element;return i="object"!=typeof i||t.isEmpty(i)?this.options:e.extend(!0,{},this.options,i),this._init(i,!0),this._listen(),a},zoom:function(e){var i=this._getFrame(e),a=this.$modal;i&&(t.initModal(a),a.html(this._getModalContent()),this._setZoomContent(i),a.modal("show"),this._initZoomButtons())},getExif:function(e){var t=this._getFrame(e);return t&&t.data("exif")||null},getFrames:function(i){var a;return i=i||"",a=this.$preview.find(t.FRAMES+i),this.reversePreviewOrder&&(a=e(a.get().reverse())),a},getPreview:function(){return{content:this.initialPreview,config:this.initialPreviewConfig,tags:this.initialPreviewThumbTags}}},e.fn.fileinput=function(a){if(t.hasFileAPISupport()||t.isIE(9)){var n=Array.apply(null,arguments),r=[];switch(n.shift(),this.each(function(){var o,s=e(this),l=s.data("fileinput"),d="object"==typeof a&&a,h=d.theme||s.data("theme"),c={},u={},p=d.language||s.data("language")||e.fn.fileinput.defaults.language||"en";l||(h&&(u=e.fn.fileinputThemes[h]||{}),"en"===p||t.isEmpty(e.fn.fileinputLocales[p])||(c=e.fn.fileinputLocales[p]||{}),o=e.extend(!0,{},e.fn.fileinput.defaults,u,e.fn.fileinputLocales.en,c,d,s.data()),l=new i(this,o),s.data("fileinput",l)),"string"==typeof a&&r.push(l[a].apply(l,n))}),r.length){case 0:return this;case 1:return r[0];default:return r}}},e.fn.fileinput.defaults={language:"en",showCaption:!0,showBrowse:!0,showPreview:!0,showRemove:!0,showUpload:!0,showCancel:!0,showClose:!0,showUploadedThumbs:!0,browseOnZoneClick:!1,autoReplace:!1,autoOrientImage:!1,required:!1,rtl:!1,hideThumbnailContent:!1,encodeUrl:!0,generateFileId:null,previewClass:"",captionClass:"",frameClass:"krajee-default",mainClass:"file-caption-main",mainTemplate:null,purifyHtml:!0,fileSizeGetter:null,initialCaption:"",initialPreview:[],initialPreviewDelimiter:"*$$*",initialPreviewAsData:!1,initialPreviewFileType:"image",initialPreviewConfig:[],initialPreviewThumbTags:[],previewThumbTags:{},initialPreviewShowDelete:!0,initialPreviewDownloadUrl:"",removeFromPreviewOnError:!1,deleteUrl:"",deleteExtraData:{},overwriteInitial:!0,previewZoomButtonIcons:{prev:'<i class="glyphicon glyphicon-triangle-left"></i>',next:'<i class="glyphicon glyphicon-triangle-right"></i>',toggleheader:'<i class="glyphicon glyphicon-resize-vertical"></i>',fullscreen:'<i class="glyphicon glyphicon-fullscreen"></i>',borderless:'<i class="glyphicon glyphicon-resize-full"></i>',close:'<i class="glyphicon glyphicon-remove"></i>'},previewZoomButtonClasses:{prev:"btn btn-navigate",next:"btn btn-navigate",toggleheader:"btn btn-sm btn-kv btn-default btn-outline-secondary",fullscreen:"btn btn-sm btn-kv btn-default btn-outline-secondary",borderless:"btn btn-sm btn-kv btn-default btn-outline-secondary",close:"btn btn-sm btn-kv btn-default btn-outline-secondary"},previewTemplates:{},previewContentTemplates:{},preferIconicPreview:!1,preferIconicZoomPreview:!1,allowedPreviewTypes:void 0,allowedPreviewMimeTypes:null,allowedFileTypes:null,allowedFileExtensions:null,defaultPreviewContent:null,customLayoutTags:{},customPreviewTags:{},previewFileIcon:'<i class="glyphicon glyphicon-file"></i>',previewFileIconClass:"file-other-icon",previewFileIconSettings:{},previewFileExtSettings:{},buttonLabelClass:"hidden-xs",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i>&nbsp;',browseClass:"btn btn-primary",removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-default btn-secondary",cancelIcon:'<i class="glyphicon glyphicon-ban-circle"></i>',cancelClass:"btn btn-default btn-secondary",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-default btn-secondary",uploadUrl:null,uploadUrlThumb:null,uploadAsync:!0,uploadExtraData:{},zoomModalHeight:480,minImageWidth:null,minImageHeight:null,maxImageWidth:null,maxImageHeight:null,resizeImage:!1,resizePreference:"width",resizeQuality:.92,resizeDefaultImageType:"image/jpeg",resizeIfSizeMoreThan:0,minFileSize:0,maxFileSize:0,maxFilePreviewSize:25600,minFileCount:0,maxFileCount:0,validateInitialCount:!1,msgValidationErrorClass:"text-danger",msgValidationErrorIcon:'<i class="glyphicon glyphicon-exclamation-sign"></i> ',msgErrorClass:"file-error-message",progressThumbClass:"progress-bar bg-success progress-bar-success progress-bar-striped active",progressClass:"progress-bar bg-success progress-bar-success progress-bar-striped active",progressCompleteClass:"progress-bar bg-success progress-bar-success",progressErrorClass:"progress-bar bg-danger progress-bar-danger",progressUploadThreshold:99,previewFileType:"image",elCaptionContainer:null,elCaptionText:null,elPreviewContainer:null,elPreviewImage:null,elPreviewStatus:null,elErrorContainer:null,errorCloseButton:t.closeButton("kv-error-close"),slugCallback:null,dropZoneEnabled:!0,dropZoneTitleClass:"file-drop-zone-title",fileActionSettings:{},otherActionButtons:"",textEncoding:"UTF-8",ajaxSettings:{},ajaxDeleteSettings:{},showAjaxErrorDetails:!0,mergeAjaxCallbacks:!1,mergeAjaxDeleteCallbacks:!1,retryErrorUploads:!0,reversePreviewOrder:!1},e.fn.fileinputLocales.en={fileSingle:"file",filePlural:"files",browseLabel:"Browse &hellip;",removeLabel:"Remove",removeTitle:"Clear selected files",cancelLabel:"Cancel",cancelTitle:"Abort ongoing upload",uploadLabel:"Upload",uploadTitle:"Upload selected files",msgNo:"No",msgNoFilesSelected:"No files selected",msgCancelled:"Cancelled",msgPlaceholder:"Select {files}...",msgZoomModalHeading:"Detailed Preview",msgFileRequired:"You must select a file to upload.",msgSizeTooSmall:'File "{name}" (<b>{size} KB</b>) is too small and must be larger than <b>{minSize} KB</b>.',msgSizeTooLarge:'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',msgFilesTooLess:"You must select at least <b>{n}</b> {files} to upload.",msgFilesTooMany:"Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.",msgFileNotFound:'File "{name}" not found!',msgFileSecured:'Security restrictions prevent reading the file "{name}".',msgFileNotReadable:'File "{name}" is not readable.',msgFilePreviewAborted:'File preview aborted for "{name}".',msgFilePreviewError:'An error occurred while reading the file "{name}".',msgInvalidFileName:'Invalid or unsupported characters in file name "{name}".',msgInvalidFileType:'Invalid type for file "{name}". Only "{types}" files are supported.',msgInvalidFileExtension:'Invalid extension for file "{name}". Only "{extensions}" files are supported.',msgFileTypes:{image:"image",html:"HTML",text:"text",video:"video",audio:"audio",flash:"flash",pdf:"PDF",object:"object"},msgUploadAborted:"The file upload was aborted",msgUploadThreshold:"Processing...",msgUploadBegin:"Initializing...",msgUploadEnd:"Done",msgUploadEmpty:"No valid data available for upload.",msgUploadError:"Error",msgValidationError:"Validation Error",msgLoading:"Loading file {index} of {files} &hellip;",msgProgress:"Loading file {index} of {files} - {name} - {percent}% completed.",msgSelected:"{n} {files} selected",msgFoldersNotAllowed:"Drag & drop files only! {n} folder(s) dropped were skipped.",msgImageWidthSmall:'Width of image file "{name}" must be at least {size} px.',msgImageHeightSmall:'Height of image file "{name}" must be at least {size} px.',msgImageWidthLarge:'Width of image file "{name}" cannot exceed {size} px.',msgImageHeightLarge:'Height of image file "{name}" cannot exceed {size} px.',msgImageResizeError:"Could not get the image dimensions to resize.",msgImageResizeException:"Error while resizing the image.<pre>{errors}</pre>",msgAjaxError:"Something went wrong with the {operation} operation. Please try again later!",msgAjaxProgressError:"{operation} failed",ajaxOperations:{deleteThumb:"file delete",uploadThumb:"file upload",uploadBatch:"batch file upload",uploadExtra:"form data upload"},dropZoneTitle:"Drag & drop files here &hellip;",dropZoneClickTitle:"<br>(or click to select {files})",previewZoomButtonTitles:{prev:"View previous file",next:"View next file",toggleheader:"Toggle header",fullscreen:"Toggle full screen",borderless:"Toggle borderless mode",close:"Close detailed preview"},usePdfRenderer:function(){var e=!!window.MSInputMethodContext&&!!document.documentMode;return!!navigator.userAgent.match(/(iPod|iPhone|iPad|Android)/i)||e},pdfRendererUrl:"",pdfRendererTemplate:'<iframe class="kv-preview-data file-preview-pdf" src="{renderer}?file={data}" {style}></iframe>'},e.fn.fileinput.Constructor=i,e(document).ready(function(){var t=e("input.file[type=file]");t.length&&t.fileinput()})}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.persianDate=t():e.persianDate=t()}(this,function(){return function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=8)}([function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(4).durationUnit,r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"toPersianDigit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.toString().replace(/\d+/g,function(e){var i=[],a=[],n=void 0,r=void 0;for(n=0;n<e.length;n+=1)i.push(e.charCodeAt(n));for(r=0;r<i.length;r+=1)a.push(String.fromCharCode(i[r]+(t&&!0===t?1584:1728)));return a.join("")})}},{key:"leftZeroFill",value:function(e,t){for(var i=e+"";i.length<t;)i="0"+i;return i}},{key:"normalizeDuration",value:function(){var e=void 0,t=void 0;return"string"==typeof arguments[0]?(e=arguments[0],t=arguments[1]):(t=arguments[0],e=arguments[1]),n.year.indexOf(e)>-1?e="year":n.month.indexOf(e)>-1?e="month":n.day.indexOf(e)>-1?e="day":n.hour.indexOf(e)>-1?e="hour":n.minute.indexOf(e)>-1?e="minute":n.second.indexOf(e)>-1?e="second":n.millisecond.indexOf(e)>-1&&(e="millisecond"),{unit:e,value:t}}},{key:"absRound",value:function(e){return e<0?Math.ceil(e):Math.floor(e)}},{key:"absFloor",value:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)}}]),e}();e.exports=r},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(10),r=i(2),o=i(0),s=i(5),l=(new o).toPersianDigit,d=(new o).leftZeroFill,h=(new o).normalizeDuration,c=i(7),u=i(6),p=function(){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendarType=t.calendarType,this.localType=t.localType,this.leapYearMode=t.leapYearMode,this.algorithms=new r(this),this.version="1.0.5",this._utcMode=!1,"fa"!==this.localType?this.formatPersian=!1:this.formatPersian="_default",this.setup(e),this.ON=this.algorithms.ON,this}return a(t,[{key:"setup",value:function(e){if(n.isDate(e))this._gDateToCalculators(e);else if(n.isArray(e))this.algorithmsCalc([e[0],e[1]?e[1]:1,e[2]?e[2]:1,e[3],e[4],e[5],e[6]?e[6]:0]);else if(n.isNumber(e)){var i=new Date(e);this._gDateToCalculators(i)}else if(e instanceof t)this.algorithmsCalc([e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]);else if(e&&"/Date("===e.substring(0,6)){var a=new Date(parseInt(e.substr(6)));this._gDateToCalculators(a)}else{var r=new Date;this._gDateToCalculators(r)}}},{key:"_getSyncedClass",value:function(e){return new(t.toCalendar(this.calendarType).toLocale(this.localType).toLeapYearMode(this.leapYearMode))(e)}},{key:"_gDateToCalculators",value:function(e){this.algorithms.calcGregorian([e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()])}},{key:"rangeName",value:function(){var e=this.calendarType;return"fa"===this.localType?"persian"===e?c.persian:c.gregorian:"persian"===e?u.persian:u.gregorian}},{key:"toLeapYearMode",value:function(e){return this.leapYearMode=e,"astronomical"===e&&"persian"==this.calendarType?this.leapYearMode="astronomical":"algorithmic"===e&&"persian"==this.calendarType&&(this.leapYearMode="algorithmic"),this.algorithms.updateFromGregorian(),this}},{key:"toCalendar",value:function(e){return this.calendarType=e,this.algorithms.updateFromGregorian(),this}},{key:"toLocale",value:function(e){return this.localType=e,"fa"!==this.localType?this.formatPersian=!1:this.formatPersian="_default",this}},{key:"_locale",value:function(){var e=this.calendarType;return"fa"===this.localType?"persian"===e?c.persian:c.gregorian:"persian"===e?u.persian:u.gregorian}},{key:"_weekName",value:function(e){return this._locale().weekdays[e-1]}},{key:"_weekNameShort",value:function(e){return this._locale().weekdaysShort[e-1]}},{key:"_weekNameMin",value:function(e){return this._locale().weekdaysMin[e-1]}},{key:"_dayName",value:function(e){return this._locale().persianDaysName[e-1]}},{key:"_monthName",value:function(e){return this._locale().months[e-1]}},{key:"_monthNameShort",value:function(e){return this._locale().monthsShort[e-1]}},{key:"isPersianDate",value:function(e){return e instanceof t}},{key:"clone",value:function(){return this._getSyncedClass(this.ON.gDate)}},{key:"algorithmsCalc",value:function(e){return this.isPersianDate(e)&&(e=[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]),"persian"===this.calendarType&&"algorithmic"==this.leapYearMode?this.algorithms.calcPersian(e):"persian"===this.calendarType&&"astronomical"==this.leapYearMode?this.algorithms.calcPersiana(e):"gregorian"===this.calendarType?(e[1]=e[1]-1,this.algorithms.calcGregorian(e)):void 0}},{key:"calendar",value:function(){var e=void 0;return"persian"==this.calendarType?"astronomical"==this.leapYearMode?e="persianAstro":"algorithmic"==this.leapYearMode&&(e="persianAlgo"):e="gregorian",this.ON[e]}},{key:"duration",value:function(e,t){return new s(e,t)}},{key:"isDuration",value:function(e){return e instanceof s}},{key:"years",value:function(e){return this.year(e)}},{key:"year",value:function(e){return e||0===e?(this.algorithmsCalc([e,this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]),this):this.calendar().year}},{key:"month",value:function(e){return e||0===e?(this.algorithmsCalc([this.year(),e,this.date()]),this):this.calendar().month+1}},{key:"days",value:function(){return this.day()}},{key:"day",value:function(){return this.calendar().weekday}},{key:"dates",value:function(e){return this.date(e)}},{key:"date",value:function(e){return e||0===e?(this.algorithmsCalc([this.year(),this.month(),e]),this):this.calendar().day}},{key:"hour",value:function(e){return this.hours(e)}},{key:"hours",value:function(e){return e||0===e?(this.algorithmsCalc([this.year(),this.month(),this.date(),e]),this):this.ON.gDate.getHours()}},{key:"minute",value:function(e){return this.minutes(e)}},{key:"minutes",value:function(e){return e||0===e?(this.algorithmsCalc([this.year(),this.month(),this.date(),this.hour(),e]),this):this.ON.gDate.getMinutes()}},{key:"second",value:function(e){return this.seconds(e)}},{key:"seconds",value:function(e){return e||0===e?(this.algorithmsCalc([this.year(),this.month(),this.date(),this.hour(),this.minute(),e]),this):this.ON.gDate.getSeconds()}},{key:"millisecond",value:function(e){return this.milliseconds(e)}},{key:"milliseconds",value:function(e){return e||0===e?(this.algorithmsCalc([this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),e]),this):this.ON.gregorian.millisecond}},{key:"unix",value:function(e){var t=void 0;if(e)return this._getSyncedClass(1e3*e);var i=this.ON.gDate.valueOf().toString();return t=i.substring(0,i.length-3),parseInt(t)}},{key:"valueOf",value:function(){return this.ON.gDate.valueOf()}},{key:"getFirstWeekDayOfMonth",value:function(e,t){return this._getSyncedClass([e,t,1]).day()}},{key:"diff",value:function(e,t,i){var a=e,n=this.ON.gDate-a.toDate()-0,r=this.year()-a.year(),o=this.month()-a.month(),s=-1*(this.date()-a.date()),l=void 0;return(l="months"===t||"month"===t?12*r+o+s/30:"years"===t||"year"===t?r+(o+s/30)/12:"seconds"===t||"second"===t?n/1e3:"minutes"===t||"minute"===t?n/6e4:"hours"===t||"hour"===t?n/36e5:"days"===t||"day"===t?n/864e5:"weeks"===t||"week"===t?n/6048e5:n)<0&&(l*=-1),i?l:Math.round(l)}},{key:"startOf",value:function(e){var i=t.toCalendar(this.calendarType).toLocale(this.localType);switch(e){case"years":case"year":return new i([this.year(),1,1]);case"months":case"month":return new i([this.year(),this.month(),1]);case"days":case"day":return new i([this.year(),this.month(),this.date(),0,0,0]);case"hours":case"hour":return new i([this.year(),this.month(),this.date(),this.hours(),0,0]);case"minutes":case"minute":return new i([this.year(),this.month(),this.date(),this.hours(),this.minutes(),0]);case"seconds":case"second":return new i([this.year(),this.month(),this.date(),this.hours(),this.minutes(),this.seconds()]);case"weeks":case"week":return new i([this.year(),this.month(),this.date()-(this.calendar().weekday-1)]);default:return this.clone()}}},{key:"endOf",value:function(e){var i=t.toCalendar(this.calendarType).toLocale(this.localType);switch(e){case"years":case"year":var a=this.isLeapYear()?30:29;return new i([this.year(),12,a,23,59,59]);case"months":case"month":var n=this.daysInMonth(this.year(),this.month());return new i([this.year(),this.month(),n,23,59,59]);case"days":case"day":return new i([this.year(),this.month(),this.date(),23,59,59]);case"hours":case"hour":return new i([this.year(),this.month(),this.date(),this.hours(),59,59]);case"minutes":case"minute":return new i([this.year(),this.month(),this.date(),this.hours(),this.minutes(),59]);case"seconds":case"second":return new i([this.year(),this.month(),this.date(),this.hours(),this.minutes(),this.seconds()]);case"weeks":case"week":var r=this.calendar().weekday;return new i([this.year(),this.month(),this.date()+(7-r)]);default:return this.clone()}}},{key:"sod",value:function(){return this.startOf("day")}},{key:"eod",value:function(){return this.endOf("day")}},{key:"zone",value:function(e){return e||0===e?(this.ON.zone=e,this):this.ON.zone}},{key:"local",value:function(){var e=void 0;if(this._utcMode){var i=new Date(this.toDate()).getTimezoneOffset(),a=60*i*1e3;e=i<0?this.valueOf()-a:this.valueOf()+a,this.toCalendar(t.calendarType);var n=new Date(e);return this._gDateToCalculators(n),this._utcMode=!1,this.zone(i),this}return this}},{key:"utc",value:function(e){var t=void 0;if(e)return this._getSyncedClass(e).utc();if(this._utcMode)return this;var i=60*this.zone()*1e3;t=this.zone()<0?this.valueOf()+i:this.valueOf()-i;var a=new Date(t),n=this._getSyncedClass(a);return this.algorithmsCalc(n),this._utcMode=!0,this.zone(0),this}},{key:"isUtc",value:function(){return this._utcMode}},{key:"isDST",value:function(){var e=this.month(),t=this.date();return 1==e&&t>1||6==e&&t<31||e<6&&e>=2}},{key:"isLeapYear",value:function(e){return void 0===e&&(e=this.year()),"persian"==this.calendarType&&"algorithmic"===this.leapYearMode?this.algorithms.leap_persian(e):"persian"==this.calendarType&&"astronomical"===this.leapYearMode?this.algorithms.leap_persiana(e):"gregorian"==this.calendarType?this.algorithms.leap_gregorian(e):void 0}},{key:"daysInMonth",value:function(e,t){var i=e||this.year(),a=t||this.month();return"persian"===this.calendarType?a<1||a>12?0:a<7?31:a<12?30:this.isLeapYear(i)?30:29:"gregorian"===this.calendarType?new Date(i,a,0).getDate():void 0}},{key:"toDate",value:function(){return this.ON.gDate}},{key:"toArray",value:function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]}},{key:"formatNumber",value:function(){var t=void 0;return"_default"===this.formatPersian?t=void 0!==e&&void 0!==e.exports?!1!==this.formatPersian:!1!==window.formatPersian:!0===this.formatPersian?t=!0:!1===this.formatPersian?t=!1:Error('Invalid Config "formatPersian" !!'),t}},{key:"format",value:function(e){var t=this,i=/([[^[]*])|(\\)?(Mo|MM?M?M?|Do|DD?D?D?|dddddd?|ddddd?|dddd?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?|X|LT|ll?l?l?|LL?L?L?)/g,a={year:t.year(),month:t.month(),hour:t.hours(),minute:t.minutes(),second:t.seconds(),date:t.date(),timezone:t.zone(),unix:t.unix()},n=t.formatNumber(),r=function(e){return n?l(e):e};function o(e){switch(e){case"a":return n?a.hour>=12?"ب ظ":"ق ظ":a.hour>=12?"PM":"AM";case"H":return r(a.hour);case"HH":return r(d(a.hour,2));case"h":return r(a.hour%12);case"hh":return r(d(a.hour%12,2));case"m":case"mm":return r(d(a.minute,2));case"s":return r(a.second);case"ss":return r(d(a.second,2));case"D":return r(d(a.date));case"DD":return r(d(a.date,2));case"DDD":var i=t.startOf("year");return r(d(t.diff(i,"days"),3));case"DDDD":var o=t.startOf("year");return r(d(t.diff(o,"days"),3));case"d":return r(t.calendar().weekday);case"ddd":return t._weekNameShort(t.calendar().weekday);case"dddd":return t._weekName(t.calendar().weekday);case"ddddd":return t._dayName(t.calendar().day);case"dddddd":return t._weekNameMin(t.calendar().weekday);case"w":var s=t.startOf("year"),l=parseInt(t.diff(s,"days")/7)+1;return r(l);case"ww":var h=t.startOf("year"),c=d(parseInt(t.diff(h,"days")/7)+1,2);return r(c);case"M":return r(a.month);case"MM":return r(d(a.month,2));case"MMM":return t._monthNameShort(a.month);case"MMMM":return t._monthName(a.month);case"YY":var u=a.year.toString().split("");return r(u[2]+u[3]);case"YYYY":return r(a.year);case"Z":var p="+",m=Math.round(a.timezone/60),f=a.timezone%60;f<0&&(f*=-1),m<0&&(p="-",m*=-1);var v=p+d(m,2)+":"+d(f,2);return r(v);case"ZZ":var g="+",w=Math.round(a.timezone/60),y=a.timezone%60;y<0&&(y*=-1),w<0&&(g="-",w*=-1);var b=g+d(w,2)+""+d(y,2);return r(b);case"X":return t.unix();case"LT":return t.format("H:m a");case"L":return t.format("YYYY/MM/DD");case"l":return t.format("YYYY/M/D");case"LL":return t.format("MMMM DD YYYY");case"ll":return t.format("MMM DD YYYY");case"LLL":return t.format("MMMM YYYY DD   H:m  a");case"lll":return t.format("MMM YYYY DD   H:m  a");case"LLLL":return t.format("dddd D MMMM YYYY  H:m  a");case"llll":return t.format("ddd D MMM YYYY  H:m  a")}}if(e)return e.replace(i,o);return"YYYY-MM-DD HH:mm:ss a".replace(i,o)}},{key:"add",value:function(e,t){var i=new s(e,t)._data,a=h(e,t).unit;if(t=h(e,t).value,"year"===a||"month"===a){if(i.years>0){var n=this.year()+i.years;this.year(n)}if(i.months>0){var r=this.date(),o=this.month()+i.months,l=this.daysInMonth(this.year(),o);r>=l&&(r=l),this.date(r),this.month(o)}}if("day"===a){var d=this.hour(),c=this.valueOf()+24*t*60*60*1e3;return this.unix(c/1e3).hour(d)}if("hour"===a){var u=this.valueOf()+60*t*60*1e3;return this.unix(u/1e3)}if("minute"===a){var p=this.valueOf()+60*t*1e3;return this.unix(p/1e3)}if("second"===a){var m=this.valueOf()+1e3*t;return this.unix(m/1e3)}if("millisecond"===a){var f=this.valueOf()+t;return this.unix(f/1e3)}return this._getSyncedClass(this.valueOf())}},{key:"subtract",value:function(e,t){var i=new s(e,t)._data,a=h(e,t).unit;if(t=h(e,t).value,"year"===a||"month"===a){if(i.years>0){var n=this.year()-i.years;this.year(n)}if(i.months>0){var r=this.date(),o=this.month()-i.months;this.month(o);var l=this.daysInMonth(this.year(),this.month());r>l&&(r=l),this.date(r)}}if("day"===a){var d=this.hour(),c=this.valueOf()-24*t*60*60*1e3;return this.unix(c/1e3).hour(d)}if("hour"===a){var u=this.valueOf()-60*t*60*1e3;return this.unix(u/1e3)}if("minute"===a){var p=this.valueOf()-60*t*1e3;return this.unix(p/1e3)}if("second"===a){var m=this.valueOf()-1e3*t;return this.unix(m/1e3)}if("millisecond"===a){var f=this.valueOf()-t;return this.unix(f/1e3)}return this._getSyncedClass(this.valueOf())}},{key:"isSameDay",value:function(e){return this&&e&&this.date()==e.date()&&this.year()==e.year()&&this.month()==e.month()}},{key:"isSameMonth",value:function(e){return this&&e&&this.year()==this.year()&&this.month()==e.month()}}],[{key:"rangeName",value:function(){var e=t,i=e.calendarType;return"fa"===e.localType?"persian"===i?c.persian:c.gregorian:"persian"===i?u.persian:u.gregorian}},{key:"toLeapYearMode",value:function(e){var i=t;return i.leapYearMode=e,i}},{key:"toCalendar",value:function(e){var i=t;return i.calendarType=e,i}},{key:"toLocale",value:function(e){var i=t;return i.localType=e,"fa"!==i.localType?i.formatPersian=!1:i.formatPersian="_default",i}},{key:"isPersianDate",value:function(e){return e instanceof t}},{key:"duration",value:function(e,t){return new s(e,t)}},{key:"isDuration",value:function(e){return e instanceof s}},{key:"unix",value:function(e){return e?new t(1e3*e):(new t).unix()}},{key:"getFirstWeekDayOfMonth",value:function(e,i){return new t([e,i,1]).day()}},{key:"utc",value:function(e){return e?new t(e).utc():(new t).utc()}},{key:"isSameDay",value:function(e,t){return e&&t&&e.date()==t.date()&&e.year()==t.year()&&e.month()==t.month()}},{key:"isSameMonth",value:function(e,t){return e&&t&&e.year()==t.year()&&e.month()==t.month()}}]),t}();e.exports=p},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(3),r=i(9),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.ASTRO=new n,this.ON=new r,this.J0000=1721424.5,this.J1970=2440587.5,this.JMJD=2400000.5,this.NormLeap=[!1,!0],this.GREGORIAN_EPOCH=1721425.5,this.PERSIAN_EPOCH=1948320.5}return a(e,[{key:"leap_gregorian",value:function(e){return e%4==0&&!(e%100==0&&e%400!=0)}},{key:"gregorian_to_jd",value:function(e,t,i){return this.GREGORIAN_EPOCH-1+365*(e-1)+Math.floor((e-1)/4)+-Math.floor((e-1)/100)+Math.floor((e-1)/400)+Math.floor((367*t-362)/12+(t<=2?0:this.leap_gregorian(e)?-1:-2)+i)}},{key:"jd_to_gregorian",value:function(e){var t,i,a,n,r,o,s,l,d,h,c,u,p=void 0;return i=(t=Math.floor(e-.5)+.5)-this.GREGORIAN_EPOCH,a=Math.floor(i/146097),n=this.ASTRO.mod(i,146097),r=Math.floor(n/36524),o=this.ASTRO.mod(n,36524),s=Math.floor(o/1461),l=this.ASTRO.mod(o,1461),p=400*a+100*r+4*s+(d=Math.floor(l/365)),4!==r&&4!==d&&p++,h=t-this.gregorian_to_jd(p,1,1),c=t<this.gregorian_to_jd(p,3,1)?0:this.leap_gregorian(p)?1:2,[p,u=Math.floor((12*(h+c)+373)/367),t-this.gregorian_to_jd(p,u,1)+1]}},{key:"tehran_equinox",value:function(e){var t;return 52.5/360,(t=this.ASTRO.equinox(e,0))-this.ASTRO.deltat(e)/86400+this.ASTRO.equationOfTime(t)+52.5/360}},{key:"tehran_equinox_jd",value:function(e){var t;return t=this.tehran_equinox(e),Math.floor(t)}},{key:"persiana_year",value:function(e){var t=this.jd_to_gregorian(e)[0]-2,i=void 0,a=void 0;for(i=this.tehran_equinox_jd(t);i>e;)t--,i=this.tehran_equinox_jd(t);for(a=i-1;!(i<=e&&e<a);)i=a,t++,a=this.tehran_equinox_jd(t);return[Math.round((i-this.PERSIAN_EPOCH)/this.ASTRO.TropicalYear)+1,i]}},{key:"jd_to_persiana",value:function(e){var t,i,a,n,r;return e=Math.floor(e)+.5,t=(a=this.persiana_year(e))[0],n=a[1],Math.floor((e-n)/30)+1,[t,i=(r=Math.floor(e)-this.persiana_to_jd(t,1,1)+1)<=186?Math.ceil(r/31):Math.ceil((r-6)/30),Math.floor(e)-this.persiana_to_jd(t,i,1)+1]}},{key:"persiana_to_jd",value:function(e,t,i){var a=void 0,n=void 0;for(n=this.PERSIAN_EPOCH-1+this.ASTRO.TropicalYear*(e-1-1),a=[e-1,0];a[0]<e;)n=(a=this.persiana_year(n))[1]+(this.ASTRO.TropicalYear+2);return a[1]+(t<=7?31*(t-1):30*(t-1)+6)+(i-1)}},{key:"leap_persiana",value:function(e){return this.persiana_to_jd(e+1,1,1)-this.persiana_to_jd(e,1,1)>365}},{key:"leap_persian",value:function(e){return 682*((e-(e>0?474:473))%2820+474+38)%2816<682}},{key:"persian_to_jd",value:function(e,t,i){var a,n;return a=e-(e>=0?474:473),n=474+this.ASTRO.mod(a,2820),i+(t<=7?31*(t-1):30*(t-1)+6)+Math.floor((682*n-110)/2816)+365*(n-1)+1029983*Math.floor(a/2820)+(this.PERSIAN_EPOCH-1)}},{key:"jd_to_persian",value:function(e){var t,i,a,n,r,o=void 0,s=void 0,l=void 0,d=void 0;return i=(e=Math.floor(e)+.5)-this.persian_to_jd(475,1,1),a=Math.floor(i/1029983),1029982===(n=this.ASTRO.mod(i,1029983))?s=2820:(l=Math.floor(n/366),d=this.ASTRO.mod(n,366),s=Math.floor((2134*l+2816*d+2815)/1028522)+l+1),(o=s+2820*a+474)<=0&&o--,[o,t=(r=e-this.persian_to_jd(o,1,1)+1)<=186?Math.ceil(r/31):Math.ceil((r-6)/30),e-this.persian_to_jd(o,t,1)+1]}},{key:"gWeekDayToPersian",value:function(e){return e+2===8?1:e+2===7?7:e+2}},{key:"updateFromGregorian",value:function(){var e,t,i,a,n,r=void 0,o=void 0;t=this.ON.gregorian.year,i=this.ON.gregorian.month,a=this.ON.gregorian.day,this.ON.gDate=new Date(t,i,a,this.ON.gregorian.hour,this.ON.gregorian.minute,this.ON.gregorian.second,this.ON.gregorian.millisecond),!1===this.parent._utcMode&&(this.ON.zone=this.ON.gDate.getTimezoneOffset()),this.ON.gregorian.year=this.ON.gDate.getFullYear(),this.ON.gregorian.month=this.ON.gDate.getMonth(),this.ON.gregorian.day=this.ON.gDate.getDate(),e=this.gregorian_to_jd(t,i+1,a)+Math.floor(.5)/86400,this.ON.julianday=e,this.ON.modifiedjulianday=e-this.JMJD,r=this.ASTRO.jwday(e),this.ON.gregorian.weekday=r+1,this.ON.gregorian.leap=this.NormLeap[this.leap_gregorian(t)?1:0],r=this.ASTRO.jwday(e),"persian"==this.parent.calendarType&&"algorithmic"==this.parent.leapYearMode&&(o=this.jd_to_persian(e),this.ON.persian.year=o[0],this.ON.persian.month=o[1]-1,this.ON.persian.day=o[2],this.ON.persian.weekday=this.gWeekDayToPersian(r),this.ON.persian.leap=this.NormLeap[this.leap_persian(o[0])?1:0]),"persian"==this.parent.calendarType&&"astronomical"==this.parent.leapYearMode&&(o=this.jd_to_persiana(e),this.ON.persianAstro.year=o[0],this.ON.persianAstro.month=o[1]-1,this.ON.persianAstro.day=o[2],this.ON.persianAstro.weekday=this.gWeekDayToPersian(r),this.ON.persianAstro.leap=this.NormLeap[this.leap_persiana(o[0])?1:0]),null!==this.ON.gregserial.day&&(this.ON.gregserial.day=e-this.J0000),n=864e5*(e-this.J1970),this.ON.unixtime=Math.round(n/1e3)}},{key:"calcGregorian",value:function(e){(e[0]||0===e[0])&&(this.ON.gregorian.year=e[0]),(e[1]||0===e[1])&&(this.ON.gregorian.month=e[1]),(e[2]||0===e[2])&&(this.ON.gregorian.day=e[2]),(e[3]||0===e[3])&&(this.ON.gregorian.hour=e[3]),(e[4]||0===e[4])&&(this.ON.gregorian.minute=e[4]),(e[5]||0===e[5])&&(this.ON.gregorian.second=e[5]),(e[6]||0===e[6])&&(this.ON.gregorian.millisecond=e[6]),this.updateFromGregorian()}},{key:"calcJulian",value:function(){var e,t;e=this.ON.julianday,t=this.jd_to_gregorian(e),this.ON.gregorian.year=t[0],this.ON.gregorian.month=t[1]-1,this.ON.gregorian.day=t[2],this.updateFromGregorian()}},{key:"setJulian",value:function(e){this.ON.julianday=e,this.calcJulian()}},{key:"calcPersian",value:function(e){e[0]&&(this.ON.persian.year=e[0]),e[1]&&(this.ON.persian.month=e[1]),e[2]&&(this.ON.persian.day=e[2]),e[3]&&(this.ON.gregorian.hour=e[3]),e[4]&&(this.ON.gregorian.minute=e[4]),e[5]&&(this.ON.gregorian.second=e[5]),e[6]&&(this.ON.gregorian.millisecond=e[6]),this.setJulian(this.persian_to_jd(this.ON.persian.year,this.ON.persian.month,this.ON.persian.day))}},{key:"calcPersiana",value:function(e){e[0]&&(this.ON.persianAstro.year=e[0]),e[1]&&(this.ON.persianAstro.month=e[1]),e[2]&&(this.ON.persianAstro.day=e[2]),e[3]&&(this.ON.gregorian.hour=e[3]),e[4]&&(this.ON.gregorian.minute=e[4]),e[5]&&(this.ON.gregorian.second=e[5]),e[6]&&(this.ON.gregorian.millisecond=e[6]),this.setJulian(this.persiana_to_jd(this.ON.persianAstro.year,this.ON.persianAstro.month,this.ON.persianAstro.day+.5))}}]),e}();e.exports=o},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.J2000=2451545,this.JulianCentury=36525,this.JulianMillennium=10*this.JulianCentury,this.TropicalYear=365.24219878,this.oterms=[-4680.93,-1.55,1999.25,-51.38,-249.67,-39.05,7.12,27.87,5.79,2.45],this.nutArgMult=[0,0,0,0,1,-2,0,0,2,2,0,0,0,2,2,0,0,0,0,2,0,1,0,0,0,0,0,1,0,0,-2,1,0,2,2,0,0,0,2,1,0,0,1,2,2,-2,-1,0,2,2,-2,0,1,0,0,-2,0,0,2,1,0,0,-1,2,2,2,0,0,0,0,0,0,1,0,1,2,0,-1,2,2,0,0,-1,0,1,0,0,1,2,1,-2,0,2,0,0,0,0,-2,2,1,2,0,0,2,2,0,0,2,2,2,0,0,2,0,0,-2,0,1,2,2,0,0,0,2,0,-2,0,0,2,0,0,0,-1,2,1,0,2,0,0,0,2,0,-1,0,1,-2,2,0,2,2,0,1,0,0,1,-2,0,1,0,1,0,-1,0,0,1,0,0,2,-2,0,2,0,-1,2,1,2,0,1,2,2,0,1,0,2,2,-2,1,1,0,0,0,-1,0,2,2,2,0,0,2,1,2,0,1,0,0,-2,0,2,2,2,-2,0,1,2,1,2,0,-2,0,1,2,0,0,0,1,0,-1,1,0,0,-2,-1,0,2,1,-2,0,0,0,1,0,0,2,2,1,-2,0,2,0,1,-2,1,0,2,1,0,0,1,-2,0,-1,0,1,0,0,-2,1,0,0,0,1,0,0,0,0,0,0,1,2,0,-1,-1,1,0,0,0,1,1,0,0,0,-1,1,2,2,2,-1,-1,2,2,0,0,-2,2,2,0,0,3,2,2,2,-1,0,2,2],this.nutArgCoeff=[-171996,-1742,92095,89,-13187,-16,5736,-31,-2274,-2,977,-5,2062,2,-895,5,1426,-34,54,-1,712,1,-7,0,-517,12,224,-6,-386,-4,200,0,-301,0,129,-1,217,-5,-95,3,-158,0,0,0,129,1,-70,0,123,0,-53,0,63,0,0,0,63,1,-33,0,-59,0,26,0,-58,-1,32,0,-51,0,27,0,48,0,0,0,46,0,-24,0,-38,0,16,0,-31,0,13,0,29,0,0,0,29,0,-12,0,26,0,0,0,-22,0,0,0,21,0,-10,0,17,-1,0,0,16,0,-8,0,-16,1,7,0,-15,0,9,0,-13,0,7,0,-12,0,6,0,11,0,0,0,-10,0,5,0,-8,0,3,0,7,0,-3,0,-7,0,0,0,-7,0,3,0,-7,0,3,0,6,0,0,0,6,0,-3,0,6,0,-3,0,-6,0,3,0,-6,0,3,0,5,0,0,0,-5,0,3,0,-5,0,3,0,-5,0,3,0,4,0,0,0,4,0,0,0,4,0,0,0,-4,0,0,0,-4,0,0,0,-4,0,0,0,3,0,0,0,-3,0,0,0,-3,0,0,0,-3,0,0,0,-3,0,0,0,-3,0,0,0,-3,0,0,0,-3,0,0,0],this.deltaTtab=[121,112,103,95,88,82,77,72,68,63,60,56,53,51,48,46,44,42,40,38,35,33,31,29,26,24,22,20,18,16,14,12,11,10,9,8,7,7,7,7,7,7,8,8,9,9,9,9,9,10,10,10,10,10,10,10,10,11,11,11,11,11,12,12,12,12,13,13,13,14,14,14,14,15,15,15,15,15,16,16,16,16,16,16,16,16,15,15,14,13,13.1,12.5,12.2,12,12,12,12,12,12,11.9,11.6,11,10.2,9.2,8.2,7.1,6.2,5.6,5.4,5.3,5.4,5.6,5.9,6.2,6.5,6.8,7.1,7.3,7.5,7.6,7.7,7.3,6.2,5.2,2.7,1.4,-1.2,-2.8,-3.8,-4.8,-5.5,-5.3,-5.6,-5.7,-5.9,-6,-6.3,-6.5,-6.2,-4.7,-2.8,-.1,2.6,5.3,7.7,10.4,13.3,16,18.2,20.2,21.1,22.4,23.5,23.8,24.3,24,23.9,23.9,23.7,24,24.3,25.3,26.2,27.3,28.2,29.1,30,30.7,31.4,32.2,33.1,34,35,36.5,38.3,40.2,42.2,44.5,46.5,48.5,50.5,52.2,53.8,54.9,55.8,56.9,58.3,60,61.6,63,65,66.6],this.EquinoxpTerms=[485,324.96,1934.136,203,337.23,32964.467,199,342.08,20.186,182,27.85,445267.112,156,73.14,45036.886,136,171.52,22518.443,77,222.54,65928.934,74,296.72,3034.906,70,243.58,9037.513,58,119.81,33718.147,52,297.17,150.678,50,21.02,2281.226,45,247.54,29929.562,44,325.15,31555.956,29,60.93,4443.417,18,155.12,67555.328,17,288.79,4562.452,16,198.04,62894.029,14,199.76,31436.921,12,95.39,14577.848,12,287.11,31931.756,12,320.81,34777.259,9,227.73,1222.114,8,15.45,16859.074],this.JDE0tab1000=[new Array(1721139.29189,365242.1374,.06134,.00111,-71e-5),new Array(1721233.25401,365241.72562,-.05323,.00907,25e-5),new Array(1721325.70455,365242.49558,-.11677,-.00297,74e-5),new Array(1721414.39987,365242.88257,-.00769,-.00933,-6e-5)],this.JDE0tab2000=[new Array(2451623.80984,365242.37404,.05169,-.00411,-57e-5),new Array(2451716.56767,365241.62603,.00325,.00888,-3e-4),new Array(2451810.21715,365242.01767,-.11575,.00337,78e-5),new Array(2451900.05952,365242.74049,-.06223,-.00823,32e-5)]}return a(e,[{key:"dtr",value:function(e){return e*Math.PI/180}},{key:"rtd",value:function(e){return 180*e/Math.PI}},{key:"fixangle",value:function(e){return e-360*Math.floor(e/360)}},{key:"fixangr",value:function(e){return e-2*Math.PI*Math.floor(e/(2*Math.PI))}},{key:"dsin",value:function(e){return Math.sin(this.dtr(e))}},{key:"dcos",value:function(e){return Math.cos(this.dtr(e))}},{key:"mod",value:function(e,t){return e-t*Math.floor(e/t)}},{key:"jwday",value:function(e){return this.mod(Math.floor(e+1.5),7)}},{key:"obliqeq",value:function(e){var t,i,a,n;if(a=i=(e-this.J2000)/(100*this.JulianCentury),t=23.43929111111111,Math.abs(i)<1)for(n=0;n<10;n++)t+=this.oterms[n]/3600*a,a*=i;return t}},{key:"nutation",value:function(e){var t,i,a,n,r,o,s=(e-2451545)/36525,l=[],d=0,h=0;for(n=s*(a=s*s),l[0]=this.dtr(297.850363+445267.11148*s-.0019142*a+n/189474),l[1]=this.dtr(357.52772+35999.05034*s-1603e-7*a-n/3e5),l[2]=this.dtr(134.96298+477198.867398*s+.0086972*a+n/56250),l[3]=this.dtr(93.27191+483202.017538*s-.0036825*a+n/327270),l[4]=this.dtr(125.04452-1934.136261*s+.0020708*a+n/45e4),t=0;t<5;t++)l[t]=this.fixangr(l[t]);for(r=s/10,t=0;t<63;t++){for(o=0,i=0;i<5;i++)0!==this.nutArgMult[5*t+i]&&(o+=this.nutArgMult[5*t+i]*l[i]);d+=(this.nutArgCoeff[4*t+0]+this.nutArgCoeff[4*t+1]*r)*Math.sin(o),h+=(this.nutArgCoeff[4*t+2]+this.nutArgCoeff[4*t+3]*r)*Math.cos(o)}return[d/36e6,h/36e6]}},{key:"deltat",value:function(e){var t,i,a,n;return e>=1620&&e<=2e3?(i=(e-1620)/2-(a=Math.floor((e-1620)/2)),t=this.deltaTtab[a]+(this.deltaTtab[a+1]-this.deltaTtab[a])*i):(n=(e-2e3)/100,e<948?t=2177+497*n+44.1*n*n:(t=102+102*n+25.3*n*n,e>2e3&&e<2100&&(t+=.37*(e-2100)))),t}},{key:"equinox",value:function(e,t){var i,a,n,r,o=void 0,s=void 0,l=void 0,d=void 0,h=void 0;for(e<1e3?(l=this.JDE0tab1000,h=e/1e3):(l=this.JDE0tab2000,h=(e-2e3)/1e3),r=35999.373*(n=((a=l[t][0]+l[t][1]*h+l[t][2]*h*h+l[t][3]*h*h*h+l[t][4]*h*h*h*h)-2451545)/36525)-2.47,i=1+.0334*this.dcos(r)+7e-4*this.dcos(2*r),d=0,o=s=0;o<24;o++)d+=this.EquinoxpTerms[s]*this.dcos(this.EquinoxpTerms[s+1]+this.EquinoxpTerms[s+2]*n),s+=3;return a+1e-5*d/i}},{key:"sunpos",value:function(e){var t,i,a,n,r,o,s,l,d,h,c,u,p=void 0,m=void 0,f=void 0,v=void 0;return p=280.46646+36000.76983*(t=(e-this.J2000)/this.JulianCentury)+3032e-7*(i=t*t),p=this.fixangle(p),m=357.52911+35999.05029*t+-1537e-7*i,m=this.fixangle(m),a=.016708634+-42037e-9*t+-1.267e-7*i,r=p+(n=(1.914602+-.004817*t+-14e-6*i)*this.dsin(m)+(.019993-101e-6*t)*this.dsin(2*m)+289e-6*this.dsin(3*m)),o=m+n,s=1.000001018*(1-a*a)/(1+a*this.dcos(o)),l=125.04-1934.136*t,d=r+-.00569+-.00478*this.dsin(l),h=(c=this.obliqeq(e))+.00256*this.dcos(l),f=this.rtd(Math.atan2(this.dcos(c)*this.dsin(r),this.dcos(r))),f=this.fixangle(f),u=this.rtd(Math.asin(this.dsin(c)*this.dsin(r))),v=this.rtd(Math.atan2(this.dcos(h)*this.dsin(d),this.dcos(d))),[p,m,a,n,r,o,s,d,f,u,v=this.fixangle(v),this.rtd(Math.asin(this.dsin(h)*this.dsin(d)))]}},{key:"equationOfTime",value:function(e){var t,i,a,n,r=void 0,o=void 0;return o=280.4664567+360007.6982779*(n=(e-this.J2000)/this.JulianMillennium)+.03032028*n*n+n*n*n/49931+-n*n*n*n/15300+-n*n*n*n*n/2e6,o=this.fixangle(o),t=this.sunpos(e)[10],i=this.nutation(e)[0],a=this.obliqeq(e)+this.nutation(e)[1],r=o+-.0057183+-t+i*this.dcos(a),r-=20*Math.floor(r/20),r/=1440}}]),e}();e.exports=n},function(e,t,i){"use strict";e.exports={durationUnit:{year:["y","years","year"],month:["M","months","month"],day:["d","days","day"],hour:["h","hours","hour"],minute:["m","minutes","minute"],second:["s","second","seconds"],millisecond:["ms","milliseconds","millisecond"],week:["w","","weeks","week"]}}},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(0),r=(new n).normalizeDuration,o=(new n).absRound,s=(new n).absFloor,l=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a,n={},l=this._data={},d=r(t,i);n[d.unit]=d.value,a=n.milliseconds||n.millisecond||n.ms||0;var h=n.years||n.year||n.y||0,c=n.months||n.month||n.M||0,u=n.weeks||n.w||n.week||0,p=n.days||n.d||n.day||0,m=n.hours||n.hour||n.h||0,f=n.minutes||n.minute||n.m||0,v=n.seconds||n.second||n.s||0;return this._milliseconds=a+1e3*v+6e4*f+36e5*m,this._days=p+7*u,this._months=c+12*h,l.milliseconds=a%1e3,v+=s(a/1e3),l.seconds=v%60,f+=o(v/60),l.minutes=f%60,m+=o(f/60),l.hours=m%24,p+=o(m/24),p+=7*u,l.days=p%30,c+=o(p/30),l.months=c%12,h+=o(c/12),l.years=h,this}return a(e,[{key:"valueOf",value:function(){return this._milliseconds+864e5*this._days+2592e6*this._months}}]),e}();e.exports=l},function(e,t,i){"use strict";e.exports={gregorian:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysMin:["Su","Mo","Tu","We","Th","Fr","Sa"]},persian:{months:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Dey","Bahman","Esfand"],monthsShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Dey","Bah","Esf"],weekdays:["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],persianDaysName:["Urmazd","Bahman","Ordibehesht","Shahrivar","Sepandarmaz","Khurdad","Amordad","Dey-be-azar","Azar","Aban","Khorshid","Mah","Tir","Gush","Dey-be-mehr","Mehr","Sorush","Rashn","Farvardin","Bahram","Ram","Bad","Dey-be-din","Din","Ord","Ashtad","Asman","Zamyad","Mantre-sepand","Anaram","Ziadi"]}}},function(e,t,i){"use strict";e.exports={gregorian:{months:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),monthsShort:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),weekdays:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysShort:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysMin:"ی_د_س_چ_پ_ج_ش".split("_")},persian:{months:["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],monthsShort:["فرو","ارد","خرد","تیر","مرد","شهر","مهر","آبا","آذر","دی","بهم","اسف"],weekdays:["شنبه","یکشنبه","دوشنبه","سه شنبه","چهار شنبه","پنج‌شنبه","جمعه"],weekdaysShort:["ش","ی","د","س","چ","پ","ج"],weekdaysMin:["ش","ی","د","س","چ","پ","ج"],persianDaysName:["اورمزد","بهمن","اوردیبهشت","شهریور","سپندارمذ","خورداد","امرداد","دی به آذز","آذز","آبان","خورشید","ماه","تیر","گوش","دی به مهر","مهر","سروش","رشن","فروردین","بهرام","رام","باد","دی به دین","دین","ارد","اشتاد","آسمان","زامیاد","مانتره سپند","انارام","زیادی"]}}},function(e,t,i){"use strict";var a=i(1);a.calendarType="persian",a.leapYearMode="astronomical",a.localType="fa",e.exports=a},function(e,t,i){"use strict";e.exports=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gDate=null,this.modifiedjulianday=0,this.julianday=0,this.gregserial={day:0},this.zone=0,this.gregorian={year:0,month:0,day:0,hour:0,minute:0,second:0,millisecond:0,weekday:0,unix:0,leap:0},this.juliancalendar={year:0,month:0,day:0,leap:0,weekday:0},this.islamic={year:0,month:0,day:0,leap:0,weekday:0},this.persianAlgo=this.persian={year:0,month:0,day:0,leap:0,weekday:0},this.persianAstro={year:0,month:0,day:0,leap:0,weekday:0},this.isoweek={year:0,week:0,day:0},this.isoday={year:0,day:0}}},function(e,t,i){"use strict";e.exports={isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isNumber:function(e){return"number"==typeof e},isDate:function(e){return e instanceof Date}}}])}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.persianDatepicker=t():e.persianDatepicker=t()}(this,function(){return function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=5)}([function(e,t,i){"use strict";var a,n,r={debounce:function(e,t,i){var a;return function(){var n=this,r=arguments,o=i&&!a;clearTimeout(a),a=setTimeout(function(){a=null,i||e.apply(n,r)},t),o&&e.apply(n,r)}},log:function(e){console.log(e)},isMobile:(n=!1,a=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(n=!0),n),debug:function(e,t){window.persianDatepickerDebug&&(e.constructor.name?console.log("Debug: "+e.constructor.name+" : "+t):console.log("Debug: "+t))},delay:function(e,t){clearTimeout(window.datepickerTimer),window.datepickerTimer=setTimeout(e,t)}};e.exports=r},function(e,t,i){"use strict";e.exports='\n<div id="plotId" class="datepicker-plot-area {{cssClass}}">\n    {{#navigator.enabled}}\n        <div data-navigator class="datepicker-navigator">\n            <div class="pwt-btn pwt-btn-next">{{navigator.text.btnNextText}}</div>\n            <div class="pwt-btn pwt-btn-switch">{{navigator.switch.text}}</div>\n            <div class="pwt-btn pwt-btn-prev">{{navigator.text.btnPrevText}}</div>\n        </div>\n    {{/navigator.enabled}}\n    <div class="datepicker-grid-view" >\n    {{#days.enabled}}\n        {{#days.viewMode}}\n        <div class="datepicker-day-view" >    \n            <div class="month-grid-box">\n                <div class="header">\n                    <div class="title"></div>\n                    <div class="header-row">\n                        {{#weekdays.list}}\n                            <div class="header-row-cell">{{.}}</div>\n                        {{/weekdays.list}}\n                    </div>\n                </div>    \n                <table cellspacing="0" class="table-days">\n                    <tbody>\n                        {{#days.list}}\n                           \n                            <tr>\n                                {{#.}}\n                                    {{#enabled}}\n                                        <td data-date="{{dataDate}}" data-unix="{{dataUnix}}" >\n                                            <span  class="{{#otherMonth}}other-month{{/otherMonth}}">{{title}}</span>\n                                            {{#altCalendarShowHint}}\n                                            <i  class="alter-calendar-day">{{alterCalTitle}}</i>\n                                            {{/altCalendarShowHint}}\n                                        </td>\n                                    {{/enabled}}\n                                    {{^enabled}}\n                                        <td data-date="{{dataDate}}" data-unix="{{dataUnix}}" class="disabled">\n                                            <span class="{{#otherMonth}}other-month{{/otherMonth}}">{{title}}</span>\n                                            {{#altCalendarShowHint}}\n                                            <i  class="alter-calendar-day">{{alterCalTitle}}</i>\n                                            {{/altCalendarShowHint}}\n                                        </td>\n                                    {{/enabled}}\n                                    \n                                {{/.}}\n                            </tr>\n                        {{/days.list}}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n        {{/days.viewMode}}\n    {{/days.enabled}}\n    \n    {{#month.enabled}}\n        {{#month.viewMode}}\n            <div class="datepicker-month-view">\n                {{#month.list}}\n                    {{#enabled}}               \n                        <div data-month="{{dataMonth}}" class="month-item {{#selected}}selected{{/selected}}">{{title}}</small></div>\n                    {{/enabled}}\n                    {{^enabled}}               \n                        <div data-month="{{dataMonth}}" class="month-item month-item-disable {{#selected}}selected{{/selected}}">{{title}}</small></div>\n                    {{/enabled}}\n                {{/month.list}}\n            </div>\n        {{/month.viewMode}}\n    {{/month.enabled}}\n    \n    {{#year.enabled }}\n        {{#year.viewMode }}\n            <div class="datepicker-year-view" >\n                {{#year.list}}\n                    {{#enabled}}\n                        <div data-year="{{dataYear}}" class="year-item {{#selected}}selected{{/selected}}">{{title}}</div>\n                    {{/enabled}}\n                    {{^enabled}}\n                        <div data-year="{{dataYear}}" class="year-item year-item-disable {{#selected}}selected{{/selected}}">{{title}}</div>\n                    {{/enabled}}                    \n                {{/year.list}}\n            </div>\n        {{/year.viewMode }}\n    {{/year.enabled }}\n    \n    </div>\n    {{#time}}\n    {{#enabled}}\n    <div class="datepicker-time-view">\n        {{#hour.enabled}}\n            <div class="hour time-segment" data-time-key="hour">\n                <div class="up-btn" data-time-key="hour">▲</div>\n                <input disabled value="{{hour.title}}" type="text" placeholder="hour" class="hour-input">\n                <div class="down-btn" data-time-key="hour">▼</div>                    \n            </div>       \n            <div class="divider">\n                <span>:</span>\n            </div>\n        {{/hour.enabled}}\n        {{#minute.enabled}}\n            <div class="minute time-segment" data-time-key="minute" >\n                <div class="up-btn" data-time-key="minute">▲</div>\n                <input disabled value="{{minute.title}}" type="text" placeholder="minute" class="minute-input">\n                <div class="down-btn" data-time-key="minute">▼</div>\n            </div>        \n            <div class="divider second-divider">\n                <span>:</span>\n            </div>\n        {{/minute.enabled}}\n        {{#second.enabled}}\n            <div class="second time-segment" data-time-key="second"  >\n                <div class="up-btn" data-time-key="second" >▲</div>\n                <input disabled value="{{second.title}}"  type="text" placeholder="second" class="second-input">\n                <div class="down-btn" data-time-key="second" >▼</div>\n            </div>\n            <div class="divider meridian-divider"></div>\n            <div class="divider meridian-divider"></div>\n        {{/second.enabled}}\n        {{#meridian.enabled}}\n            <div class="meridian time-segment" data-time-key="meridian" >\n                <div class="up-btn" data-time-key="meridian">▲</div>\n                <input disabled value="{{meridian.title}}" type="text" class="meridian-input">\n                <div class="down-btn" data-time-key="meridian">▼</div>\n            </div>\n        {{/meridian.enabled}}\n    </div>\n    {{/enabled}}\n    {{/time}}\n    \n    {{#toolbox}}\n    {{#enabled}}\n    <div class="toolbox">\n        {{#toolbox.submitButton.enabled}}\n            <div class="pwt-btn-submit">{{submitButtonText}}</div>\n        {{/toolbox.submitButton.enabled}}        \n        {{#toolbox.todayButton.enabled}}\n            <div class="pwt-btn-today">{{todayButtonText}}</div>\n        {{/toolbox.todayButton.enabled}}        \n        {{#toolbox.calendarSwitch.enabled}}\n            <div class="pwt-btn-calendar">{{calendarSwitchText}}</div>\n        {{/toolbox.calendarSwitch.enabled}}\n    </div>\n    {{/enabled}}\n    {{^enabled}}\n        {{#onlyTimePicker}}\n        <div class="toolbox">\n            <div class="pwt-btn-submit">{{submitButtonText}}</div>\n        </div>\n        {{/onlyTimePicker}}\n    {{/enabled}}\n    {{/toolbox}}\n</div>\n'},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(11),r=i(12),o=i(13),s=i(6),l=i(3),d=i(7),h=i(8),c=i(10),u=function(){function e(t,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.components(t,i)}return a(e,[{key:"components",value:function(e,t){return this.initialUnix=null,this.inputElement=e,this.options=new h(t,this),this.PersianDate=new c(this),this.state=new n(this),this.api=new l(this),this.input=new s(this,e),this.view=new o(this),this.toolbox=new r(this),this.updateInput=function(e){this.input.update(e)},this.state.setViewDateTime("unix",this.input.getOnInitState()),this.state.setSelectedDateTime("unix",this.input.getOnInitState()),this.view.render(),this.navigator=new d(this),this.api}}]),e}();e.exports=u},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t}return a(e,[{key:"show",value:function(){return this.model.view.show(),this.model.options.onShow(this.model),this.model}},{key:"getState",value:function(){return this.model.state}},{key:"hide",value:function(){return this.model.view.hide(),this.model.options.onHide(this.model),this.model}},{key:"toggle",value:function(){return this.model.view.toggle(),this.model.options.onToggle(this.model),this.model}},{key:"destroy",value:function(){this.model&&(this.model.view.destroy(),this.model.options.onDestroy(this.model),delete this.model)}},{key:"setDate",value:function(e){return this.model.state.setSelectedDateTime("unix",e),this.model.state.setViewDateTime("unix",e),this.model.state.setSelectedDateTime("unix",e),this.model.view.render(this.view),this.model.options.onSet(e),this.model}},{key:"options",get:function(){return this.model.options},set:function(e){var t=$.extend(!0,this.model.options,e);this.model.view.destroy(),this.model.components(this.model.inputElement,t)}}]),e}();e.exports=n},function(e,t,i){"use strict";var a=i(0),n={calendarType:"persian",calendar:{persian:{locale:"fa",showHint:!1,leapYearMode:"algorithmic"},gregorian:{locale:"en",showHint:!1}},responsive:!0,inline:!1,initialValue:!0,initialValueType:"gregorian",persianDigit:!0,viewMode:"day",format:"LLLL",formatter:function(e){return this.model.PersianDate.date(e).format(this.format)},altField:!1,altFormat:"unix",altFieldFormatter:function(e){var t=this.altFormat.toLowerCase();return"gregorian"===t||"g"===t?new Date(e):"unix"===t||"u"===t?e:this.model.PersianDate.date(e).format(this.altFormat)},minDate:null,maxDate:null,navigator:{enabled:!0,scroll:{enabled:!0},text:{btnNextText:"<",btnPrevText:">"},onNext:function(e){a.debug(e,"Event: onNext")},onPrev:function(e){a.debug(e,"Event: onPrev")},onSwitch:function(e){a.debug(e,"dayPicker Event: onSwitch")}},toolbox:{enabled:!0,text:{btnToday:"امروز"},submitButton:{enabled:a.isMobile,text:{fa:"تایید",en:"submit"},onSubmit:function(e){a.debug(e,"dayPicker Event: onSubmit")}},todayButton:{enabled:!0,text:{fa:"امروز",en:"today"},onToday:function(e){a.debug(e,"dayPicker Event: onToday")}},calendarSwitch:{enabled:!0,format:"MMMM",onSwitch:function(e){a.debug(e,"dayPicker Event: onSwitch")}},onToday:function(e){a.debug(e,"dayPicker Event: onToday")}},onlyTimePicker:!1,onlySelectOnDate:!0,checkDate:function(){return!0},checkMonth:function(){return!0},checkYear:function(){return!0},timePicker:{enabled:!1,step:1,hour:{enabled:!0,step:null},minute:{enabled:!0,step:null},second:{enabled:!0,step:null},meridian:{enabled:!1}},dayPicker:{enabled:!0,titleFormat:"YYYY MMMM",titleFormatter:function(e,t){return this.model.PersianDate.date([e,t]).format(this.model.options.dayPicker.titleFormat)},onSelect:function(e){a.debug(this,"dayPicker Event: onSelect : "+e)}},monthPicker:{enabled:!0,titleFormat:"YYYY",titleFormatter:function(e){return this.model.PersianDate.date(e).format(this.model.options.monthPicker.titleFormat)},onSelect:function(e){a.debug(this,"monthPicker Event: onSelect : "+e)}},yearPicker:{enabled:!0,titleFormat:"YYYY",titleFormatter:function(e){var t=12*parseInt(e/12,10),i=this.model.PersianDate.date([t]),a=this.model.PersianDate.date([t+11]);return i.format(this.model.options.yearPicker.titleFormat)+"-"+a.format(this.model.options.yearPicker.titleFormat)},onSelect:function(e){a.debug(this,"yearPicker Event: onSelect : "+e)}},onSelect:function(e){a.debug(this,"datepicker Event: onSelect : "+e)},onSet:function(e){a.debug(this,"datepicker Event: onSet : "+e)},position:"auto",onShow:function(e){a.debug(e,"Event: onShow ")},onHide:function(e){a.debug(e,"Event: onHide ")},onToggle:function(e){a.debug(e,"Event: onToggle ")},onDestroy:function(e){a.debug(e,"Event: onDestroy ")},autoClose:!1,template:null,observer:!1,inputDelay:800};e.exports=n},function(e,t,i){"use strict";var a,n=i(2);(a=jQuery).fn.persianDatepicker=a.fn.pDatepicker=function(e){var t=Array.prototype.slice.call(arguments),i=this;return this||a.error("Invalid selector"),a(this).each(function(){var r=t.concat([]),o=a(this).data("datepicker"),s=null;o&&"string"==typeof r[0]?(s=r[0],o[s](r[0])):i.pDatePicker=new n(this,e)}),a(this).data("datepicker",i.pDatePicker),i.pDatePicker}},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(0),r=i(9),o=function(){function e(t,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this._firstUpdate=!0,this.elem=i,this.model.options.observer&&this.observe(),this.addInitialClass(),this.initialUnix=null,0==this.model.options.inline&&this._attachInputElementEvents(),this}return a(e,[{key:"addInitialClass",value:function(){$(this.elem).addClass("pwt-datepicker-input-element")}},{key:"parseInput",value:function(e){var t=new r;if(void 0!==t.parse(e)){var i=this.model.PersianDate.date(t.parse(e)).valueOf();this.model.state.setSelectedDateTime("unix",i),this.model.state.setViewDateTime("unix",i),this.model.view.render()}}},{key:"observe",value:function(){var e=this;$(e.elem).bind("paste",function(t){n.delay(function(){e.parseInput(t.target.value)},60)});var t=void 0,i=e.model.options.inputDelay,a=!1,r=[17,91];$(document).keydown(function(e){$.inArray(e.keyCode,r)>0&&(a=!0)}).keyup(function(e){$.inArray(e.keyCode,r)>0&&(a=!1)}),$(e.elem).bind("keyup",function(n){var o=$(this),s=!1;(8===n.keyCode||n.keyCode<105&&n.keyCode>96||n.keyCode<58&&n.keyCode>47||a&&(86==n.keyCode||$.inArray(n.keyCode,r)>0))&&(s=!0),s&&(clearTimeout(t),t=setTimeout(function(){!function(t){e.parseInput(t.val())}(o)},i))}),$(e.elem).on("keydown",function(){clearTimeout(t)})}},{key:"_attachInputElementEvents",value:function(){var e=this,t=function t(i){$(i.target).is(e.elem)||$(i.target).is(e.model.view.$container)||0!=$(i.target).closest("#"+e.model.view.$container.attr("id")).length||$(i.target).is($(e.elem).children())||(e.model.api.hide(),$("body").unbind("click",t))};$(this.elem).on("focus click",n.debounce(function(i){return e.model.api.show(),!1===e.model.state.ui.isInline&&$("body").unbind("click",t).bind("click",t),n.isMobile&&$(this).blur(),i.stopPropagation(),!1},200)),$(this.elem).on("keydown",n.debounce(function(t){if(9===t.which)return e.model.api.hide(),!1},200))}},{key:"getInputPosition",value:function(){return $(this.elem).offset()}},{key:"getInputSize",value:function(){return{width:$(this.elem).outerWidth(),height:$(this.elem).outerHeight()}}},{key:"_updateAltField",value:function(e){var t=this.model.options.altFieldFormatter(e);$(this.model.options.altField).val(t)}},{key:"_updateInputField",value:function(e){var t=this.model.options.formatter(e);$(this.elem).val()!=t&&$(this.elem).val(t)}},{key:"update",value:function(e){0==this.model.options.initialValue&&this._firstUpdate?this._firstUpdate=!1:(this._updateInputField(e),this._updateAltField(e))}},{key:"getOnInitState",value:function(){var e=null,t=$(this.elem),i=void 0;if((i="INPUT"===t[0].nodeName?t[0].getAttribute("value"):t.data("date"))&&i.match("^([0-1][0-9]|2[0-3]):([0-5][0-9])(?::([0-5][0-9]))?$")){var a=i.split(":"),n=new Date;n.setHours(a[0]),n.setMinutes(a[1]),a[2]?n.setSeconds(a[2]):n.setSeconds(0),this.initialUnix=n.valueOf()}else{if("persian"===this.model.options.initialValueType&&i){var o=new r,s=new persianDate(o.parse(i)).valueOf();e=new Date(s).valueOf()}else"unix"===this.model.options.initialValueType&&i?e=parseInt(i):i&&(e=new Date(i).valueOf());this.initialUnix=e&&"undefined"!=e?e:(new Date).valueOf()}return this.initialUnix}}]),e}();e.exports=o},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(14),r=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.liveAttach(),this._attachEvents(),this}return a(e,[{key:"liveAttach",value:function(){if(this.model.options.navigator.scroll.enabled){var e=this,t=$("#"+e.model.view.id+" .datepicker-grid-view")[0];n(t).wheel(function(t,i){i>0?e.model.state.navigate("next"):e.model.state.navigate("prev"),e.model.view.render(),t.preventDefault()}),this.model.options.timePicker.enabled&&$("#"+e.model.view.id+" .time-segment").each(function(){n(this).wheel(function(t,i){var a=$(t.target),n=a.data("time-key")?a.data("time-key"):a.parents("[data-time-key]").data("time-key");n&&(i>0?e.timeUp(n):e.timeDown(n)),e.model.view.render(),t.preventDefault()})})}}},{key:"timeUp",value:function(e){if(null!=this.model.options.timePicker[e]){var t=void 0,i=void 0,a=this;"meridian"==e?(t=12,i="PM"==this.model.state.view.meridian?this.model.PersianDate.date(this.model.state.selected.unixDate).add("hour",t).valueOf():this.model.PersianDate.date(this.model.state.selected.unixDate).subtract("hour",t).valueOf(),this.model.state.meridianToggle()):(t=this.model.options.timePicker[e].step,i=this.model.PersianDate.date(this.model.state.selected.unixDate).add(e,t).valueOf()),this.model.state.setViewDateTime("unix",i),this.model.state.setSelectedDateTime("unix",i),this.model.view.renderTimePartial(),clearTimeout(this.scrollDelayTimeDown),this.scrollDelayTimeUp=setTimeout(function(){a.model.view.markSelectedDay()},300)}}},{key:"timeDown",value:function(e){if(null!=this.model.options.timePicker[e]){var t=void 0,i=void 0,a=this;"meridian"==e?(t=12,i="AM"==this.model.state.view.meridian?this.model.PersianDate.date(this.model.state.selected.unixDate).add("hour",t).valueOf():this.model.PersianDate.date(this.model.state.selected.unixDate).subtract("hour",t).valueOf(),this.model.state.meridianToggle()):(t=this.model.options.timePicker[e].step,i=this.model.PersianDate.date(this.model.state.selected.unixDate).subtract(e,t).valueOf()),this.model.state.setViewDateTime("unix",i),this.model.state.setSelectedDateTime("unix",i),this.model.view.renderTimePartial(),clearTimeout(this.scrollDelayTimeDown),this.scrollDelayTimeDown=setTimeout(function(){a.model.view.markSelectedDay()},300)}}},{key:"_attachEvents",value:function(){var e=this;this.model.options.navigator.enabled&&$(document).on("click","#"+e.model.view.id+" .pwt-btn",function(){$(this).is(".pwt-btn-next")?(e.model.state.navigate("next"),e.model.view.render(),e.model.options.navigator.onNext(e.model)):$(this).is(".pwt-btn-switch")?(e.model.state.switchViewMode(),e.model.view.render(),e.model.options.navigator.onSwitch(e.model)):$(this).is(".pwt-btn-prev")&&(e.model.state.navigate("prev"),e.model.view.render(),e.model.options.navigator.onPrev(e.model))}),this.model.options.timePicker.enabled&&($(document).on("click","#"+e.model.view.id+" .up-btn",function(){var t=$(this).data("time-key");e.timeUp(t),e.model.options.onSelect(e.model.state.selected.unixDate)}),$(document).on("click","#"+e.model.view.id+" .down-btn",function(){var t=$(this).data("time-key");e.timeDown(t),e.model.options.onSelect(e.model.state.selected.unixDate)})),this.model.options.dayPicker.enabled&&$(document).on("click","#"+e.model.view.id+" .datepicker-day-view td:not(.disabled)",function(){var t=$(this).data("unix"),i=void 0;e.model.state.setSelectedDateTime("unix",t),i=e.model.state.selected.month!==e.model.state.view.month,e.model.state.setViewDateTime("unix",e.model.state.selected.unixDate),e.model.options.autoClose&&(e.model.view.hide(),e.model.options.onHide(e)),i?e.model.view.render():e.model.view.markSelectedDay(),e.model.options.dayPicker.onSelect(t),e.model.options.onSelect(t)}),this.model.options.monthPicker.enabled&&$(document).on("click","#"+e.model.view.id+" .datepicker-month-view .month-item:not(.month-item-disable)",function(){var t=$(this).data("month");e.model.state.switchViewModeTo("day"),e.model.options.onlySelectOnDate||(e.model.state.setSelectedDateTime("month",t),e.model.options.autoClose&&(e.model.view.hide(),e.model.options.onHide(e))),e.model.state.setViewDateTime("month",t),e.model.view.render(),e.model.options.monthPicker.onSelect(t),e.model.options.onSelect(e.model.state.selected.unixDate)}),this.model.options.yearPicker.enabled&&$(document).on("click","#"+e.model.view.id+" .datepicker-year-view .year-item:not(.year-item-disable)",function(){var t=$(this).data("year");e.model.state.switchViewModeTo("month"),e.model.options.onlySelectOnDate||(e.model.state.setSelectedDateTime("year",t),e.model.options.autoClose&&(e.model.view.hide(),e.model.options.onHide(e))),e.model.state.setViewDateTime("year",t),e.model.view.render(),e.model.options.yearPicker.onSelect(t),e.model.options.onSelect(e.model.state.selected.unixDate)})}}]),e}();e.exports=r},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(4),r=i(1),o=function(){function e(t,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=i,this._compatibility($.extend(!0,this,n,t))}return a(e,[{key:"_compatibility",value:function(e){e.inline&&(e.toolbox.submitButton.enabled=!1),e.template||(e.template=r),persianDate.toCalendar(e.calendarType),persianDate.toLocale(e.calendar[e.calendarType].locale),e.onlyTimePicker&&(e.dayPicker.enabled=!1,e.monthPicker.enabled=!1,e.yearPicker.enabled=!1,e.navigator.enabled=!1,e.toolbox.enabled=!1,e.timePicker.enabled=!0),null===e.timePicker.hour.step&&(e.timePicker.hour.step=e.timePicker.step),null===e.timePicker.minute.step&&(e.timePicker.minute.step=e.timePicker.step),null===e.timePicker.second.step&&(e.timePicker.second.step=e.timePicker.step),!1===e.dayPicker.enabled&&(e.onlySelectOnDate=!1),e._viewModeList=[],e.dayPicker.enabled&&e._viewModeList.push("day"),e.monthPicker.enabled&&e._viewModeList.push("month"),e.yearPicker.enabled&&e._viewModeList.push("year")}}]),e}();e.exports=o},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pattern={iso:/^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(\\.[0-9]+)?(Z)?$/g,jalali:/^[1-4]\d{3}(\/|-|\.)((0?[1-6](\/|-|\.)((3[0-1])|([1-2][0-9])|(0?[1-9])))|((1[0-2]|(0?[7-9]))(\/|-|\.)(30|([1-2][0-9])|(0?[1-9]))))$/g}}return a(e,[{key:"parse",value:function(e){var t=new RegExp(this.pattern.iso),i=new RegExp(this.pattern.jalali);return String.prototype.toEnglishDigits=function(){var e="۰".charCodeAt(0);return this.replace(/[۰-۹]/g,function(t){return t.charCodeAt(0)-e})},e=e.toEnglishDigits(),i.test(e)?e.split(/\/|-|\,|\./).map(Number):t.test(e)?e.split(/\/|-|\,|\:|\T|\Z/g).map(Number):void 0}}]),e}();e.exports=n},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.model.options.calendar_=this.model.options.calendarType,this.model.options.locale_=this.model.options.calendar[this.model.options.calendarType].locale,this}return a(e,[{key:"date",value:function(e){window.inspdCount||0===window.inspdCount?window.inspdCount++:window.inspdCount=0;var t=void 0;return t=persianDate.toCalendar(this.model.options.calendar_),this.model.options.calendar[this.model.options.calendarType].leapYearMode&&t.toLeapYearMode(this.model.options.calendar[this.model.options.calendarType].leapYearMode),new t(e).toLocale(this.model.options.locale_)}}]),e}();e.exports=n},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.filetredDate=this.model.options.minDate||this.model.options.maxDate,this.viewModeList=this.model.options._viewModeList,this.viewMode=this.viewModeList.indexOf(t.options.viewMode)>0?t.options.viewMode:this.viewModeList[0],this.viewModeIndex=this.viewModeList.indexOf(t.options.viewMode)>0?this.viewModeList.indexOf(t.options.viewMode):0,this.filterDate={start:{year:0,month:0,date:0,hour:0,minute:0,second:0,unixDate:0},end:{year:0,month:0,date:0,hour:0,minute:0,second:0,unixDate:0}},this.view={year:0,month:0,date:0,hour:0,minute:0,second:0,unixDate:0,dateObject:null,meridian:"AM"},this.selected={year:0,month:0,date:0,hour:0,hour12:0,minute:0,second:0,unixDate:0,dateObject:null},this.ui={isOpen:!1,isInline:this.model.options.inline},this._setFilterDate(this.model.options.minDate,this.model.options.maxDate),this}return a(e,[{key:"_setFilterDate",value:function(e,t){e||(e=-2e15),t||(t=2e15);var i=this.model.PersianDate.date(e);this.filterDate.start.unixDate=e,this.filterDate.start.hour=i.hour(),this.filterDate.start.minute=i.minute(),this.filterDate.start.second=i.second(),this.filterDate.start.month=i.month(),this.filterDate.start.date=i.date(),this.filterDate.start.year=i.year();var a=this.model.PersianDate.date(t);this.filterDate.end.unixDate=t,this.filterDate.end.hour=a.hour(),this.filterDate.end.minute=a.minute(),this.filterDate.end.second=a.second(),this.filterDate.end.month=a.month(),this.filterDate.end.date=a.date(),this.filterDate.end.year=a.year()}},{key:"navigate",value:function(e){if("next"==e){if("year"==this.viewMode&&this.setViewDateTime("year",this.view.year+12),"month"==this.viewMode){var t=this.view.year+1;0===t&&(t=1),this.setViewDateTime("year",t)}if("day"==this.viewMode){var i=this.view.year+1;0===i&&(i=1),this.view.month+1==13?(this.setViewDateTime("year",i),this.setViewDateTime("month",1)):this.setViewDateTime("month",this.view.month+1)}}else{if("year"==this.viewMode&&this.setViewDateTime("year",this.view.year-12),"month"==this.viewMode){var a=this.view.year-1;0===a&&(a=-1),this.setViewDateTime("year",a)}if("day"==this.viewMode)if(this.view.month-1<=0){var n=this.view.year-1;0===n&&(n=-1),this.setViewDateTime("year",n),this.setViewDateTime("month",12)}else this.setViewDateTime("month",this.view.month-1)}}},{key:"switchViewMode",value:function(){return this.viewModeIndex=this.viewModeIndex+1>=this.viewModeList.length?0:this.viewModeIndex+1,this.viewMode=this.viewModeList[this.viewModeIndex]?this.viewModeList[this.viewModeIndex]:this.viewModeList[0],this._setViewDateTimeUnix(),this}},{key:"switchViewModeTo",value:function(e){this.viewModeList.indexOf(e)>=0&&(this.viewMode=e,this.viewModeIndex=this.viewModeList.indexOf(e))}},{key:"setSelectedDateTime",value:function(e,t){switch(e){case"unix":this.selected.unixDate=t;var i=this.model.PersianDate.date(t);this.selected.year=i.year(),this.selected.month=i.month(),this.selected.date=i.date(),this.selected.hour=i.hour(),this.selected.hour12=i.format("hh"),this.selected.minute=i.minute(),this.selected.second=i.second();break;case"year":this.selected.year=t;break;case"month":this.selected.month=t;break;case"date":this.selected.date=t;break;case"hour":this.selected.hour=t;break;case"minute":this.selected.minute=t;break;case"second":this.selected.second=t}return this._updateSelectedUnix(),this}},{key:"_updateSelectedUnix",value:function(){return this.selected.dateObject=this.model.PersianDate.date([this.selected.year,this.selected.month,this.selected.date,this.view.hour,this.view.minute,this.view.second]),this.selected.unixDate=this.selected.dateObject.valueOf(),this.model.updateInput(this.selected.unixDate),this}},{key:"_setViewDateTimeUnix",value:function(){return this.view.dateObject=this.model.PersianDate.date([this.view.year,this.view.month,this.view.date,this.view.hour,this.view.minute,this.view.second]),this.view.year=this.view.dateObject.year(),this.view.month=this.view.dateObject.month(),this.view.date=this.view.dateObject.date(),this.view.hour=this.view.dateObject.hour(),this.view.hour12=this.view.dateObject.format("hh"),this.view.minute=this.view.dateObject.minute(),this.view.second=this.view.dateObject.second(),this.view.unixDate=this.view.dateObject.valueOf(),this}},{key:"setViewDateTime",value:function(e,t){switch(e){case"unix":var i=this.model.PersianDate.date(t);this.view.year=i.year(),this.view.month=i.month(),this.view.date=i.date(),this.view.hour=i.hour(),this.view.minute=i.minute(),this.view.second=i.second();break;case"year":this.view.year=t;break;case"month":this.view.month=t;break;case"date":this.view.date=t;break;case"hour":this.view.hour=t;break;case"minute":this.view.minute=t;break;case"second":this.view.second=t}return this._setViewDateTimeUnix(),this}},{key:"meridianToggle",value:function(){"AM"===this.view.meridian?this.view.meridian="PM":"PM"===this.view.meridian&&(this.view.meridian="AM")}}]),e}();e.exports=n},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this._attachEvents(),this}return a(e,[{key:"_toggleCalendartype",value:function(){"persian"==this.model.options.calendar_?(this.model.options.calendar_="gregorian",this.model.options.locale_=this.model.options.calendar.gregorian.locale):(this.model.options.calendar_="persian",this.model.options.locale_=this.model.options.calendar.persian.locale)}},{key:"_attachEvents",value:function(){var e=this;$(document).on("click","#"+e.model.view.id+" .pwt-btn-today",function(){e.model.state.setSelectedDateTime("unix",(new Date).valueOf()),e.model.state.setViewDateTime("unix",(new Date).valueOf()),e.model.view.reRender(),e.model.options.toolbox.onToday(e.model),e.model.options.toolbox.todayButton.onToday(e.model)}),$(document).on("click","#"+e.model.view.id+" .pwt-btn-calendar",function(){e._toggleCalendartype(),e.model.state.setSelectedDateTime("unix",e.model.state.selected.unixDate),e.model.state.setViewDateTime("unix",e.model.state.view.unixDate),e.model.view.render(),e.model.options.toolbox.calendarSwitch.onSwitch(e.model)}),$(document).on("click","#"+e.model.view.id+" .pwt-btn-submit",function(){e.model.view.hide(),e.model.options.toolbox.submitButton.onSubmit(e.model),e.model.options.onHide(this)})}}]),e}();e.exports=n},function(e,t,i){"use strict";var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],a=!0,n=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);a=!0);}catch(e){n=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw r}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var r=i(1),o=i(0),s=i(15),l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.yearsViewCount=12,this.model=t,this.rendered=null,this.$container=null,this.id="persianDateInstance-"+parseInt(1e3*Math.random(100));return this.model.state.ui.isInline?this.$container=$('<div  id="'+this.id+'" class="datepicker-container-inline"></div>').appendTo(this.model.inputElement):(this.$container=$('<div  id="'+this.id+'" class="datepicker-container"></div>').appendTo("body"),this.hide(),this.setPickerBoxPosition(),this.addCompatibilityClass()),this}return n(e,[{key:"addCompatibilityClass",value:function(){o.isMobile&&this.model.options.responsive&&this.$container.addClass("pwt-mobile-view")}},{key:"destroy",value:function(){this.$container.remove()}},{key:"setPickerBoxPosition",value:function(){var e=this.model.input.getInputPosition(),t=this.model.input.getInputSize();if(o.isMobile&&this.model.options.responsive)return!1;"auto"===this.model.options.position?this.$container.css({left:e.left+"px",top:t.height+e.top+"px"}):this.$container.css({left:this.model.options.position[1]+e.left+"px",top:this.model.options.position[0]+e.top+"px"})}},{key:"show",value:function(){this.$container.removeClass("pwt-hide"),this.setPickerBoxPosition()}},{key:"hide",value:function(){this.$container.addClass("pwt-hide")}},{key:"toggle",value:function(){this.$container.toggleClass("pwt-hide")}},{key:"_getNavSwitchText",value:function(e){var t=void 0;return"day"==this.model.state.viewMode?t=this.model.options.dayPicker.titleFormatter.call(this,e.year,e.month):"month"==this.model.state.viewMode?t=this.model.options.monthPicker.titleFormatter.call(this,e.dateObject.valueOf()):"year"==this.model.state.viewMode&&(t=this.model.options.yearPicker.titleFormatter.call(this,e.year)),t}},{key:"checkYearAccess",value:function(e){if(this.model.state.filetredDate){var t=this.model.state.filterDate.start.year,i=this.model.state.filterDate.end.year;if(t&&e<t)return!1;if(i&&e>i)return!1}return this.model.options.checkYear(e)}},{key:"_getYearViewModel",value:function(e){var t=this,i=this.model.options.yearPicker.enabled;if(!i)return{enabled:!1};var a=[].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(Array(this.yearsViewCount).keys())).map(function(i){return i+parseInt(e.year/t.yearsViewCount)*t.yearsViewCount}),n=[],r=this.model.PersianDate.date(),o=!0,s=!1,l=void 0;try{for(var d,h=a[Symbol.iterator]();!(o=(d=h.next()).done);o=!0){var c=d.value;r.year([c]),n.push({title:r.format("YYYY"),enabled:this.checkYearAccess(c),dataYear:c,selected:this.model.state.selected.year==c})}}catch(e){s=!0,l=e}finally{try{!o&&h.return&&h.return()}finally{if(s)throw l}}return{enabled:i,viewMode:"year"==this.model.state.viewMode,list:n}}},{key:"checkMonthAccess",value:function(e){e+=1;var t=this.model.state.view.year;if(this.model.state.filetredDate){var i=this.model.state.filterDate.start.month,a=this.model.state.filterDate.end.month,n=this.model.state.filterDate.start.year,r=this.model.state.filterDate.end.year;if(i&&a&&(t==r&&e>a||t>r)||t==n&&e<i||t<n)return!1;if(a&&(t==r&&e>a||t>r))return!1;if(i&&(t==n&&e<i||t<n))return!1}return this.model.options.checkMonth(e,t)}},{key:"_getMonthViewModel",value:function(){var e=this.model.options.monthPicker.enabled;if(!e)return{enabled:!1};var t=[],i=!0,n=!1,r=void 0;try{for(var o,s=this.model.PersianDate.date().rangeName().months.entries()[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var l=a(o.value,2),d=l[0],h=l[1];t.push({title:h,enabled:this.checkMonthAccess(d),year:this.model.state.view.year,dataMonth:d+1,selected:this.model.state.selected.year==this.model.state.view.year&&this.model.state.selected.month==d+1})}}catch(e){n=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw r}}return{enabled:e,viewMode:"month"==this.model.state.viewMode,list:t}}},{key:"checkDayAccess",value:function(e){if(this.minDate=this.model.options.minDate,this.maxDate=this.model.options.maxDate,this.model.state.filetredDate)if(this.minDate&&this.maxDate){if(this.minDate=this.model.PersianDate.date(this.minDate).startOf("day").valueOf(),this.maxDate=this.model.PersianDate.date(this.maxDate).endOf("day").valueOf(),!(e>=this.minDate&&e<=this.maxDate))return!1}else if(this.minDate){if(this.minDate=this.model.PersianDate.date(this.minDate).startOf("day").valueOf(),e<=this.minDate)return!1}else if(this.maxDate&&(this.maxDate=this.model.PersianDate.date(this.maxDate).endOf("day").valueOf(),e>=this.maxDate))return!1;return this.model.options.checkDate(e)}},{key:"_getDayViewModel",value:function(){if("day"!=this.model.state.viewMode)return[];var e=this.model.options.dayPicker.enabled;if(!e)return{enabled:!1};var t=this.model.state.view.month,i=this.model.state.view.year,n=this.model.PersianDate.date(),r=n.daysInMonth(i,t),o=n.getFirstWeekDayOfMonth(i,t)-1,s=[],l=0,d=0,h=this._getAnotherCalendar(),c=this.model.PersianDate.date(),u=!0,p=!1,m=void 0;try{for(var f,v=[["null","null","null","null","null","null","null"],["null","null","null","null","null","null","null"],["null","null","null","null","null","null","null"],["null","null","null","null","null","null","null"],["null","null","null","null","null","null","null"],["null","null","null","null","null","null","null"]].entries()[Symbol.iterator]();!(u=(f=v.next()).done);u=!0){var g=a(f.value,2),w=g[0],y=g[1];s[w]=[];var b=!0,_=!1,k=void 0;try{for(var x,C=y.entries()[Symbol.iterator]();!(b=(x=C.next()).done);b=!0){var T=a(x.value,1)[0],D=void 0,S=void 0;0===w&&T<o?(D=c.unix(this.model.state.view.dateObject.startOf("month").valueOf()/1e3).subtract("days",o-T),S=!0):0===w&&T>=o||w<=5&&l<r?(l+=1,D=c.year(this.model.state.view.year).month(this.model.state.view.month).date(l),S=!1):(d+=1,D=c.unix(this.model.state.view.dateObject.endOf("month").valueOf()/1e3).add("days",d),S=!0),s[w].push({title:D.format("D"),alterCalTitle:new persianDate(D.valueOf()).toCalendar(h[0]).toLocale(h[1]).format("D"),dataDate:[D.year(),D.month(),D.date()].join(","),dataUnix:D.valueOf(),otherMonth:S,enabled:this.checkDayAccess(D.valueOf())})}}catch(e){_=!0,k=e}finally{try{!b&&C.return&&C.return()}finally{if(_)throw k}}}}catch(e){p=!0,m=e}finally{try{!u&&v.return&&v.return()}finally{if(p)throw m}}return{enabled:e,viewMode:"day"==this.model.state.viewMode,list:s}}},{key:"markSelectedDay",value:function(){var e=this.model.state.selected;this.$container.find(".table-days td").each(function(){$(this).data("date")==[e.year,e.month,e.date].join(",")?$(this).addClass("selected"):$(this).removeClass("selected")})}},{key:"markToday",value:function(){var e=new persianDate;this.$container.find(".table-days td").each(function(){$(this).data("date")==[e.year(),e.month(),e.date()].join(",")?$(this).addClass("today"):$(this).removeClass("today")})}},{key:"_getTimeViewModel",value:function(){var e=this.model.options.timePicker.enabled;if(!e)return{enabled:!1};return{enabled:e,hour:{title:this.model.options.timePicker.meridian.enabled?this.model.state.view.dateObject.format("hh"):this.model.state.view.dateObject.format("HH"),enabled:this.model.options.timePicker.hour.enabled},minute:{title:this.model.state.view.dateObject.format("mm"),enabled:this.model.options.timePicker.minute.enabled},second:{title:this.model.state.view.dateObject.format("ss"),enabled:this.model.options.timePicker.second.enabled},meridian:{title:this.model.state.view.dateObject.format("a"),enabled:this.model.options.timePicker.meridian.enabled}}}},{key:"_getWeekViewModel",value:function(){return{enabled:!0,list:this.model.PersianDate.date().rangeName().weekdaysMin}}},{key:"getCssClass",value:function(){return[this.model.state.ui.isInline?"datepicker-plot-area-inline-view":"",this.model.options.timePicker.meridian.enabled?"":"datepicker-state-no-meridian",this.model.options.onlyTimePicker?"datepicker-state-only-time":"",this.model.options.timePicker.second.enabled?"":"datepicker-state-no-second","gregorian"==this.model.options.calendar_?"datepicker-gregorian":"datepicker-persian"].join(" ")}},{key:"getViewModel",value:function(e){var t=this._getAnotherCalendar();return{plotId:"",navigator:{enabled:this.model.options.navigator.enabled,switch:{enabled:!0,text:this._getNavSwitchText(e)},text:this.model.options.navigator.text},selected:this.model.state.selected,time:this._getTimeViewModel(e),days:this._getDayViewModel(e),weekdays:this._getWeekViewModel(e),month:this._getMonthViewModel(e),year:this._getYearViewModel(e),toolbox:this.model.options.toolbox,cssClass:this.getCssClass(),onlyTimePicker:this.model.options.onlyTimePicker,altCalendarShowHint:this.model.options.calendar[t[0]].showHint,calendarSwitchText:this.model.state.view.dateObject.toCalendar(t[0]).toLocale(t[1]).format(this.model.options.toolbox.calendarSwitch.format),todayButtonText:this._getButtonText().todayButtontext,submitButtonText:this._getButtonText().submitButtonText}}},{key:"_getButtonText",value:function(){var e={};return"fa"==this.model.options.locale_?(e.todayButtontext=this.model.options.toolbox.todayButton.text.fa,e.submitButtonText=this.model.options.toolbox.submitButton.text.fa):"en"==this.model.options.locale_&&(e.todayButtontext=this.model.options.toolbox.todayButton.text.en,e.submitButtonText=this.model.options.toolbox.submitButton.text.en),e}},{key:"_getAnotherCalendar",value:function(){var e=void 0,t=void 0;return"persian"==this.model.options.calendar_?(e="gregorian",t=this.model.options.calendar.gregorian.locale):(e="persian",t=this.model.options.calendar.persian.locale),[e,t]}},{key:"renderTimePartial",value:function(){var e=this._getTimeViewModel(this.model.state.view);this.$container.find('[data-time-key="hour"] input').val(e.hour.title),this.$container.find('[data-time-key="minute"] input').val(e.minute.title),this.$container.find('[data-time-key="second"] input').val(e.second.title),this.$container.find('[data-time-key="meridian"] input').val(e.meridian.title)}},{key:"render",value:function(e){e||(e=this.model.state.view),o.debug(this,"render"),s.parse(r),this.rendered=$(s.render(this.model.options.template,this.getViewModel(e))),this.$container.empty().append(this.rendered),this.markSelectedDay(),this.markToday(),this.afterRender()}},{key:"reRender",value:function(){var e=this.model.state.view;this.render(e)}},{key:"afterRender",value:function(){this.model.navigator&&this.model.navigator.liveAttach()}}]),e}();e.exports=l},function(e,t,i){!function(t,i){"use strict";var a,n,r=function(e){return new r.Instance(e)};r.SUPPORT="wheel",r.ADD_EVENT="addEventListener",r.REMOVE_EVENT="removeEventListener",r.PREFIX="",r.READY=!1,r.Instance=function(e){return r.READY||(r.normalise.browser(),r.READY=!0),this.element=e,this.handlers=[],this},r.Instance.prototype={wheel:function(e,t){return r.event.add(this,r.SUPPORT,e,t),"DOMMouseScroll"===r.SUPPORT&&r.event.add(this,"MozMousePixelScroll",e,t),this},unwheel:function(e,t){return void 0===e&&(e=this.handlers.slice(-1)[0])&&(e=e.original),r.event.remove(this,r.SUPPORT,e,t),"DOMMouseScroll"===r.SUPPORT&&r.event.remove(this,"MozMousePixelScroll",e,t),this}},r.event={add:function(e,i,a,n){var o=a;a=function(e){e||(e=t.event);var i=r.normalise.event(e),a=r.normalise.delta(e);return o(i,a[0],a[1],a[2])},e.element[r.ADD_EVENT](r.PREFIX+i,a,n||!1),e.handlers.push({original:o,normalised:a})},remove:function(e,t,i,a){for(var n,o=i,s={},l=0,d=e.handlers.length;l<d;++l)s[e.handlers[l].original]=e.handlers[l];for(var h in i=(n=s[o]).normalised,e.element[r.REMOVE_EVENT](r.PREFIX+t,i,a||!1),e.handlers)if(e.handlers[h]==n){e.handlers.splice(h,1);break}}},r.normalise={browser:function(){"onwheel"in i||i.documentMode>=9||(r.SUPPORT=void 0!==i.onmousewheel?"mousewheel":"DOMMouseScroll"),t.addEventListener||(r.ADD_EVENT="attachEvent",r.REMOVE_EVENT="detachEvent",r.PREFIX="on")},event:function(e){var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"===e.type?0:1,deltaX:0,deltaZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){e.stopPropagation?e.stopPropagation():e.cancelBubble=!1}};return e.wheelDelta&&(t.deltaY=-.025*e.wheelDelta),e.wheelDeltaX&&(t.deltaX=-.025*e.wheelDeltaX),e.detail&&(t.deltaY=e.detail),t},delta:function(e){var t,i,r,o=0,s=0,l=0;return e.deltaY&&(o=l=-1*e.deltaY),e.deltaX&&(o=-1*(s=e.deltaX)),e.wheelDelta&&(o=e.wheelDelta),e.wheelDeltaY&&(l=e.wheelDeltaY),e.wheelDeltaX&&(s=-1*e.wheelDeltaX),e.detail&&(o=-1*e.detail),0===o?[0,0,0]:(t=Math.abs(o),(!a||t<a)&&(a=t),i=Math.max(Math.abs(l),Math.abs(s)),(!n||i<n)&&(n=i),r=o>0?"floor":"ceil",[o=Math[r](o/a),s=Math[r](s/n),l=Math[r](l/n)])}},"function"==typeof t.define&&t.define.amd?t.define("hamster",[],function(){return r}):e.exports=r}(window,window.document)},function(e,t,i){var a,n,r,o;o=function(e){var t=Object.prototype.toString,i=Array.isArray||function(e){return"[object Array]"===t.call(e)};function a(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return null!=e&&"object"==typeof e&&t in e}var o=RegExp.prototype.test,s=/\S/;function l(e){return!function(e,t){return o.call(e,t)}(s,e)}var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},h=/\s*/,c=/\s+/,u=/\s*=/,p=/\s*\}/,m=/#|\^|\/|>|\{|&|=|!/;function f(e){this.string=e,this.tail=e,this.pos=0}function v(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function g(){this.cache={}}f.prototype.eos=function(){return""===this.tail},f.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var i=t[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},f.prototype.scanUntil=function(e){var t,i=this.tail.search(e);switch(i){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=t.length,t},v.prototype.push=function(e){return new v(e,this)},v.prototype.lookup=function(e){var t,i,n,o=this.cache;if(o.hasOwnProperty(e))t=o[e];else{for(var s,l,d,h=this,c=!1;h;){if(e.indexOf(".")>0)for(s=h.view,l=e.split("."),d=0;null!=s&&d<l.length;)d===l.length-1&&(c=r(s,l[d])||(i=s,n=l[d],null!=i&&"object"!=typeof i&&i.hasOwnProperty&&i.hasOwnProperty(n))),s=s[l[d++]];else s=h.view[e],c=r(h.view,e);if(c){t=s;break}h=h.parent}o[e]=t}return a(t)&&(t=t.call(this.view)),t},g.prototype.clearCache=function(){this.cache={}},g.prototype.parse=function(t,a){var r=this.cache,o=t+":"+(a||e.tags).join(":"),s=r[o];return null==s&&(s=r[o]=function(t,a){if(!t)return[];var r,o,s,d=[],v=[],g=[],w=!1,y=!1;function b(){if(w&&!y)for(;g.length;)delete v[g.pop()];else g=[];w=!1,y=!1}function _(e){if("string"==typeof e&&(e=e.split(c,2)),!i(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(n(e[0])+"\\s*"),o=new RegExp("\\s*"+n(e[1])),s=new RegExp("\\s*"+n("}"+e[1]))}_(a||e.tags);for(var k,x,C,T,D,S,P=new f(t);!P.eos();){if(k=P.pos,C=P.scanUntil(r))for(var E=0,M=C.length;E<M;++E)l(T=C.charAt(E))?g.push(v.length):y=!0,v.push(["text",T,k,k+1]),k+=1,"\n"===T&&b();if(!P.scan(r))break;if(w=!0,x=P.scan(m)||"name",P.scan(h),"="===x?(C=P.scanUntil(u),P.scan(u),P.scanUntil(o)):"{"===x?(C=P.scanUntil(s),P.scan(p),P.scanUntil(o),x="&"):C=P.scanUntil(o),!P.scan(o))throw new Error("Unclosed tag at "+P.pos);if(D=[x,C,k,P.pos],v.push(D),"#"===x||"^"===x)d.push(D);else if("/"===x){if(!(S=d.pop()))throw new Error('Unopened section "'+C+'" at '+k);if(S[1]!==C)throw new Error('Unclosed section "'+S[1]+'" at '+k)}else"name"===x||"{"===x||"&"===x?y=!0:"="===x&&_(C)}if(S=d.pop())throw new Error('Unclosed section "'+S[1]+'" at '+P.pos);return function(e){for(var t,i=[],a=i,n=[],r=0,o=e.length;r<o;++r)switch((t=e[r])[0]){case"#":case"^":a.push(t),n.push(t),a=t[4]=[];break;case"/":n.pop()[5]=t[2],a=n.length>0?n[n.length-1][4]:i;break;default:a.push(t)}return i}(function(e){for(var t,i,a=[],n=0,r=e.length;n<r;++n)(t=e[n])&&("text"===t[0]&&i&&"text"===i[0]?(i[1]+=t[1],i[3]=t[3]):(a.push(t),i=t));return a}(v))}(t,a)),s},g.prototype.render=function(e,t,i,a){var n=this.parse(e,a),r=t instanceof v?t:new v(t);return this.renderTokens(n,r,i,e,a)},g.prototype.renderTokens=function(e,t,i,a,n){for(var r,o,s,l="",d=0,h=e.length;d<h;++d)s=void 0,"#"===(o=(r=e[d])[0])?s=this.renderSection(r,t,i,a):"^"===o?s=this.renderInverted(r,t,i,a):">"===o?s=this.renderPartial(r,t,i,n):"&"===o?s=this.unescapedValue(r,t):"name"===o?s=this.escapedValue(r,t):"text"===o&&(s=this.rawValue(r)),void 0!==s&&(l+=s);return l},g.prototype.renderSection=function(e,t,n,r){var o=this,s="",l=t.lookup(e[1]);if(l){if(i(l))for(var d=0,h=l.length;d<h;++d)s+=this.renderTokens(e[4],t.push(l[d]),n,r);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)s+=this.renderTokens(e[4],t.push(l),n,r);else if(a(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(t.view,r.slice(e[3],e[5]),function(e){return o.render(e,t,n)}))&&(s+=l)}else s+=this.renderTokens(e[4],t,n,r);return s}},g.prototype.renderInverted=function(e,t,a,n){var r=t.lookup(e[1]);if(!r||i(r)&&0===r.length)return this.renderTokens(e[4],t,a,n)},g.prototype.renderPartial=function(e,t,i,n){if(i){var r=a(i)?i(e[1]):i[e[1]];return null!=r?this.renderTokens(this.parse(r,n),t,i,r):void 0}},g.prototype.unescapedValue=function(e,t){var i=t.lookup(e[1]);if(null!=i)return i},g.prototype.escapedValue=function(t,i){var a=i.lookup(t[1]);if(null!=a)return e.escape(a)},g.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="3.0.1",e.tags=["{{","}}"];var w=new g;return e.clearCache=function(){return w.clearCache()},e.parse=function(e,t){return w.parse(e,t)},e.render=function(e,t,a,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(i(r=e)?"array":typeof r)+'" was given as the first argument for mustache#render(template, view, partials)');var r;return w.render(e,t,a,n)},e.to_html=function(t,i,n,r){var o=e.render(t,i,n);if(!a(r))return o;r(o)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return d[e]})},e.Scanner=f,e.Context=v,e.Writer=g,e},"object"==typeof t&&t&&"string"!=typeof t.nodeName?o(t):(n=[t],void 0===(r="function"==typeof(a=o)?a.apply(t,n):a)||(e.exports=r))}])});
