function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function getFormData(e){var t=e.serializeArray(),i={};return $.map(t,function(e,t){i[e.name]=e.value}),i}function updateUserCompletionProgress(e){$(".userCompletion-progress-bar").attr("aria-valuenow",e),$(".userCompletion-progress-bar").css({width:e+"%"}),$(".userCompletion-percent-text").html(e),$(".userCompletion-progress-bar").removeClass("bg-danger").removeClass("bg-warning").removeClass("bg-info").removeClass("bg-success"),(e=parseInt(e))<=25?$(".userCompletion-progress-bar").addClass("bg-danger"):e>25&&e<=50?$(".userCompletion-progress-bar").addClass("bg-warning"):e>50&&e<=75||(e>75&&e<100?$(".userCompletion-progress-bar").addClass("bg-info"):100===e&&$(".userCompletion-progress-bar").addClass("bg-success"))}!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){"use strict";var t,i;e.fn.fileinputLocales={},e.fn.fileinputThemes={},String.prototype.setTokens=function(e){var t,i,a=this.toString();for(t in e)e.hasOwnProperty(t)&&(i=new RegExp("{"+t+"}","g"),a=a.replace(i,e[t]));return a},t={FRAMES:".kv-preview-thumb",SORT_CSS:"file-sortable",OBJECT_PARAMS:'<param name="controller" value="true" />\n<param name="allowFullScreen" value="true" />\n<param name="allowScriptAccess" value="always" />\n<param name="autoPlay" value="false" />\n<param name="autoStart" value="false" />\n<param name="quality" value="high" />\n',DEFAULT_PREVIEW:'<div class="file-preview-other">\n<span class="{previewFileIconClass}">{previewFileIcon}</span>\n</div>',MODAL_ID:"kvFileinputModal",MODAL_EVENTS:["show","shown","hide","hidden","loaded"],logMessages:{ajaxError:"{status}: {error}. Error Details: {text}.",badDroppedFiles:"Error scanning dropped files!",badExifParser:"Error loading the piexif.js library. {details}",badInputType:'The input "type" must be set to "file" for initializing the "bootstrap-fileinput" plugin.',exifWarning:"To avoid this warning, either set `autoOrientImage` to `false` OR ensure you have loaded the piexif.js library correctly on your page.",invalidChunkSize:'Invalid "uploadResumableSize" ({chunkSize}). Resumable uploads are disabled.',invalidThumb:'Invalid thumb frame with id: "{id}".',noResumableSupport:"The browser does not support resumable or chunk uploads.",noUploadUrl:'The "uploadUrl" is not set. Ajax uploads and resumable uploads have been disabled.',retryStatus:"Retrying upload for chunk # {chunk} for {filename}... retry # {retry}."},objUrl:window.URL||window.webkitURL,now:function(){return new Date},round:function(e){return e=parseFloat(e),isNaN(e)?0:Math.floor(Math.round(e))},getFileRelativePath:function(e){return String(e.relativePath||e.webkitRelativePath||t.getFileName(e)||null)},getFileId:function(e,i){var a=t.getFileRelativePath(e);return"function"==typeof i?i(e):e&&a?e.size+"_"+a.replace(/\s/gim,"_"):null},getElapsed:function(t){var i=t,a="",n={},r={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};return Object.keys(r).forEach(function(e){n[e]=Math.floor(i/r[e]),i-=n[e]*r[e]}),e.each(n,function(e,t){t>0&&(a+=(a?" ":"")+t+e.substring(0,1))}),a},debounce:function(e,t){var i;return function(){var a=arguments,n=this;clearTimeout(i),i=setTimeout(function(){e.apply(n,a)},t)}},stopEvent:function(e){e.stopPropagation(),e.preventDefault()},getFileName:function(e){return e&&(e.fileName||e.name)||""},createObjectURL:function(e){return t.objUrl&&t.objUrl.createObjectURL&&e?t.objUrl.createObjectURL(e):""},revokeObjectURL:function(e){t.objUrl&&t.objUrl.revokeObjectURL&&e&&t.objUrl.revokeObjectURL(e)},compare:function(e,t,i){return void 0!==e&&(i?e===t:e.match(t))},isIE:function(e){var t,i;return"Microsoft Internet Explorer"===navigator.appName&&(10===e?new RegExp("msie\\s"+e,"i").test(navigator.userAgent):((t=document.createElement("div")).innerHTML="\x3c!--[if IE "+e+"]> <i></i> <![endif]--\x3e",i=t.getElementsByTagName("i").length,document.body.appendChild(t),t.parentNode.removeChild(t),i))},canAssignFilesToInput:function(){var e=document.createElement("input");try{return e.type="file",e.files=null,!0}catch(e){return!1}},getDragDropFolders:function(e){var t,i,a=e?e.length:0,n=0;if(a>0&&e[0].webkitGetAsEntry())for(t=0;t<a;t++)(i=e[t].webkitGetAsEntry())&&i.isDirectory&&n++;return n},initModal:function(t){var i=e("body");i.length&&t.appendTo(i)},isEmpty:function(t,i){return null==t||0===t.length||i&&""===e.trim(t)},isArray:function(e){return Array.isArray(e)||"[object Array]"===Object.prototype.toString.call(e)},ifSet:function(e,t,i){return i=i||"",t&&"object"===_typeof(t)&&e in t?t[e]:i},cleanArray:function(e){return e instanceof Array||(e=[]),e.filter(function(e){return null!=e})},spliceArray:function(t,i,a){var n,r,o=0,s=[];if(!(t instanceof Array))return[];for(r=e.extend(!0,[],t),a&&r.reverse(),n=0;n<r.length;n++)n!==i&&(s[o]=r[n],o++);return a&&s.reverse(),s},getNum:function(e,t){return t=t||0,"number"==typeof e?e:("string"==typeof e&&(e=parseFloat(e)),isNaN(e)?t:e)},hasFileAPISupport:function(){return!(!window.File||!window.FileReader)},hasDragDropSupport:function(){var e=document.createElement("div");return!t.isIE(9)&&(void 0!==e.draggable||void 0!==e.ondragstart&&void 0!==e.ondrop)},hasFileUploadSupport:function(){return t.hasFileAPISupport()&&window.FormData},hasBlobSupport:function(){try{return!!window.Blob&&Boolean(new Blob)}catch(e){return!1}},hasArrayBufferViewSupport:function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}},hasResumableUploadSupport:function(){return t.hasFileUploadSupport()&&t.hasBlobSupport()&&t.hasArrayBufferViewSupport()&&(!!Blob.prototype.webkitSlice||!!Blob.prototype.mozSlice||!!Blob.prototype.slice||!1)},dataURI2Blob:function(e){var i,a,n,r,o,s,l=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,d=t.hasBlobSupport();if(!((d||l)&&window.atob&&window.ArrayBuffer&&window.Uint8Array))return null;for(i=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):decodeURIComponent(e.split(",")[1]),a=new ArrayBuffer(i.length),n=new Uint8Array(a),r=0;r<i.length;r+=1)n[r]=i.charCodeAt(r);return o=e.split(",")[0].split(":")[1].split(";")[0],d?new Blob([t.hasArrayBufferViewSupport()?n:a],{type:o}):((s=new l).append(a),s.getBlob(o))},arrayBuffer2String:function(e){if(window.TextDecoder)return new TextDecoder("utf-8").decode(e);var t,i,a,n,r=Array.prototype.slice.apply(new Uint8Array(e)),o="",s=0;for(t=r.length;s<t;)switch((i=r[s++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(i);break;case 12:case 13:a=r[s++],o+=String.fromCharCode((31&i)<<6|63&a);break;case 14:a=r[s++],n=r[s++],o+=String.fromCharCode((15&i)<<12|(63&a)<<6|(63&n)<<0)}return o},isHtml:function(e){var t=document.createElement("div");t.innerHTML=e;for(var i=t.childNodes,a=i.length;a--;)if(1===i[a].nodeType)return!0;return!1},isSvg:function(e){return e.match(/^\s*<\?xml/i)&&(e.match(/<!DOCTYPE svg/i)||e.match(/<svg/i))},getMimeType:function(e,t,i){switch(e){case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":return"image/jpeg";case"89504E47":return"image/png";case"47494638":return"image/gif";case"49492a00":return"image/tiff";case"52494646":return"image/webp";case"66747970":return"video/3gp";case"4f676753":return"video/ogg";case"1a45dfa3":return"video/mkv";case"000001ba":case"000001b3":return"video/mpeg";case"3026b275":return"video/wmv";case"25504446":return"application/pdf";case"25215053":return"application/ps";case"504b0304":case"504b0506":case"504b0508":return"application/zip";case"377abcaf":return"application/7z";case"75737461":return"application/tar";case"7801730d":return"application/dmg";default:switch(e.substring(0,6)){case"435753":return"application/x-shockwave-flash";case"494433":return"audio/mp3";case"425a68":return"application/bzip";default:switch(e.substring(0,4)){case"424d":return"image/bmp";case"fffb":return"audio/mp3";case"4d5a":return"application/exe";case"1f9d":case"1fa0":return"application/zip";case"1f8b":return"application/gzip";default:return t&&!t.match(/[^\u0000-\u007f]/)?"application/text-plain":i}}}},addCss:function(e,t){e.removeClass(t).addClass(t)},getElement:function(i,a,n){return t.isEmpty(i)||t.isEmpty(i[a])?n:e(i[a])},uniqId:function(){return Math.round((new Date).getTime())+"_"+Math.round(100*Math.random())},htmlEncode:function(e,t){return void 0===e?t||null:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},replaceTags:function(t,i){var a=t;return i?(e.each(i,function(e,t){"function"==typeof t&&(t=t()),a=a.split(e).join(t)}),a):a},cleanMemory:function(e){var i=e.is("img")?e.attr("src"):e.find("source").attr("src");t.revokeObjectURL(i)},findFileName:function(e){var t=e.lastIndexOf("/");return-1===t&&(t=e.lastIndexOf("\\")),e.split(e.substring(t,t+1)).pop()},checkFullScreen:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},toggleFullScreen:function(e){var i=document,a=i.documentElement;a&&e&&!t.checkFullScreen()?a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):i.exitFullscreen?i.exitFullscreen():i.msExitFullscreen?i.msExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.webkitExitFullscreen&&i.webkitExitFullscreen()},moveArray:function(t,i,a,n){var r=e.extend(!0,[],t);if(n&&r.reverse(),a>=r.length)for(var o=a-r.length;1+o--;)r.push(void 0);return r.splice(a,0,r.splice(i,1)[0]),n&&r.reverse(),r},cleanZoomCache:function(e){var t=e.closest(".kv-zoom-cache-theme");t.length||(t=e.closest(".kv-zoom-cache")),t.remove()},closeButton:function(e){return'<button type="button" class="'+(e=e?"close "+e:"close")+'" aria-label="Close">\n  <span aria-hidden="true">&times;</span>\n</button>'},getRotation:function(e){switch(e){case 2:return"rotateY(180deg)";case 3:return"rotate(180deg)";case 4:return"rotate(180deg) rotateY(180deg)";case 5:return"rotate(270deg) rotateY(180deg)";case 6:return"rotate(90deg)";case 7:return"rotate(90deg) rotateY(180deg)";case 8:return"rotate(270deg)";default:return""}},setTransform:function(e,t){e&&(e.style.transform=t,e.style.webkitTransform=t,e.style["-moz-transform"]=t,e.style["-ms-transform"]=t,e.style["-o-transform"]=t)},setImageOrientation:function(e,i,a){if(e&&e.length){var n="load.fileinputimageorient";e.off(n).on(n,function(){var n=e.get(0),r=i&&i.length?i.get(0):null,o=n.offsetHeight,s=n.offsetWidth,l=t.getRotation(a);if(e.data("orientation",a),r&&i.data("orientation",a),a<5)return t.setTransform(n,l),void t.setTransform(r,l);var d=Math.atan(s/o),u=Math.sqrt(Math.pow(o,2)+Math.pow(s,2)),c=u?o/Math.cos(Math.PI/2+d)/u:1,h=" scale("+Math.abs(c)+")";t.setTransform(n,l+h),t.setTransform(r,l+h)})}}},(i=function(i,a){this.$element=e(i),this.$parent=this.$element.parent(),this._validate()&&(this.isPreviewable=t.hasFileAPISupport(),this.isIE9=t.isIE(9),this.isIE10=t.isIE(10),(this.isPreviewable||this.isIE9)&&(this._init(a),this._listen()),this.$element.removeClass("file-loading"))}).prototype={constructor:i,_cleanup:function(){this.reader=null,this.clearFileStack(),this.fileBatchCompleted=!0,this.isError=!1,this.cancelling=!1,this.paused=!1,this.lastProgress=0,this._initAjax()},_initAjax:function(){this.ajaxQueue=[],this.ajaxRequests=[],this.ajaxQueueIntervalId=null,this.ajaxCurrentThreads=0,this.ajaxAborted=!1},_init:function(i,a){var n,r,o,s,l=this,d=l.$element;l.options=i,e.each(i,function(e,i){switch(e){case"minFileCount":case"maxFileCount":case"minFileSize":case"maxFileSize":case"maxFilePreviewSize":case"resizeImageQuality":case"resizeIfSizeMoreThan":case"progressUploadThreshold":case"initialPreviewCount":case"zoomModalHeight":case"minImageHeight":case"maxImageHeight":case"minImageWidth":case"maxImageWidth":l[e]=t.getNum(i);break;default:l[e]=i}}),l.rtl&&(s=l.previewZoomButtonIcons.prev,l.previewZoomButtonIcons.prev=l.previewZoomButtonIcons.next,l.previewZoomButtonIcons.next=s),!isNaN(l.maxAjaxThreads)&&l.maxAjaxThreads<l.resumableUploadOptions.maxThreads&&(l.resumableUploadOptions.maxThreads=l.maxAjaxThreads),l._initFileManager(),"function"==typeof l.autoOrientImage&&(l.autoOrientImage=l.autoOrientImage()),"function"==typeof l.autoOrientImageInitial&&(l.autoOrientImageInitial=l.autoOrientImageInitial()),a||l._cleanup(),l.$form=d.closest("form"),l._initTemplateDefaults(),l.uploadFileAttr=t.isEmpty(d.attr("name"))?"file_data":d.attr("name"),o=l._getLayoutTemplate("progress"),l.progressTemplate=o.replace("{class}",l.progressClass),l.progressInfoTemplate=o.replace("{class}",l.progressInfoClass),l.progressPauseTemplate=o.replace("{class}",l.progressPauseClass),l.progressCompleteTemplate=o.replace("{class}",l.progressCompleteClass),l.progressErrorTemplate=o.replace("{class}",l.progressErrorClass),l.isDisabled=d.attr("disabled")||d.attr("readonly"),l.isDisabled&&d.attr("disabled",!0),l.isClickable=l.browseOnZoneClick&&l.showPreview&&(l.dropZoneEnabled||!t.isEmpty(l.defaultPreviewContent)),l.isAjaxUpload=t.hasFileUploadSupport()&&!t.isEmpty(l.uploadUrl),l.dropZoneEnabled=t.hasDragDropSupport()&&l.dropZoneEnabled,l.isAjaxUpload||(l.dropZoneEnabled=l.dropZoneEnabled&&t.canAssignFilesToInput()),l.slug="function"==typeof i.slugCallback?i.slugCallback:l._slugDefault,l.mainTemplate=l.showCaption?l._getLayoutTemplate("main1"):l._getLayoutTemplate("main2"),l.captionTemplate=l._getLayoutTemplate("caption"),l.previewGenericTemplate=l._getPreviewTemplate("generic"),!l.imageCanvas&&l.resizeImage&&(l.maxImageWidth||l.maxImageHeight)&&(l.imageCanvas=document.createElement("canvas"),l.imageCanvasContext=l.imageCanvas.getContext("2d")),t.isEmpty(d.attr("id"))&&d.attr("id",t.uniqId()),l.namespace=".fileinput_"+d.attr("id").replace(/-/g,"_"),void 0===l.$container?l.$container=l._createContainer():l._refreshContainer(),r=l.$container,l.$dropZone=r.find(".file-drop-zone"),l.$progress=r.find(".kv-upload-progress"),l.$btnUpload=r.find(".fileinput-upload"),l.$captionContainer=t.getElement(i,"elCaptionContainer",r.find(".file-caption")),l.$caption=t.getElement(i,"elCaptionText",r.find(".file-caption-name")),t.isEmpty(l.msgPlaceholder)||(n=d.attr("multiple")?l.filePlural:l.fileSingle,l.$caption.attr("placeholder",l.msgPlaceholder.replace("{files}",n))),l.$captionIcon=l.$captionContainer.find(".file-caption-icon"),l.$previewContainer=t.getElement(i,"elPreviewContainer",r.find(".file-preview")),l.$preview=t.getElement(i,"elPreviewImage",r.find(".file-preview-thumbnails")),l.$previewStatus=t.getElement(i,"elPreviewStatus",r.find(".file-preview-status")),l.$errorContainer=t.getElement(i,"elErrorContainer",l.$previewContainer.find(".kv-fileinput-error")),l._validateDisabled(),t.isEmpty(l.msgErrorClass)||t.addCss(l.$errorContainer,l.msgErrorClass),a?l._errorsExist()||l.$errorContainer.hide():(l.$errorContainer.hide(),l.previewInitId="preview-"+t.uniqId(),l._initPreviewCache(),l._initPreview(!0),l._initPreviewActions(),l.$parent.hasClass("file-loading")&&(l.$container.insertBefore(l.$parent),l.$parent.remove())),l._setFileDropZoneTitle(),d.attr("disabled")&&l.disable(),l._initZoom(),l.hideThumbnailContent&&t.addCss(l.$preview,"hide-content")},_initFileManager:function(){var i=this;i.fileManager={stack:{},processed:[],errors:[],loadedImages:{},totalImages:0,totalFiles:null,totalSize:null,uploadedSize:0,stats:{},initStats:function(e){var a={started:t.now().getTime()};e?i.fileManager.stats[e]=a:i.fileManager.stats=a},getUploadStats:function(e,a,n){var r=i.fileManager,o=e&&r.stats[e]&&r.stats[e].started||null;o||(o=t.now().getTime());var s=(t.now().getTime()-o)/1e3,l=s?a/s:0,d={fileId:e,started:o,elapsed:s,loaded:a,total:n,bps:l,bitrate:i._getSize(l,["B/s","KB/s","MB/s","GB/s","TB/s","PB/s","EB/s","ZB/s","YB/s"]),pendingBytes:n-a};return e?r.stats[e]=d:r.stats=d,d},exists:function(t){return-1!==e.inArray(t,i.fileManager.getIdList())},count:function(){return i.fileManager.getIdList().length},total:function(){var e=i.fileManager;return e.totalFiles||(e.totalFiles=e.count()),e.totalFiles},getTotalSize:function(){var t=i.fileManager;return t.totalSize?t.totalSize:(t.totalSize=0,e.each(i.fileManager.stack,function(e,i){var a=parseFloat(i.size);t.totalSize+=isNaN(a)?0:a}),t.totalSize)},add:function(e,a){a||(a=i.fileManager.getId(e)),a&&(i.fileManager.stack[a]={file:e,name:t.getFileName(e),relativePath:t.getFileRelativePath(e),size:e.size,nameFmt:i._getFileName(e,""),sizeFmt:i._getSize(e.size)})},remove:function(e){var t=e.attr("data-fileid");t&&i.fileManager.removeFile(t)},removeFile:function(e){delete i.fileManager.stack[e],delete i.fileManager.loadedImages[e]},move:function(t,a){var n={},r=i.fileManager.stack;(t||a)&&t!==a&&(e.each(r,function(e,i){e!==t&&(n[e]=i),e===a&&(n[t]=r[t])}),i.fileManager.stack=n)},list:function(){var t=[];return e.each(i.fileManager.stack,function(e,i){i&&i.file&&t.push(i.file)}),t},isPending:function(t){return-1===e.inArray(t,i.fileManager.processed)&&i.fileManager.exists(t)},isProcessed:function(){var t=!0,a=i.fileManager;return e.each(a.stack,function(e){a.isPending(e)&&(t=!1)}),t},clear:function(){var e=i.fileManager;e.totalFiles=null,e.totalSize=null,e.uploadedSize=0,e.stack={},e.errors=[],e.processed=[],e.stats={},e.clearImages()},clearImages:function(){i.fileManager.loadedImages={},i.fileManager.totalImages=0},addImage:function(e,t){i.fileManager.loadedImages[e]=t},removeImage:function(e){delete i.fileManager.loadedImages[e]},getImageIdList:function(){return Object.keys(i.fileManager.loadedImages)},getImageCount:function(){return i.fileManager.getImageIdList().length},getId:function(e){return i._getFileId(e)},getIndex:function(e){return i.fileManager.getIdList().indexOf(e)},getThumb:function(t){var a=null;return i._getThumbs().each(function(){e(this).attr("data-fileid")===t&&(a=e(this))}),a},getThumbIndex:function(e){var t=e.attr("data-fileid");return i.fileManager.getIndex(t)},getIdList:function(){return Object.keys(i.fileManager.stack)},getFile:function(e){return i.fileManager.stack[e]||null},getFileName:function(e,t){var a=i.fileManager.getFile(e);return a?t?a.nameFmt||"":a.name||"":""},getFirstFile:function(){var e=i.fileManager.getIdList(),t=e&&e.length?e[0]:null;return i.fileManager.getFile(t)},setFile:function(e,t){i.fileManager.getFile(e)?i.fileManager.stack[e].file=t:i.fileManager.add(t,e)},setProcessed:function(e){i.fileManager.processed.push(e)},getProgress:function(){var e=i.fileManager.total(),t=i.fileManager.processed.length;return e?Math.ceil(t/e*100):0},setProgress:function(e,t){var a=i.fileManager.getFile(e);!isNaN(t)&&a&&(a.progress=t)}}},_setUploadData:function(i,a){var n=this;e.each(a,function(e,a){var r=n.uploadParamNames[e]||e;t.isArray(a)?i.append(r,a[0],a[1]):i.append(r,a)})},_initResumableUpload:function(){var i=this,a=i.resumableUploadOptions,n=t.logMessages;if(i.enableResumableUpload)if(!1!==a.fallback&&"function"!=typeof a.fallback&&(a.fallback=function(e){e._log(n.noResumableSupport),e.enableResumableUpload=!1}),t.hasResumableUploadSupport()||!1===a.fallback){if(!i.uploadUrl&&i.enableResumableUpload)return i._log(n.noUploadUrl),void(i.enableResumableUpload=!1);if(a.chunkSize=parseFloat(a.chunkSize),a.chunkSize<=0||isNaN(a.chunkSize))return i._log(n.invalidChunkSize,{chunkSize:a.chunkSize}),void(i.enableResumableUpload=!1);i.resumableManager={init:function(e,t,a){var n=i.resumableManager,r=i.fileManager;n.currThreads=0,n.logs=[],n.stack=[],n.error="",n.chunkIntervalId=null,n.id=e,n.file=t.file,n.fileName=t.name,n.fileIndex=a,n.completed=!1,n.testing=!1,n.lastProgress=0,i.showPreview&&(n.$thumb=r.getThumb(e)||null,n.$progress=n.$btnUpload=n.$btnDelete=null,n.$thumb&&n.$thumb.length&&(n.$progress=n.$thumb.find(".file-thumb-progress"),n.$btnUpload=n.$thumb.find(".kv-file-upload"),n.$btnDelete=n.$thumb.find(".kv-file-remove"))),n.chunkSize=1024*i.resumableUploadOptions.chunkSize,n.chunkCount=n.getTotalChunks()},logAjaxError:function(e,t,a){i.resumableUploadOptions.showErrorLog&&i._log(n.ajaxError,{status:e.status,error:a,text:e.responseText||""})},reset:function(){i.resumableManager.processed={}},setProcessed:function(e){var t,a=i.resumableManager,n=i.fileManager,r=a.id,o=a.$btnUpload,s=a.$thumb,l=a.$progress,d=s&&s.length,u={id:d?s.attr("id"):"",index:n.getIndex(r),fileId:r};a.completed=!0,a.lastProgress=0,n.uploadedSize+=a.file.size,d&&s.removeClass("file-uploading"),"success"===e?(i.showPreview&&(i._setProgress(101,l),i._setThumbStatus(s,"Success"),i._initUploadSuccess(a.processed[r].data,s),o.hide()),i.fileManager.removeFile(r),delete a.processed[r],i._raise("fileuploaded",[u.id,u.index,u.fileId]),n.isProcessed()&&i._setProgress(101)):(i.showPreview&&(i._setThumbStatus(s,"Error"),i._setPreviewError(s,!0),i.retryErrorUploads?o.removeAttr("disabled"):o.hide(),i._setProgress(101,l,i.msgProgressError),i._setProgress(101,i.$progress,i.msgProgressError),i.cancelling=!0),i.$errorContainer.find('li[data-file-id="'+u.fileId+'"]').length||(t=i.msgResumableUploadRetriesExceeded.setTokens({file:a.fileName,max:i.resumableUploadOptions.maxRetries,error:a.error}),i._showFileError(t,u))),n.isProcessed()&&a.reset()},check:function(){var t=i.resumableManager,a=!0;e.each(t.logs,function(e,t){if(!t)return a=!1,!1}),a&&(clearInterval(t.chunkIntervalId),t.setProcessed("success"))},processedResumables:function(){var e,t=i.resumableManager.logs,a=0;if(!t||!t.length)return 0;for(e=0;e<t.length;e++)!0===t[e]&&a++;return a},getUploadedSize:function(){var e=i.resumableManager,t=e.processedResumables()*e.chunkSize;return t>e.file.size?e.file.size:t},getTotalChunks:function(){var e=i.resumableManager,t=parseFloat(e.chunkSize);return!isNaN(t)&&t>0?Math.ceil(e.file.size/t):0},getProgress:function(){var e=i.resumableManager,t=e.processedResumables(),a=e.chunkCount;return 0===a?0:Math.ceil(t/a*100)},checkAborted:function(e){(i.paused||i.cancelling)&&(clearInterval(e),i.unlock())},uploadSingle:function(e){var t,a=i.resumableManager,n=i.fileManager,r="new";t=setInterval(function(){a.checkAborted(t),"new"===r&&(i.lock(),r="processing",n.stack[e]&&(a.init(e,n.stack[e]),a.uploadResumable())),(!n.isPending(e)&&a.completed||n.isProcessed())&&(clearInterval(t),i.unlock())},i.processDelay)},upload:function(){var e,a=i.resumableManager,n=i.fileManager,r=n.getIdList(),o="new";e=setInterval(function(){var s;if(a.checkAborted(e),"new"===o&&(i.lock(),o="processing",s=r.shift(),n.initStats(s),n.stack[s]&&(a.init(s,n.stack[s],n.getIndex(s)),a.testUpload(),a.uploadResumable())),!n.isPending(s)&&a.completed&&(o="new"),n.isProcessed()){var l=i.$preview.find(".file-preview-initial");l.length&&(t.addCss(l,t.SORT_CSS),i._initSortable()),clearInterval(e),i._clearFileInput(),i.unlock(),setTimeout(function(){var e=i.previewCache.data;e&&(i.initialPreview=e.content,i.initialPreviewConfig=e.config,i.initialPreviewThumbTags=e.tags),i._raise("filebatchuploadcomplete",[i.initialPreview,i.initialPreviewConfig,i.initialPreviewThumbTags,i._getExtraData()])},i.processDelay)}},i.processDelay)},uploadResumable:function(){var e,t=i.resumableManager,a=t.chunkCount;for(e=0;e<a;e++)t.logs[e]=!(!t.processed[t.id]||!t.processed[t.id][e]);for(e=0;e<a;e++)t.pushAjax(e,0);t.chunkIntervalId=setInterval(t.loopAjax,i.queueDelay)},testUpload:function(){var a,n,r,o,s,l,d,u=i.resumableManager,c=i.resumableUploadOptions,h=i.fileManager,p=u.id;c.testUrl?(u.testing=!0,a=new FormData,n=h.stack[p],i._setUploadData(a,{fileId:p,fileName:n.fileName,fileSize:n.size,fileRelativePath:n.relativePath,chunkSize:u.chunkSize,chunkCount:u.chunkCount}),r=function(e){d=i._getOutData(a,e),i._raise("filetestbeforesend",[p,h,u,d])},o=function(n,r,o){d=i._getOutData(a,o,n);var s=i.uploadParamNames.chunksUploaded||"chunksUploaded",l=[p,h,u,d];n[s]&&t.isArray(n[s])?(u.processed[p]||(u.processed[p]={}),e.each(n[s],function(e,t){u.logs[t]=!0,u.processed[p][t]=!0}),u.processed[p].data=n,i._raise("filetestsuccess",l)):i._raise("filetesterror",l),u.testing=!1},s=function(e,t,n){d=i._getOutData(a,e),i._raise("filetestajaxerror",[p,h,u,d]),u.logAjaxError(e,t,n),u.testing=!1},l=function(){i._raise("filetestcomplete",[p,h,u,i._getOutData(a)]),u.testing=!1},i._ajaxSubmit(r,o,l,s,a,p,u.fileIndex,c.testUrl)):u.testing=!1},pushAjax:function(e,t){i.resumableManager.stack.push([e,t])},sendAjax:function(e,a){var r,o=i.fileManager,s=i.resumableManager,l=i.resumableUploadOptions,d=s.chunkSize,u=s.id,c=s.file,h=s.$thumb,p=s.$btnUpload,f=s.$btnDelete;if(!s.processed[u]||!s.processed[u][e])if(s.currThreads++,a>l.maxRetries)s.setProcessed("error");else{var m,v,g,w,y,b,_=c[c.slice?"slice":c.mozSlice?"mozSlice":c.webkitSlice?"webkitSlice":"slice"](d*e,d*(e+1));m=new FormData,r=o.stack[u],i._setUploadData(m,{fileId:u,fileName:s.fileName,fileSize:c.size,fileRelativePath:r.relativePath,fileBlob:[_,s.fileName],chunkIndex:e,chunkSize:d,chunkSizeStart:d*e,chunkCount:s.chunkCount,retryCount:a}),s.$progress&&s.$progress.length&&s.$progress.show(),g=function(n){v=i._getOutData(m,n),i.showPreview&&(h.hasClass("file-preview-success")||(i._setThumbStatus(h,"Loading"),t.addCss(h,"file-uploading")),p.attr("disabled",!0),f.attr("disabled",!0)),i._raise("filechunkbeforesend",[u,e,a,o,s,v])},w=function(t,r,l){v=i._getOutData(m,l,t);var d=i.uploadParamNames.chunkIndex||"chunkIndex",c=i.resumableUploadOptions,h=[u,e,a,o,s,v];s.currThreads--,t.error?(c.showErrorLog&&i._log(n.retryStatus,{retry:a+1,filename:s.fileName,chunk:e}),s.pushAjax(e,a+1),s.error=t.error,i._raise("filechunkerror",h)):(s.logs[t[d]]=!0,s.processed[u]||(s.processed[u]={}),s.processed[u][t[d]]=!0,s.processed[u].data=t,s.check(),i._raise("filechunksuccess",h))},y=function(t,n,r){v=i._getOutData(m,t),s.currThreads--,s.error=r,s.logAjaxError(t,n,r),i._raise("filechunkajaxerror",[u,e,a,o,s,v]),s.pushAjax(e,a+1)},b=function(){i._raise("filechunkcomplete",[u,e,a,o,s,i._getOutData(m)])},i._ajaxSubmit(g,w,b,y,m,u,s.fileIndex)}},loopAjax:function(){var e=i.resumableManager;if(e.currThreads<i.resumableUploadOptions.maxThreads&&!e.testing){var t,a=e.stack.shift();void 0!==a&&(t=a[0],e.processed[e.id]&&e.processed[e.id][t]?e.processedResumables()>=e.getTotalChunks()&&(e.setProcessed("success"),clearInterval(e.chunkIntervalId)):e.sendAjax(t,a[1]))}}},i.resumableManager.reset()}else a.fallback(i)},_initTemplateDefaults:function(){var i,a,n,r,o,s,l,d,u,c=this;i=t.closeButton("fileinput-remove"),a='<div id="'+t.MODAL_ID+'" class="file-zoom-dialog modal fade" tabindex="-1" aria-labelledby="'+t.MODAL_ID+'Label"></div>',n='<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-fileid="{fileid}" data-template="{template}"',r='<video class="kv-preview-data file-preview-video" controls {style}>\n<source src="{data}" type="{type}">\n'+t.DEFAULT_PREVIEW+"\n</video>\n",o='\x3c!--suppress ALL --\x3e<audio class="kv-preview-data file-preview-audio" controls {style}>\n<source src="{data}" type="{type}">\n'+t.DEFAULT_PREVIEW+"\n</audio>\n",l='<embed class="kv-preview-data file-preview-pdf" src="{data}" type="application/pdf" {style}>\n',s='<object class="kv-preview-data file-preview-object file-object {typeCss}" data="{data}" type="{type}" {style}>\n<param name="movie" value="{caption}" />\n'+t.OBJECT_PARAMS+" "+t.DEFAULT_PREVIEW+"\n</object>\n",d='<div class="kv-preview-data file-preview-other-frame" {style}>\n'+t.DEFAULT_PREVIEW+"\n</div>\n",u={width:"100%",height:"100%","min-height":"480px"},c._isPdfRendered()&&(l=c.pdfRendererTemplate.replace("{renderer}",c._encodeURI(c.pdfRendererUrl))),c.defaults={layoutTemplates:{main1:'{preview}\n<div class="kv-upload-progress kv-hidden"></div><div class="clearfix"></div>\n<div class="input-group {class}">\n  {caption}\n<div class="input-group-btn input-group-append">\n      {remove}\n      {cancel}\n      {pause}\n      {upload}\n      {browse}\n    </div>\n</div>',main2:'{preview}\n<div class="kv-upload-progress kv-hidden"></div>\n<div class="clearfix"></div>\n{remove}\n{cancel}\n{upload}\n{browse}\n',preview:'<div class="file-preview {class}">\n    {close}    <div class="{dropClass}">\n    <div class="file-preview-thumbnails">\n    </div>\n    <div class="clearfix"></div>    <div class="file-preview-status text-center text-success"></div>\n    <div class="kv-fileinput-error"></div>\n    </div>\n</div>',close:i,fileIcon:'<i class="glyphicon glyphicon-file"></i>',caption:'<div class="file-caption form-control {class}" tabindex="500">\n  <span class="file-caption-icon"></span>\n  <input class="file-caption-name" onkeydown="return false;" onpaste="return false;">\n</div>',modalMain:a,modal:'<div class="modal-dialog modal-lg{rtl}" role="document">\n  <div class="modal-content">\n    <div class="modal-header">\n      <h5 class="modal-title">{heading}</h5>\n      <span class="kv-zoom-title"></span>\n      <div class="kv-zoom-actions">{toggleheader}{fullscreen}{borderless}{close}</div>\n    </div>\n    <div class="modal-body">\n      <div class="floating-buttons"></div>\n      <div class="kv-zoom-body file-zoom-content {zoomFrameClass}"></div>\n{prev} {next}\n    </div>\n  </div>\n</div>\n',progress:'<div class="progress">\n    <div class="{class}" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">\n        {status}\n     </div>\n</div>{stats}',stats:'<div class="text-info file-upload-stats"><span class="pending-time">{pendingTime}</span> <span class="upload-speed">{uploadSpeed}</span></div>',size:" <samp>({sizeText})</samp>",footer:'<div class="file-thumbnail-footer">\n    <div class="file-footer-caption" title="{caption}">\n        <div class="file-caption-info">{caption}</div>\n        <div class="file-size-info">{size}</div>\n    </div>\n    {progress}\n{indicator}\n{actions}\n</div>',indicator:'<div class="file-upload-indicator" title="{indicatorTitle}">{indicator}</div>',actions:'<div class="file-actions">\n    <div class="file-footer-buttons">\n        {download} {upload} {delete} {zoom} {other}    </div>\n</div>\n{drag}\n<div class="clearfix"></div>',actionDelete:'<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}" {dataUrl}{dataKey}>{removeIcon}</button>\n',actionUpload:'<button type="button" class="kv-file-upload {uploadClass}" title="{uploadTitle}">{uploadIcon}</button>',actionDownload:'<a class="kv-file-download {downloadClass}" title="{downloadTitle}" href="{downloadUrl}" download="{caption}" target="_blank">{downloadIcon}</a>',actionZoom:'<button type="button" class="kv-file-zoom {zoomClass}" title="{zoomTitle}">{zoomIcon}</button>',actionDrag:'<span class="file-drag-handle {dragClass}" title="{dragTitle}">{dragIcon}</span>',btnDefault:'<button type="{type}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</button>',btnLink:'<a href="{href}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</a>',btnBrowse:'<div tabindex="500" class="{css}" {status}>{icon} {label}</div>',zoomCache:'<div class="kv-zoom-cache" style="display:none">{zoomContent}</div>'},previewMarkupTags:{tagBefore1:'<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-fileid="{fileid}" data-template="{template}"><div class="kv-file-content">\n',tagBefore2:'<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-fileid="{fileid}" data-template="{template}" title="{caption}"><div class="kv-file-content">\n',tagAfter:"</div>{footer}\n</div>\n"},previewContentTemplates:{generic:"{content}\n",html:'<div class="kv-preview-data file-preview-html" title="{caption}" {style}>{data}</div>\n',image:'<img src="{data}" class="file-preview-image kv-preview-data" title="{title}" alt="{alt}" {style}>\n',text:'<textarea class="kv-preview-data file-preview-text" title="{caption}" readonly {style}>{data}</textarea>\n',office:'<iframe class="kv-preview-data file-preview-office" src="https://view.officeapps.live.com/op/embed.aspx?src={data}" {style}></iframe>',gdocs:'<iframe class="kv-preview-data file-preview-gdocs" src="https://docs.google.com/gview?url={data}&embedded=true" {style}></iframe>',video:r,audio:o,flash:'<embed class="kv-preview-data file-preview-flash" src="{data}" type="application/x-shockwave-flash" {style}>\n',object:s,pdf:l,other:d},allowedPreviewTypes:["image","html","text","video","audio","flash","pdf","object"],previewTemplates:{},previewSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:{width:"213px",height:"160px"},text:{width:"213px",height:"160px"},office:{width:"213px",height:"160px"},gdocs:{width:"213px",height:"160px"},video:{width:"213px",height:"160px"},audio:{width:"100%",height:"30px"},flash:{width:"213px",height:"160px"},object:{width:"213px",height:"160px"},pdf:{width:"100%",height:"160px"},other:{width:"213px",height:"160px"}},previewSettingsSmall:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:{width:"100%",height:"160px"},text:{width:"100%",height:"160px"},office:{width:"100%",height:"160px"},gdocs:{width:"100%",height:"160px"},video:{width:"100%",height:"auto"},audio:{width:"100%",height:"30px"},flash:{width:"100%",height:"auto"},object:{width:"100%",height:"auto"},pdf:{width:"100%",height:"160px"},other:{width:"100%",height:"160px"}},previewZoomSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:u,text:u,office:{width:"100%",height:"100%","max-width":"100%","min-height":"480px"},gdocs:{width:"100%",height:"100%","max-width":"100%","min-height":"480px"},video:{width:"auto",height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"480px"},object:{width:"auto",height:"100%","max-width":"100%","min-height":"480px"},pdf:u,other:{width:"auto",height:"100%","min-height":"480px"}},mimeTypeAliases:{"video/quicktime":"video/mp4"},fileTypeSettings:{image:function(e,i){return t.compare(e,"image.*")&&!t.compare(e,/(tiff?|wmf)$/i)||t.compare(i,/\.(gif|png|jpe?g)$/i)},html:function(e,i){return t.compare(e,"text/html")||t.compare(i,/\.(htm|html)$/i)},office:function(e,i){return t.compare(e,/(word|excel|powerpoint|office)$/i)||t.compare(i,/\.(docx?|xlsx?|pptx?|pps|potx?)$/i)},gdocs:function(e,i){return t.compare(e,/(word|excel|powerpoint|office|iwork-pages|tiff?)$/i)||t.compare(i,/\.(docx?|xlsx?|pptx?|pps|potx?|rtf|ods|odt|pages|ai|dxf|ttf|tiff?|wmf|e?ps)$/i)},text:function(e,i){return t.compare(e,"text.*")||t.compare(i,/\.(xml|javascript)$/i)||t.compare(i,/\.(txt|md|csv|nfo|ini|json|php|js|css)$/i)},video:function(e,i){return t.compare(e,"video.*")&&(t.compare(e,/(ogg|mp4|mp?g|mov|webm|3gp)$/i)||t.compare(i,/\.(og?|mp4|webm|mp?g|mov|3gp)$/i))},audio:function(e,i){return t.compare(e,"audio.*")&&(t.compare(i,/(ogg|mp3|mp?g|wav)$/i)||t.compare(i,/\.(og?|mp3|mp?g|wav)$/i))},flash:function(e,i){return t.compare(e,"application/x-shockwave-flash",!0)||t.compare(i,/\.(swf)$/i)},pdf:function(e,i){return t.compare(e,"application/pdf",!0)||t.compare(i,/\.(pdf)$/i)},object:function(){return!0},other:function(){return!0}},fileActionSettings:{showRemove:!0,showUpload:!0,showDownload:!0,showZoom:!0,showDrag:!0,removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",removeErrorClass:"btn btn-sm btn-kv btn-danger",removeTitle:"Remove file",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",uploadTitle:"Upload file",uploadRetryIcon:'<i class="glyphicon glyphicon-repeat"></i>',uploadRetryTitle:"Retry upload",downloadIcon:'<i class="glyphicon glyphicon-download"></i>',downloadClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",downloadTitle:"Download file",zoomIcon:'<i class="glyphicon glyphicon-zoom-in"></i>',zoomClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",zoomTitle:"View Details",dragIcon:'<i class="glyphicon glyphicon-move"></i>',dragClass:"text-info",dragTitle:"Move / Rearrange",dragSettings:{},indicatorNew:'<i class="glyphicon glyphicon-plus-sign text-warning"></i>',indicatorSuccess:'<i class="glyphicon glyphicon-ok-sign text-success"></i>',indicatorError:'<i class="glyphicon glyphicon-exclamation-sign text-danger"></i>',indicatorLoading:'<i class="glyphicon glyphicon-hourglass text-muted"></i>',indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading ..."}},e.each(c.defaults,function(t,i){"allowedPreviewTypes"!==t?c[t]=e.extend(!0,{},i,c[t]):void 0===c.allowedPreviewTypes&&(c.allowedPreviewTypes=i)}),c._initPreviewTemplates()},_initPreviewTemplates:function(){var i,a=this,n=a.previewMarkupTags,r=n.tagAfter;e.each(a.previewContentTemplates,function(e,o){t.isEmpty(a.previewTemplates[e])&&(i=n.tagBefore2,"generic"!==e&&"image"!==e&&"html"!==e&&"text"!==e||(i=n.tagBefore1),a._isPdfRendered()&&"pdf"===e&&(i=i.replace("kv-file-content","kv-file-content kv-pdf-rendered")),a.previewTemplates[e]=i+o+r)})},_initPreviewCache:function(){var i=this;i.previewCache={data:{},init:function(){var e=i.initialPreview;e.length>0&&!t.isArray(e)&&(e=e.split(i.initialPreviewDelimiter)),i.previewCache.data={content:e,config:i.initialPreviewConfig,tags:i.initialPreviewThumbTags}},count:function(e){return i.previewCache.data&&i.previewCache.data.content?e?i.previewCache.data.content.filter(function(e){return null!==e}).length:i.previewCache.data.content.length:0},get:function(a,n){var r,o,s,l,d,u,c,h,p="init_"+a,f=i.previewCache.data,m=f.config[a],v=f.content[a],g=i.previewInitId+"-"+p,w=t.ifSet("previewAsData",m,i.initialPreviewAsData),y=m?{title:m.title||null,alt:m.alt||null}:{title:null,alt:null},b=function(e,a,n,o,s,l,d,u,c){return u=" file-preview-initial "+t.SORT_CSS+(u?" "+u:""),r=m&&m.fileId||"file_"+s,i._generatePreviewTemplate(e,a,n,o,s,r,!1,null,u,l,d,c,y,m&&m.zoomData||a)};return v&&v.length?(n=void 0===n||n,l=t.ifSet("type",m,i.initialPreviewFileType||"generic"),u=t.ifSet("filename",m,t.ifSet("caption",m)),c=t.ifSet("filetype",m,l),d=i.previewCache.footer(a,n,m&&m.size||null),h=t.ifSet("frameClass",m),o=w?b(l,v,u,c,g,d,p,h):b("generic",v,u,c,g,d,p,h,l).setTokens({content:f.content[a]}),f.tags.length&&f.tags[a]&&(o=t.replaceTags(o,f.tags[a])),t.isEmpty(m)||t.isEmpty(m.frameAttr)||((s=e(document.createElement("div")).html(o)).find(".file-preview-initial").attr(m.frameAttr),o=s.html(),s.remove()),o):""},clean:function(e){e.content=t.cleanArray(e.content),e.config=t.cleanArray(e.config),e.tags=t.cleanArray(e.tags),i.previewCache.data=e},add:function(e,a,n,r){var o=i.previewCache.data,s=e.length-1;return e&&e.length?(t.isArray(e)||(e=e.split(i.initialPreviewDelimiter)),r?(s=o.content.push(e[0])-1,o.config[s]=a,o.tags[s]=n):(o.content=e,o.config=a,o.tags=n),i.previewCache.clean(o),s):s},set:function(e,a,n,r){var o,s=i.previewCache.data;if(e&&e.length&&(t.isArray(e)||(e=e.split(i.initialPreviewDelimiter)),e.filter(function(e){return null!==e}).length)){if(void 0===s.content&&(s.content=[]),void 0===s.config&&(s.config=[]),void 0===s.tags&&(s.tags=[]),r){for(o=0;o<e.length;o++)e[o]&&s.content.push(e[o]);for(o=0;o<a.length;o++)a[o]&&s.config.push(a[o]);for(o=0;o<n.length;o++)n[o]&&s.tags.push(n[o])}else s.content=e,s.config=a,s.tags=n;i.previewCache.clean(s)}},unset:function(a){var n=i.previewCache.count(),r=i.reversePreviewOrder;if(n){if(1===n)return i.previewCache.data.content=[],i.previewCache.data.config=[],i.previewCache.data.tags=[],i.initialPreview=[],i.initialPreviewConfig=[],void(i.initialPreviewThumbTags=[]);i.previewCache.data.content=t.spliceArray(i.previewCache.data.content,a,r),i.previewCache.data.config=t.spliceArray(i.previewCache.data.config,a,r),i.previewCache.data.tags=t.spliceArray(i.previewCache.data.tags,a,r);var o=e.extend(!0,{},i.previewCache.data);i.previewCache.clean(o)}},out:function(){var e,t,a="",n=i.previewCache.count();if(0===n)return{content:"",caption:""};for(e=0;e<n;e++)t=i.previewCache.get(e),a=i.reversePreviewOrder?t+a:a+t;return{content:a,caption:i._getMsgSelected(n)}},footer:function(e,a,n){var r=i.previewCache.data||{};if(t.isEmpty(r.content))return"";(t.isEmpty(r.config)||t.isEmpty(r.config[e]))&&(r.config[e]={}),a=void 0===a||a;var o,s=r.config[e],l=t.ifSet("caption",s),d=t.ifSet("width",s,"auto"),u=t.ifSet("url",s,!1),c=t.ifSet("key",s,null),h=t.ifSet("fileId",s,null),p=i.fileActionSettings,f=i.initialPreviewShowDelete||!1,m=i.initialPreviewDownloadUrl?i.initialPreviewDownloadUrl+"?key="+c+(h?"&fileId="+h:""):"",v=s.downloadUrl||m,g=s.filename||s.caption||"",w=!!v,y=t.ifSet("showRemove",s,t.ifSet("showRemove",p,f)),b=t.ifSet("showDownload",s,t.ifSet("showDownload",p,w)),_=t.ifSet("showZoom",s,t.ifSet("showZoom",p,!0)),k=t.ifSet("showDrag",s,t.ifSet("showDrag",p,!0)),x=!1===u&&a;return b=b&&!1!==s.downloadUrl&&!!v,o=i._renderFileActions(s,!1,b,y,_,k,x,u,c,!0,v,g),i._getLayoutTemplate("footer").setTokens({progress:i._renderThumbProgress(),actions:o,caption:l,size:i._getSize(n),width:d,indicator:""})}},i.previewCache.init()},_isPdfRendered:function(){var e=this.usePdfRenderer;return("function"==typeof e?e():!!e)&&this.pdfRendererUrl},_handler:function(e,t,i){var a=this.namespace,n=t.split(" ").join(a+" ")+a;e&&e.length&&e.off(n).on(n,i)},_encodeURI:function(e){return this.encodeUrl?encodeURI(e):e},_log:function(e,t){var i=this.$element.attr("id");i&&(e='"'+i+'": '+e),e="bootstrap-fileinput: "+e,"object"===_typeof(t)&&e.setTokens(t),void 0!==window.console.log?window.console.log(e):window.alert(e)},_validate:function(){var e="file"===this.$element.attr("type");return e||this._log(t.logMessages.badInputType),e},_errorsExist:function(){var t;return!!this.$errorContainer.find("li").length||((t=e(document.createElement("div")).html(this.$errorContainer.html())).find(".kv-error-close").remove(),t.find("ul").remove(),!!e.trim(t.text()).length)},_errorHandler:function(e,t){var i=this,a=e.target.error,n=function(e){i._showError(e.replace("{name}",t))};a.code===a.NOT_FOUND_ERR?n(i.msgFileNotFound):a.code===a.SECURITY_ERR?n(i.msgFileSecured):a.code===a.NOT_READABLE_ERR?n(i.msgFileNotReadable):a.code===a.ABORT_ERR?n(i.msgFilePreviewAborted):n(i.msgFilePreviewError)},_addError:function(e){var t=this,i=t.$errorContainer;e&&i.length&&(i.html(t.errorCloseButton+e),t._handler(i.find(".kv-error-close"),"click",function(){setTimeout(function(){t.showPreview&&!t.getFrames().length&&t.clear(),i.fadeOut("slow")},t.processDelay)}))},_setValidationError:function(e){e=(e?e+" ":"")+"has-error",this.$container.removeClass(e).addClass("has-error"),t.addCss(this.$captionContainer,"is-invalid")},_resetErrors:function(e){var t=this.$errorContainer;this.isError=!1,this.$container.removeClass("has-error"),this.$captionContainer.removeClass("is-invalid"),t.html(""),e?t.fadeOut("slow"):t.hide()},_showFolderError:function(e){var t,i=this.$errorContainer;e&&(this.isAjaxUpload||this._clearFileInput(),t=this.msgFoldersNotAllowed.replace("{n}",e),this._addError(t),this._setValidationError(),i.fadeIn(800),this._raise("filefoldererror",[e,t]))},_showFileError:function(e,t,i){var a=this.$errorContainer,n=i||"fileuploaderror",r=t&&t.fileId||"",o=t&&t.id?'<li data-thumb-id="'+t.id+'" data-file-id="'+r+'">'+e+"</li>":"<li>"+e+"</li>";return 0===a.find("ul").length?this._addError("<ul>"+o+"</ul>"):a.find("ul").append(o),a.fadeIn(800),this._raise(n,[t,e]),this._setValidationError("file-input-new"),!0},_showError:function(e,t,i){var a=this.$errorContainer,n=i||"fileerror";return(t=t||{}).reader=this.reader,this._addError(e),a.fadeIn(800),this._raise(n,[t,e]),this.isAjaxUpload||this._clearFileInput(),this._setValidationError("file-input-new"),this.$btnUpload.attr("disabled",!0),!0},_noFilesError:function(e){var t=this.minFileCount>1?this.filePlural:this.fileSingle,i=this.msgFilesTooLess.replace("{n}",this.minFileCount).replace("{files}",t),a=this.$errorContainer;this._addError(i),this.isError=!0,this._updateFileDetails(0),a.fadeIn(800),this._raise("fileerror",[e,i]),this._clearFileInput(),this._setValidationError()},_parseError:function(t,i,a,n){var r,o=e.trim(a+""),s=void 0!==i.responseJSON&&void 0!==i.responseJSON.error?i.responseJSON.error:i.responseText;return this.cancelling&&this.msgUploadAborted&&(o=this.msgUploadAborted),this.showAjaxErrorDetails&&s&&(r=(s=e.trim(s.replace(/\n\s*\n/g,"\n"))).length?"<pre>"+s+"</pre>":"",o+=o?r:s),o||(o=this.msgAjaxError.replace("{operation}",t)),this.cancelling=!1,n?"<b>"+n+": </b>"+o:o},_parseFileType:function(e,i){var a,n,r,o=this.allowedPreviewTypes||[];if("application/text-plain"===e)return"text";for(r=0;r<o.length;r++)if(n=o[r],a=(0,this.fileTypeSettings[n])(e,i)?n:"",!t.isEmpty(a))return a;return"other"},_getPreviewIcon:function(t){var i,a=this,n=null;return t&&t.indexOf(".")>-1&&(i=t.split(".").pop(),a.previewFileIconSettings&&(n=a.previewFileIconSettings[i]||a.previewFileIconSettings[i.toLowerCase()]||null),a.previewFileExtSettings&&e.each(a.previewFileExtSettings,function(e,t){a.previewFileIconSettings[e]&&t(i)&&(n=a.previewFileIconSettings[e])})),n},_parseFilePreviewIcon:function(e,t){var i=this._getPreviewIcon(t)||this.previewFileIcon,a=e;return a.indexOf("{previewFileIcon}")>-1&&(a=a.setTokens({previewFileIconClass:this.previewFileIconClass,previewFileIcon:i})),a},_raise:function(t,i){var a=e.Event(t);if(void 0!==i?this.$element.trigger(a,i):this.$element.trigger(a),a.isDefaultPrevented()||!1===a.result)return!1;switch(t){case"filebatchuploadcomplete":case"filebatchuploadsuccess":case"fileuploaded":case"fileclear":case"filecleared":case"filereset":case"fileerror":case"filefoldererror":case"fileuploaderror":case"filebatchuploaderror":case"filedeleteerror":case"filecustomerror":case"filesuccessremove":break;default:this.ajaxAborted||(this.ajaxAborted=a.result)}return!0},_listenFullScreen:function(e){var t,i,a=this.$modal;a&&a.length&&(t=a&&a.find(".btn-fullscreen"),i=a&&a.find(".btn-borderless"),t.length&&i.length&&(t.removeClass("active").attr("aria-pressed","false"),i.removeClass("active").attr("aria-pressed","false"),e?t.addClass("active").attr("aria-pressed","true"):i.addClass("active").attr("aria-pressed","true"),a.hasClass("file-zoom-fullscreen")?this._maximizeZoomDialog():e?this._maximizeZoomDialog():i.removeClass("active").attr("aria-pressed","false")))},_listen:function(){var i=this,a=i.$element,n=i.$form,r=i.$container;i._handler(a,"click",function(e){a.hasClass("file-no-browse")&&(a.data("zoneClicked")?a.data("zoneClicked",!1):e.preventDefault())}),i._handler(a,"change",e.proxy(i._change,i)),i.showBrowse&&i._handler(i.$btnFile,"click",e.proxy(i._browse,i)),i._handler(r.find(".fileinput-remove:not([disabled])"),"click",e.proxy(i.clear,i)),i._handler(r.find(".fileinput-cancel"),"click",e.proxy(i.cancel,i)),i._handler(r.find(".fileinput-pause"),"click",e.proxy(i.pause,i)),i._initDragDrop(),i._handler(n,"reset",e.proxy(i.clear,i)),i.isAjaxUpload||i._handler(n,"submit",e.proxy(i._submitForm,i)),i._handler(i.$container.find(".fileinput-upload"),"click",e.proxy(i._uploadClick,i)),i._handler(e(window),"resize",function(){i._listenFullScreen(screen.width===window.innerWidth&&screen.height===window.innerHeight)}),i._handler(e(document),"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){i._listenFullScreen(t.checkFullScreen())}),i._autoFitContent(),i._initClickable(),i._refreshPreview()},_autoFitContent:function(){var t,i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=this,n=i<400?a.previewSettingsSmall||a.defaults.previewSettingsSmall:a.previewSettings||a.defaults.previewSettings;e.each(n,function(e,i){t=".file-preview-frame .file-preview-"+e,a.$preview.find(t+".kv-preview-data,"+t+" .kv-preview-data").css(i)})},_scanDroppedItems:function(e,i,a){a=a||"";var n,r,o,s=this,l=function(e){s._log(t.logMessages.badDroppedFiles),s._log(e)};e.isFile?e.file(function(e){i.push(e)},l):e.isDirectory&&(r=e.createReader(),(o=function(){r.readEntries(function(t){if(t&&t.length>0){for(n=0;n<t.length;n++)s._scanDroppedItems(t[n],i,a+e.name+"/");o()}return null},l)})())},_initDragDrop:function(){var t=this.$dropZone;this.dropZoneEnabled&&this.showPreview&&(this._handler(t,"dragenter dragover",e.proxy(this._zoneDragEnter,this)),this._handler(t,"dragleave",e.proxy(this._zoneDragLeave,this)),this._handler(t,"drop",e.proxy(this._zoneDrop,this)),this._handler(e(document),"dragenter dragover drop",this._zoneDragDropInit))},_zoneDragDropInit:function(e){e.stopPropagation(),e.preventDefault()},_zoneDragEnter:function(i){var a=i.originalEvent.dataTransfer,n=e.inArray("Files",a.types)>-1;if(this._zoneDragDropInit(i),this.isDisabled||!n)return i.originalEvent.dataTransfer.effectAllowed="none",void(i.originalEvent.dataTransfer.dropEffect="none");this._raise("fileDragEnter",{sourceEvent:i,files:a.types.Files})&&t.addCss(this.$dropZone,"file-highlighted")},_zoneDragLeave:function(e){this._zoneDragDropInit(e),this.isDisabled||this._raise("fileDragLeave",{sourceEvent:e})&&this.$dropZone.removeClass("file-highlighted")},_zoneDrop:function(e){var i,a=this,n=a.$element,r=e.originalEvent.dataTransfer,o=r.files,s=r.items,l=t.getDragDropFolders(s),d=function(){a.isAjaxUpload?a._change(e,o):(a.changeTriggered=!0,n.get(0).files=o,setTimeout(function(){a.changeTriggered=!1,n.trigger("change"+a.namespace)},a.processDelay)),a.$dropZone.removeClass("file-highlighted")};if(e.preventDefault(),!a.isDisabled&&!t.isEmpty(o)&&a._raise("fileDragDrop",{sourceEvent:e,files:o}))if(l>0){if(!a.isAjaxUpload)return void a._showFolderError(l);for(o=[],i=0;i<s.length;i++){var u=s[i].webkitGetAsEntry();u&&a._scanDroppedItems(u,o)}setTimeout(function(){d()},500)}else d()},_uploadClick:function(e){var i,a=this.$container.find(".fileinput-upload"),n=!a.hasClass("disabled")&&t.isEmpty(a.attr("disabled"));e&&e.isDefaultPrevented()||(this.isAjaxUpload?(e.preventDefault(),n&&this.upload()):n&&"submit"!==a.attr("type")&&((i=a.closest("form")).length&&i.trigger("submit"),e.preventDefault()))},_submitForm:function(){return this._isFileSelectionValid()&&!this._abort({})},_clearPreview:function(){var i=this.$preview;(this.showUploadedThumbs?this.getFrames(":not(.file-preview-success)"):this.getFrames()).each(function(){var a=e(this);a.remove(),t.cleanZoomCache(i.find("#zoom-"+a.attr("id")))}),this.getFrames().length&&this.showPreview||this._resetUpload(),this._validateDefaultPreview()},_initSortable:function(){var i,a=this,n=a.$preview,r="."+t.SORT_CSS,o=a.reversePreviewOrder;window.KvSortable&&0!==n.find(r).length&&(i={handle:".drag-handle-init",dataIdAttr:"data-preview-id",scroll:!1,draggable:r,onSort:function(i){var n=i.oldIndex,r=i.newIndex,s=0;a.initialPreview=t.moveArray(a.initialPreview,n,r,o),a.initialPreviewConfig=t.moveArray(a.initialPreviewConfig,n,r,o),a.previewCache.init(),a.getFrames(".file-preview-initial").each(function(){e(this).attr("data-fileindex","init_"+s),s++}),a._raise("filesorted",{previewId:e(i.item).attr("id"),oldIndex:n,newIndex:r,stack:a.initialPreviewConfig})}},n.data("kvsortable")&&n.kvsortable("destroy"),e.extend(!0,i,a.fileActionSettings.dragSettings),n.kvsortable(i))},_setPreviewContent:function(e){this.$preview.html(e),this._autoFitContent()},_initPreviewImageOrientations:function(){var i=this,a=0;i.autoOrientImageInitial&&i.getFrames(".file-preview-initial").each(function(){var n,r,o,s=e(this),l=i.initialPreviewConfig[a];l&&l.exif&&l.exif.Orientation&&(o=s.attr("id"),n=s.find(">.kv-file-content img"),r=i.$preview.find("#zoom-"+o+" >.kv-file-content img"),n&&n.length&&t.setImageOrientation(n,r,l.exif.Orientation)),a++})},_initPreview:function(e){var i,a=this.initialCaption||"";if(!this.previewCache.count(!0))return this._clearPreview(),void(e?this._setCaption(a):this._initCaption());i=this.previewCache.out(),a=e&&this.initialCaption?this.initialCaption:i.caption,this._setPreviewContent(i.content),this._setInitThumbAttr(),this._setCaption(a),this._initSortable(),t.isEmpty(i.content)||this.$container.removeClass("file-input-new"),this._initPreviewImageOrientations()},_getZoomButton:function(e){var t=this.previewZoomButtonIcons[e],i=this.previewZoomButtonClasses[e],a=' title="'+(this.previewZoomButtonTitles[e]||"")+'" '+("close"===e?' data-dismiss="modal" aria-hidden="true"':"");return"fullscreen"!==e&&"borderless"!==e&&"toggleheader"!==e||(a+=' data-toggle="button" aria-pressed="false" autocomplete="off"'),'<button type="button" class="'+i+" btn-"+e+'"'+a+">"+t+"</button>"},_getModalContent:function(){return this._getLayoutTemplate("modal").setTokens({rtl:this.rtl?" kv-rtl":"",zoomFrameClass:this.frameClass,heading:this.msgZoomModalHeading,prev:this._getZoomButton("prev"),next:this._getZoomButton("next"),toggleheader:this._getZoomButton("toggleheader"),fullscreen:this._getZoomButton("fullscreen"),borderless:this._getZoomButton("borderless"),close:this._getZoomButton("close")})},_listenModalEvent:function(e){var i=this,a=i.$modal;a.on(e+".bs.modal",function(n){var r=a.find(".btn-fullscreen"),o=a.find(".btn-borderless");i._raise("filezoom"+e,function(e){return{sourceEvent:e,previewId:a.data("previewId"),modal:a}}(n)),"shown"===e&&(o.removeClass("active").attr("aria-pressed","false"),r.removeClass("active").attr("aria-pressed","false"),a.hasClass("file-zoom-fullscreen")&&(i._maximizeZoomDialog(),t.checkFullScreen()?r.addClass("active").attr("aria-pressed","true"):o.addClass("active").attr("aria-pressed","true")))})},_initZoom:function(){var i,a=this,n=a._getLayoutTemplate("modalMain"),r="#"+t.MODAL_ID;a.showPreview&&(a.$modal=e(r),a.$modal&&a.$modal.length||(i=e(document.createElement("div")).html(n).insertAfter(a.$container),a.$modal=e(r).insertBefore(i),i.remove()),t.initModal(a.$modal),a.$modal.html(a._getModalContent()),e.each(t.MODAL_EVENTS,function(e,t){a._listenModalEvent(t)}))},_initZoomButtons:function(){var t,i,a=this.$modal.data("previewId")||"",n=this.getFrames().toArray(),r=n.length,o=this.$modal.find(".btn-prev"),s=this.$modal.find(".btn-next");if(n.length<2)return o.hide(),void s.hide();o.show(),s.show(),r&&(t=e(n[0]),i=e(n[r-1]),o.removeAttr("disabled"),s.removeAttr("disabled"),t.length&&t.attr("id")===a&&o.attr("disabled",!0),i.length&&i.attr("id")===a&&s.attr("disabled",!0))},_maximizeZoomDialog:function(){var t=this.$modal,i=t.find(".modal-header:visible"),a=t.find(".modal-footer:visible"),n=t.find(".modal-body"),r=e(window).height();t.addClass("file-zoom-fullscreen"),i&&i.length&&(r-=i.outerHeight(!0)),a&&a.length&&(r-=a.outerHeight(!0)),n&&n.length&&(r-=n.outerHeight(!0)-n.height()),t.find(".kv-zoom-body").height(r)},_resizeZoomDialog:function(e){var i=this.$modal,a=i.find(".btn-fullscreen"),n=i.find(".btn-borderless");if(i.hasClass("file-zoom-fullscreen"))t.toggleFullScreen(!1),e?a.hasClass("active")||(i.removeClass("file-zoom-fullscreen"),this._resizeZoomDialog(!0),n.hasClass("active")&&n.removeClass("active").attr("aria-pressed","false")):a.hasClass("active")?a.removeClass("active").attr("aria-pressed","false"):(i.removeClass("file-zoom-fullscreen"),this.$modal.find(".kv-zoom-body").css("height",this.zoomModalHeight));else{if(!e)return void this._maximizeZoomDialog();t.toggleFullScreen(!0)}i.focus()},_setZoomContent:function(i,a){var n,r,o,s,l,d,u,c,h=this,p=i.attr("id"),f=h.$preview.find("#zoom-"+p),m=h.$modal,v=m.find(".btn-fullscreen"),g=m.find(".btn-borderless"),w=m.find(".btn-toggleheader");r=f.attr("data-template")||"generic",o=(n=f.find(".kv-file-content")).length?n.html():"",s=(i.data("caption")||"")+" "+(i.data("size")||""),m.find(".kv-zoom-title").attr("title",e("<div/>").html(s).text()).html(s),l=m.find(".kv-zoom-body"),m.removeClass("kv-single-content"),a?(c=l.addClass("file-thumb-loading").clone().insertAfter(l),l.html(o).hide(),c.fadeOut("fast",function(){l.fadeIn("fast",function(){l.removeClass("file-thumb-loading")}),c.remove()})):l.html(o),(u=h.previewZoomSettings[r])&&(d=l.find(".kv-preview-data"),t.addCss(d,"file-zoom-detail"),e.each(u,function(e,t){d.css(e,t),(d.attr("width")&&"width"===e||d.attr("height")&&"height"===e)&&d.removeAttr(e)})),m.data("previewId",p),h._handler(m.find(".btn-prev"),"click",function(){h._zoomSlideShow("prev",p)}),h._handler(m.find(".btn-next"),"click",function(){h._zoomSlideShow("next",p)}),h._handler(v,"click",function(){h._resizeZoomDialog(!0)}),h._handler(g,"click",function(){h._resizeZoomDialog(!1)}),h._handler(w,"click",function(){var e,t=m.find(".modal-header"),i=m.find(".modal-body .floating-buttons"),a=t.find(".kv-zoom-actions"),n=function(e){var i=h.$modal.find(".kv-zoom-body"),a=h.zoomModalHeight;m.hasClass("file-zoom-fullscreen")&&(a=i.outerHeight(!0),e||(a-=t.outerHeight(!0))),i.css("height",e?a+e:a)};t.is(":visible")?(e=t.outerHeight(!0),t.slideUp("slow",function(){a.find(".btn").appendTo(i),n(e)})):(i.find(".btn").appendTo(a),t.slideDown("slow",function(){n()})),m.focus()}),h._handler(m,"keydown",function(t){var i=t.which||t.keyCode,a=e(this).find(".btn-prev"),n=e(this).find(".btn-next"),r=e(this).data("previewId"),o=h.rtl?39:37,s=h.rtl?37:39;i===o&&a.length&&!a.attr("disabled")&&h._zoomSlideShow("prev",r),i===s&&n.length&&!n.attr("disabled")&&h._zoomSlideShow("next",r)})},_zoomPreview:function(e){var i,a=this.$modal;if(!e.length)throw"Cannot zoom to detailed preview!";t.initModal(a),a.html(this._getModalContent()),i=e.closest(t.FRAMES),this._setZoomContent(i),a.modal("show"),this._initZoomButtons()},_zoomSlideShow:function(t,i){var a,n,r,o=this.$modal.find(".kv-zoom-actions .btn-"+t),s=this.getFrames().toArray(),l=s.length;if(!o.attr("disabled")){for(n=0;n<l;n++)if(e(s[n]).attr("id")===i){r="prev"===t?n-1:n+1;break}r<0||r>=l||!s[r]||((a=e(s[r])).length&&this._setZoomContent(a,!0),this._initZoomButtons(),this._raise("filezoom"+t,{previewId:i,modal:this.$modal}))}},_initZoomButton:function(){var t=this;t.$preview.find(".kv-file-zoom").each(function(){var i=e(this);t._handler(i,"click",function(){t._zoomPreview(i)})})},_inputFileCount:function(){return this.$element.get(0).files.length},_refreshPreview:function(){var t;(this._inputFileCount()||this.isAjaxUpload)&&this.showPreview&&this.isPreviewable&&(this.isAjaxUpload&&this.fileManager.count()>0?(t=e.extend(!0,{},this.fileManager.stack),this.fileManager.clear(),this._clearFileInput()):t=this.$element.get(0).files,t&&t.length&&(this.readFiles(t),this._setFileDropZoneTitle()))},_clearObjects:function(t){t.find("video audio").each(function(){this.pause(),e(this).remove()}),t.find("img object div").each(function(){e(this).remove()})},_clearFileInput:function(){var t,i,a,n=this.$element;this._inputFileCount()&&(t=n.closest("form"),i=e(document.createElement("form")),a=e(document.createElement("div")),n.before(a),t.length?t.after(i):a.after(i),i.append(n).trigger("reset"),a.before(n).remove(),i.remove())},_resetUpload:function(){this.uploadCache={content:[],config:[],tags:[],append:!0},this.$btnUpload.removeAttr("disabled"),this._setProgress(0),this.$progress.hide(),this._resetErrors(!1),this._initAjax(),this.fileManager.clearImages(),this._resetCanvas(),this.cacheInitialPreview={},this.overwriteInitial&&(this.initialPreview=[],this.initialPreviewConfig=[],this.initialPreviewThumbTags=[],this.previewCache.data={content:[],config:[],tags:[]})},_resetCanvas:function(){this.canvas&&this.imageCanvasContext&&this.imageCanvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},_hasInitialPreview:function(){return!this.overwriteInitial&&this.previewCache.count(!0)},_resetPreview:function(){var e,t;this.previewCache.count(!0)?(e=this.previewCache.out(),this._setPreviewContent(e.content),this._setInitThumbAttr(),t=this.initialCaption?this.initialCaption:e.caption,this._setCaption(t)):(this._clearPreview(),this._initCaption()),this.showPreview&&(this._initZoom(),this._initSortable())},_clearDefaultPreview:function(){this.$preview.find(".file-default-preview").remove()},_validateDefaultPreview:function(){this.showPreview&&!t.isEmpty(this.defaultPreviewContent)&&(this._setPreviewContent('<div class="file-default-preview">'+this.defaultPreviewContent+"</div>"),this.$container.removeClass("file-input-new"),this._initClickable())},_resetPreviewThumbs:function(e){var t;if(e)return this._clearPreview(),void this.clearFileStack();this._hasInitialPreview()?(t=this.previewCache.out(),this._setPreviewContent(t.content),this._setInitThumbAttr(),this._setCaption(t.caption),this._initPreviewActions()):this._clearPreview()},_getLayoutTemplate:function(e){var i=this.layoutTemplates[e];return t.isEmpty(this.customLayoutTags)?i:t.replaceTags(i,this.customLayoutTags)},_getPreviewTemplate:function(e){var i=this.previewTemplates[e];return t.isEmpty(this.customPreviewTags)?i:t.replaceTags(i,this.customPreviewTags)},_getOutData:function(e,t,i,a){return t=t||{},i=i||{},{formdata:e,files:a=a||this.fileManager.list(),filenames:this.filenames,filescount:this.getFilesCount(),extra:this._getExtraData(),response:i,reader:this.reader,jqXHR:t}},_getMsgSelected:function(e){var t=1===e?this.fileSingle:this.filePlural;return e>0?this.msgSelected.replace("{n}",e).replace("{files}",t):this.msgNoFilesSelected},_getFrame:function(i){var a=e("#"+i);return a.length?a:(this._log(t.logMessages.invalidThumb,{id:i}),null)},_getThumbs:function(e){return e=e||"",this.getFrames(":not(.file-preview-initial)"+e)},_getExtraData:function(e,t){var i=this.uploadExtraData;return"function"==typeof this.uploadExtraData&&(i=this.uploadExtraData(e,t)),i},_initXhr:function(e,i,a){var n=this,r=n.fileManager,o=function(e){var o=0,s=e.total,l=e.loaded||e.position,d=r.getUploadStats(i,l,s);e.lengthComputable&&!n.enableResumableUpload&&(o=t.round(l/s*100)),i?n._setFileUploadStats(i,o,a,d):n._setProgress(o,null,null,n._getStats(d)),n._raise("fileajaxprogress",[d])};return e.upload&&(n.progressDelay&&(o=t.debounce(o,n.progressDelay)),e.upload.addEventListener("progress",o,!1)),e},_initAjaxSettings:function(){this._ajaxSettings=e.extend(!0,{},this.ajaxSettings),this._ajaxDeleteSettings=e.extend(!0,{},this.ajaxDeleteSettings)},_mergeAjaxCallback:function(e,t,i){var a,n=this._ajaxSettings,r=this.mergeAjaxCallbacks;"delete"===i&&(n=this._ajaxDeleteSettings,r=this.mergeAjaxDeleteCallbacks),a=n[e],n[e]=r&&"function"==typeof a?"before"===r?function(){a.apply(this,arguments),t.apply(this,arguments)}:function(){t.apply(this,arguments),a.apply(this,arguments)}:t},_ajaxSubmit:function(t,i,a,n,r,o,s,l){var d,u,c,h,p=this;p._raise("filepreajax",[r,o,s])&&(r.append("initialPreview",JSON.stringify(p.initialPreview)),r.append("initialPreviewConfig",JSON.stringify(p.initialPreviewConfig)),r.append("initialPreviewThumbTags",JSON.stringify(p.initialPreviewThumbTags)),p._initAjaxSettings(),p._mergeAjaxCallback("beforeSend",t),p._mergeAjaxCallback("success",i),p._mergeAjaxCallback("complete",a),p._mergeAjaxCallback("error",n),"function"==typeof(l=l||p.uploadUrlThumb||p.uploadUrl)&&(l=l()),"object"===_typeof(c=p._getExtraData(o,s)||{})&&e.each(c,function(e,t){r.append(e,t)}),u={xhr:function(){var t=e.ajaxSettings.xhr();return p._initXhr(t,o,p.fileManager.count())},url:p._encodeURI(l),type:"POST",dataType:"json",data:r,cache:!1,processData:!1,contentType:!1},d=e.extend(!0,{},u,p._ajaxSettings),p.ajaxQueue.push(d),h=function(){var t,i;p.ajaxCurrentThreads<p.maxAjaxThreads&&void 0!==(t=p.ajaxQueue.shift())&&(p.ajaxCurrentThreads++,i=e.ajax(t).done(function(){clearInterval(p.ajaxQueueIntervalId),p.ajaxCurrentThreads--}),p.ajaxRequests.push(i))},p.ajaxQueueIntervalId=setInterval(h,p.queueDelay))},_mergeArray:function(e,i){var a=t.cleanArray(this[e]),n=t.cleanArray(i);this[e]=a.concat(n)},_initUploadSuccess:function(i,a,n){var r,o,s,l,d,u,c,h,p,f=this;f.showPreview&&"object"===_typeof(i)&&!e.isEmptyObject(i)&&void 0!==i.initialPreview&&i.initialPreview.length>0&&(f.hasInitData=!0,u=i.initialPreview||[],c=i.initialPreviewConfig||[],h=i.initialPreviewThumbTags||[],r=void 0===i.append||i.append,u.length>0&&!t.isArray(u)&&(u=u.split(f.initialPreviewDelimiter)),u.length&&(f._mergeArray("initialPreview",u),f._mergeArray("initialPreviewConfig",c),f._mergeArray("initialPreviewThumbTags",h)),void 0!==a?n?(p=a.attr("data-fileindex"),f.uploadCache.content[p]=u[0],f.uploadCache.config[p]=c[0]||[],f.uploadCache.tags[p]=h[0]||[],f.uploadCache.append=r):(s=f.previewCache.add(u[0],c[0],h[0],r),o=f.previewCache.get(s,!1),(d=(l=e(document.createElement("div")).html(o).hide().insertAfter(a)).find(".kv-zoom-cache"))&&d.length&&d.insertAfter(a),a.fadeOut("slow",function(){var e=l.find(".file-preview-frame");e&&e.length&&e.insertBefore(a).fadeIn("slow").css("display:inline-block"),f._initPreviewActions(),f._clearFileInput(),t.cleanZoomCache(f.$preview.find("#zoom-"+a.attr("id"))),a.remove(),l.remove(),f._initSortable()})):(f.previewCache.set(u,c,h,r),f._initPreview(),f._initPreviewActions()))},_initSuccessThumbs:function(){var i=this;i.showPreview&&i._getThumbs(t.FRAMES+".file-preview-success").each(function(){var a=e(this),n=i.$preview,r=a.find(".kv-file-remove");r.removeAttr("disabled"),i._handler(r,"click",function(){var e=a.attr("id"),r=i._raise("filesuccessremove",[e,a.attr("data-fileindex")]);t.cleanMemory(a),!1!==r&&a.fadeOut("slow",function(){t.cleanZoomCache(n.find("#zoom-"+e)),a.remove(),i.getFrames().length||i.reset()})})})},_updateInitialPreview:function(){var e,i,a=this.uploadCache,n=0,r=this.cacheInitialPreview;if(r&&r.content&&(n=r.content.length),this.showPreview){if(this.previewCache.set(a.content,a.config,a.tags,a.append),n){for(e=0;e<a.content.length;e++)i=e+n,r.content[i]=a.content[e],r.config.length&&(r.config[i]=a.config[e]),r.tags.length&&(r.tags[i]=a.tags[e]);this.initialPreview=t.cleanArray(r.content),this.initialPreviewConfig=t.cleanArray(r.config),this.initialPreviewThumbTags=t.cleanArray(r.tags)}else this.initialPreview=a.content,this.initialPreviewConfig=a.config,this.initialPreviewThumbTags=a.tags;this.cacheInitialPreview={},this.hasInitData&&(this._initPreview(),this._initPreviewActions())}},_uploadSingle:function(i,a,n){var r,o,s,l,d,u,c,h,p,f,m,v,g,w=this,y=w.fileManager,b=y.count(),_=new FormData,k=w.previewInitId+"-"+i,x=b>0||!e.isEmptyObject(w.uploadExtraData),C=w.ajaxOperations.uploadThumb,T=y.getFile(a),P=w.resumableManager,D={id:k,index:i,fileId:a},M=w.fileManager.getFileName(a,!0);if(w.enableResumableUpload)return w.paused=!1,w.cancelling=!1,y.initStats(a),void P.uploadSingle(a);w.showPreview&&(o=w.fileManager.getThumb(a),c=o.find(".file-thumb-progress"),l=o.find(".kv-file-upload"),d=o.find(".kv-file-remove"),c.show()),0===b||!x||w.showPreview&&l&&l.hasClass("disabled")||w._abort(D)||(v=function(){u?y.errors.push(a):y.removeFile(a),y.setProcessed(a),y.isProcessed()&&(w.fileBatchCompleted=!0)},s=function(){var e;w.fileBatchCompleted&&setTimeout(function(){var i=0===y.count(),a=y.errors.length;w._updateInitialPreview(),w.unlock(i),i&&w._clearFileInput(),e=w.$preview.find(".file-preview-initial"),w.uploadAsync&&e.length&&(t.addCss(e,t.SORT_CSS),w._initSortable()),w._raise("filebatchuploadcomplete",[y.stack,w._getExtraData()]),w.retryErrorUploads&&0!==a||y.clear(),w._setProgress(101),w.ajaxAborted=!1},w.processDelay)},h=function(s){r=w._getOutData(_,s),y.initStats(a),w.fileBatchCompleted=!1,n||(w.ajaxAborted=!1),w.showPreview&&(o.hasClass("file-preview-success")||(w._setThumbStatus(o,"Loading"),t.addCss(o,"file-uploading")),l.attr("disabled",!0),d.attr("disabled",!0)),n||w.lock(),-1!==y.errors.indexOf(a)&&delete y.errors[a],w._raise("filepreupload",[r,k,i]),e.extend(!0,D,r),w._abort(D)&&(s.abort(),n||(w._setThumbStatus(o,"New"),o.removeClass("file-uploading"),l.removeAttr("disabled"),d.removeAttr("disabled"),w.unlock()),w._setProgressCancelled())},p=function(s,d,h){var p=w.showPreview&&o.attr("id")?o.attr("id"):k;r=w._getOutData(_,h,s),e.extend(!0,D,r),setTimeout(function(){t.isEmpty(s)||t.isEmpty(s.error)?(w.showPreview&&(w._setThumbStatus(o,"Success"),l.hide(),w._initUploadSuccess(s,o,n),w._setProgress(101,c)),w._raise("fileuploaded",[r,p,i]),n?v():w.fileManager.remove(o)):(u=!0,g=w._parseError(C,h,w.msgUploadError,w.fileManager.getFileName(a)),w._showFileError(g,D),w._setPreviewError(o,!0),w.retryErrorUploads||l.hide(),n&&v(),w._setProgress(101,e("#"+p).find(".file-thumb-progress"),w.msgUploadError))},w.processDelay)},f=function(){setTimeout(function(){w.showPreview&&(l.removeAttr("disabled"),d.removeAttr("disabled"),o.removeClass("file-uploading")),n?s():(w.unlock(!1),w._clearFileInput()),w._initSuccessThumbs()},w.processDelay)},m=function(t,i,r){g=w._parseError(C,t,r,w.fileManager.getFileName(a)),u=!0,setTimeout(function(){n&&v(),w.fileManager.setProgress(a,100),w._setPreviewError(o,!0),w.retryErrorUploads||l.hide(),e.extend(!0,D,w._getOutData(_,t)),w._setProgress(101,c,w.msgAjaxProgressError.replace("{operation}",C)),w._setProgress(101,o.find(".file-thumb-progress"),w.msgUploadError),w._showFileError(g,D)},w.processDelay)},_.append(w.uploadFileAttr,T.file,M),w._setUploadData(_,{fileId:a}),w._ajaxSubmit(h,p,f,m,_,a,i))},_uploadBatch:function(){var i,a,n,r,o,s,l=this,d=l.fileManager,u=d.total(),c=u>0||!e.isEmptyObject(l.uploadExtraData),h=new FormData,p=l.ajaxOperations.uploadBatch;if(0!==u&&c&&!l._abort({})){s=function(){l.fileManager.clear(),l._clearFileInput()},i=function(i){l.lock(),d.initStats();var a=l._getOutData(h,i);l.ajaxAborted=!1,l.showPreview&&l._getThumbs().each(function(){var i=e(this),a=i.find(".kv-file-upload"),n=i.find(".kv-file-remove");i.hasClass("file-preview-success")||(l._setThumbStatus(i,"Loading"),t.addCss(i,"file-uploading")),a.attr("disabled",!0),n.attr("disabled",!0)}),l._raise("filebatchpreupload",[a]),l._abort(a)&&(i.abort(),l._getThumbs().each(function(){var t=e(this),i=t.find(".kv-file-upload"),a=t.find(".kv-file-remove");t.hasClass("file-preview-loading")&&(l._setThumbStatus(t,"New"),t.removeClass("file-uploading")),i.removeAttr("disabled"),a.removeAttr("disabled")}),l._setProgressCancelled())},a=function(i,a,n){var r=l._getOutData(h,n,i),d=0,u=l._getThumbs(":not(.file-preview-success)"),c=t.isEmpty(i)||t.isEmpty(i.errorkeys)?[]:i.errorkeys;t.isEmpty(i)||t.isEmpty(i.error)?(l._raise("filebatchuploadsuccess",[r]),s(),l.showPreview?(u.each(function(){var t=e(this);l._setThumbStatus(t,"Success"),t.removeClass("file-uploading"),t.find(".kv-file-upload").hide().removeAttr("disabled")}),l._initUploadSuccess(i)):l.reset(),l._setProgress(101)):(l.showPreview&&(u.each(function(){var t=e(this);t.removeClass("file-uploading"),t.find(".kv-file-upload").removeAttr("disabled"),t.find(".kv-file-remove").removeAttr("disabled"),0===c.length||-1!==e.inArray(d,c)?(l._setPreviewError(t,!0),l.retryErrorUploads||(t.find(".kv-file-upload").hide(),l.fileManager.remove(t))):(t.find(".kv-file-upload").hide(),l._setThumbStatus(t,"Success"),l.fileManager.remove(t)),t.hasClass("file-preview-error")&&!l.retryErrorUploads||d++}),l._initUploadSuccess(i)),o=l._parseError(p,n,l.msgUploadError),l._showFileError(o,r,"filebatchuploaderror"),l._setProgress(101,l.$progress,l.msgUploadError))},r=function(){l.unlock(),l._initSuccessThumbs(),l._clearFileInput(),l._raise("filebatchuploadcomplete",[l.fileManager.stack,l._getExtraData()])},n=function(t,i,a){var n=l._getOutData(h,t);o=l._parseError(p,t,a),l._showFileError(o,n,"filebatchuploaderror"),l.uploadFileCount=u-1,l.showPreview&&(l._getThumbs().each(function(){var t=e(this);t.removeClass("file-uploading"),l.fileManager.getFile(t.attr("data-fileid"))&&l._setPreviewError(t)}),l._getThumbs().removeClass("file-uploading"),l._getThumbs(" .kv-file-upload").removeAttr("disabled"),l._getThumbs(" .kv-file-delete").removeAttr("disabled"),l._setProgress(101,l.$progress,l.msgAjaxProgressError.replace("{operation}",p)))};var f=0;e.each(l.fileManager.stack,function(e,i){t.isEmpty(i.file)||h.append(l.uploadFileAttr,i.file,i.nameFmt||"untitled_"+f),f++}),l._ajaxSubmit(i,a,r,n,h)}},_uploadExtraOnly:function(){var e,i,a,n,r,o=this,s={},l=new FormData,d=o.ajaxOperations.uploadExtra;o._abort(s)||(e=function(e){o.lock();var t=o._getOutData(l,e);o._raise("filebatchpreupload",[t]),o._setProgress(50),s.data=t,s.xhr=e,o._abort(s)&&(e.abort(),o._setProgressCancelled())},i=function(e,i,a){var n=o._getOutData(l,a,e);t.isEmpty(e)||t.isEmpty(e.error)?(o._raise("filebatchuploadsuccess",[n]),o._clearFileInput(),o._initUploadSuccess(e),o._setProgress(101)):(r=o._parseError(d,a,o.msgUploadError),o._showFileError(r,n,"filebatchuploaderror"))},a=function(){o.unlock(),o._clearFileInput(),o._raise("filebatchuploadcomplete",[o.fileManager.stack,o._getExtraData()])},n=function(e,t,i){var a=o._getOutData(l,e);r=o._parseError(d,e,i),s.data=a,o._showFileError(r,a,"filebatchuploaderror"),o._setProgress(101,o.$progress,o.msgAjaxProgressError.replace("{operation}",d))},o._ajaxSubmit(e,i,a,n,l))},_deleteFileIndex:function(i){var a=i.attr("data-fileindex"),n=this.reversePreviewOrder;"init_"===a.substring(0,5)&&(a=parseInt(a.replace("init_","")),this.initialPreview=t.spliceArray(this.initialPreview,a,n),this.initialPreviewConfig=t.spliceArray(this.initialPreviewConfig,a,n),this.initialPreviewThumbTags=t.spliceArray(this.initialPreviewThumbTags,a,n),this.getFrames().each(function(){var t=e(this),i=t.attr("data-fileindex");"init_"===i.substring(0,5)&&(i=parseInt(i.replace("init_","")))>a&&(i--,t.attr("data-fileindex","init_"+i))}),(this.uploadAsync||this.enableResumableUpload)&&(this.cacheInitialPreview=this.getPreview()))},_initFileActions:function(){var i=this,a=i.$preview;i.showPreview&&(i._initZoomButton(),i.getFrames(" .kv-file-remove").each(function(){var n,r,o,s=e(this),l=s.closest(t.FRAMES),d=l.attr("id"),u=l.attr("data-fileindex");i._handler(s,"click",function(){if(!1===i._raise("filepreremove",[d,u])||!i._validateMinCount())return!1;n=l.hasClass("file-preview-error"),t.cleanMemory(l),l.fadeOut("slow",function(){t.cleanZoomCache(a.find("#zoom-"+d)),i.fileManager.remove(l),i._clearObjects(l),l.remove(),d&&n&&i.$errorContainer.find('li[data-thumb-id="'+d+'"]').fadeOut("fast",function(){e(this).remove(),i._errorsExist()||i._resetErrors()}),i._clearFileInput();var s,c=i.previewCache.count(!0),h=i.fileManager.count(),p=i.showPreview&&i.getFrames().length;0!==h||0!==c||p?((r=c+h)>1?o=i._getMsgSelected(r):(s=i.fileManager.getFirstFile(),o=s?s.nameFmt:"_"),i._setCaption(o)):i.reset(),i._raise("fileremoved",[d,u])})})}),i.getFrames(" .kv-file-upload").each(function(){var a=e(this);i._handler(a,"click",function(){var e=a.closest(t.FRAMES),n=e.attr("data-fileid");i.$progress.hide(),e.hasClass("file-preview-error")&&!i.retryErrorUploads||i._uploadSingle(i.fileManager.getIndex(n),n,!1)})}))},_initPreviewActions:function(){var i=this,a=i.$preview,n=i.deleteExtraData||{},r=t.FRAMES+" .kv-file-remove",o=i.fileActionSettings,s=o.removeClass,l=o.removeErrorClass,d=function(){var e=i.isAjaxUpload?i.previewCache.count(!0):i._inputFileCount();i.getFrames().length||e||(i._setCaption(""),i.reset(),i.initialCaption="")};i._initZoomButton(),a.find(r).each(function(){var r,o,u,c,h=e(this),p=h.data("url")||i.deleteUrl,f=h.data("key"),m=i.ajaxOperations.deleteThumb;if(!t.isEmpty(p)&&void 0!==f){"function"==typeof p&&(p=p());var v,g,w,y,b,_=h.closest(t.FRAMES),k=i.previewCache.data,x=_.attr("data-fileindex");x=parseInt(x.replace("init_","")),w=t.isEmpty(k.config)&&t.isEmpty(k.config[x])?null:k.config[x],b=t.isEmpty(w)||t.isEmpty(w.extra)?n:w.extra,y=w.filename||w.caption||"","function"==typeof b&&(b=b()),g={id:h.attr("id"),key:f,extra:b},o=function(e){i.ajaxAborted=!1,i._raise("filepredelete",[f,e,b]),i._abort()?e.abort():(h.removeClass(l),t.addCss(_,"file-uploading"),t.addCss(h,"disabled "+s))},u=function(e,n,o){var u,c;if(!t.isEmpty(e)&&!t.isEmpty(e.error))return g.jqXHR=o,g.response=e,r=i._parseError(m,o,i.msgDeleteError,y),i._showFileError(r,g,"filedeleteerror"),_.removeClass("file-uploading"),h.removeClass("disabled "+s).addClass(l),void d();_.removeClass("file-uploading").addClass("file-deleted"),_.fadeOut("slow",function(){x=parseInt(_.attr("data-fileindex").replace("init_","")),i.previewCache.unset(x),i._deleteFileIndex(_),u=i.previewCache.count(!0),c=u>0?i._getMsgSelected(u):"",i._setCaption(c),i._raise("filedeleted",[f,o,b]),t.cleanZoomCache(a.find("#zoom-"+_.attr("id"))),i._clearObjects(_),_.remove(),d()})},c=function(e,t,a){var n=i._parseError(m,e,a,y);g.jqXHR=e,g.response={},i._showFileError(n,g,"filedeleteerror"),_.removeClass("file-uploading"),h.removeClass("disabled "+s).addClass(l),d()},i._initAjaxSettings(),i._mergeAjaxCallback("beforeSend",o,"delete"),i._mergeAjaxCallback("success",u,"delete"),i._mergeAjaxCallback("error",c,"delete"),v=e.extend(!0,{},{url:i._encodeURI(p),type:"POST",dataType:"json",data:e.extend(!0,{},{key:f},b)},i._ajaxDeleteSettings),i._handler(h,"click",function(){if(!i._validateMinCount())return!1;i.ajaxAborted=!1,i._raise("filebeforedelete",[f,b]),i.ajaxAborted instanceof Promise?i.ajaxAborted.then(function(t){t||e.ajax(v)}):i.ajaxAborted||e.ajax(v)})}})},_hideFileIcon:function(){this.overwriteInitial&&this.$captionContainer.removeClass("icon-visible")},_showFileIcon:function(){t.addCss(this.$captionContainer,"icon-visible")},_getSize:function(t,i){var a,n,r=parseFloat(t),o=this.fileSizeGetter;return e.isNumeric(t)&&e.isNumeric(r)?("function"==typeof o?n=o(r):0===r?n="0.00 B":(a=Math.floor(Math.log(r)/Math.log(1024)),i||(i=["B","KB","MB","GB","TB","PB","EB","ZB","YB"]),n=1*(r/Math.pow(1024,a)).toFixed(2)+" "+i[a]),this._getLayoutTemplate("size").replace("{sizeText}",n)):""},_getFileType:function(e){return this.mimeTypeAliases[e]||e},_generatePreviewTemplate:function(i,a,n,r,o,s,l,d,u,c,h,p,f,m){var v,g,w=this,y=w.slug(n),b="",_="",k=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,x=w.preferIconicPreview?"other":i,C=y,T=y,P=c||w._renderFileFooter(i,y,d,"auto",l),D=w._getPreviewIcon(n),M="type-default",S=D&&w.preferIconicPreview,E=D&&w.preferIconicZoomPreview;return(v=k<400?w.previewSettingsSmall[x]||w.defaults.previewSettingsSmall[x]:w.previewSettings[x]||w.defaults.previewSettings[x])&&e.each(v,function(e,t){_+=e+":"+t+";"}),g=function(a,l,d,c){var m=d?"zoom-"+o:o,v=w._getPreviewTemplate(a),g=(u||"")+" "+c;return w.frameClass&&(g=w.frameClass+" "+g),d&&(g=g.replace(" "+t.SORT_CSS,"")),v=w._parseFilePreviewIcon(v,n),"text"===a&&(l=t.htmlEncode(l)),"object"!==i||r||e.each(w.defaults.fileTypeSettings,function(e,t){"object"!==e&&"other"!==e&&t(n,r)&&(M="type-"+e)}),t.isEmpty(f)||(void 0!==f.title&&null!==f.title&&(C=f.title),void 0!==f.alt&&null!==f.alt&&(C=f.alt)),v.setTokens({previewId:m,caption:y,title:C,alt:T,frameClass:g,type:w._getFileType(r),fileindex:h,fileid:s||"",typeCss:M,footer:P,data:l,template:p||i,style:_?'style="'+_+'"':""})},h=h||o.slice(o.lastIndexOf("-")+1),w.fileActionSettings.showZoom&&(b=g(E?"other":i,m||a,!0,"kv-zoom-thumb")),b="\n"+w._getLayoutTemplate("zoomCache").replace("{zoomContent}",b),"function"==typeof w.sanitizeZoomCache&&(b=w.sanitizeZoomCache(b)),g(S?"other":i,a,!1,"kv-preview-thumb")+b},_addToPreview:function(e,t){return this.reversePreviewOrder?e.prepend(t):e.append(t)},_previewDefault:function(i,a,n){var r=this.$preview;if(this.showPreview){var o,s=t.getFileName(i),l=i?i.type:"",d=i.size||0,u=this._getFileName(i,""),c=!0===n&&!this.isAjaxUpload,h=t.createObjectURL(i),p=this.fileManager.getId(i);this._clearDefaultPreview(),o=this._generatePreviewTemplate("other",h,s,l,a,p,c,d),this._addToPreview(r,o),this._setThumbAttr(a,u,d),!0===n&&this.isAjaxUpload&&this._setThumbStatus(e("#"+a),"Error")}},canPreview:function(e){if(!(e&&this.showPreview&&this.$preview&&this.$preview.length))return!1;var i,a,n,r=e.name||"",o=e.type||"",s=(e.size||0)/1e3,l=this._parseFileType(o,r),d=this.allowedPreviewTypes,u=this.allowedPreviewMimeTypes,c=this.allowedPreviewExtensions||[],h=this.disabledPreviewTypes,p=this.disabledPreviewMimeTypes,f=this.disabledPreviewExtensions||[],m=this.maxFilePreviewSize&&parseFloat(this.maxFilePreviewSize)||0,v=new RegExp("\\.("+c.join("|")+")$","i"),g=new RegExp("\\.("+f.join("|")+")$","i");return i=!d||-1!==d.indexOf(l),a=!u||-1!==u.indexOf(o),n=!c.length||t.compare(r,v),!(h&&-1!==h.indexOf(l)||p&&-1!==p.indexOf(o)||f.length&&t.compare(r,g)||m&&!isNaN(m)&&s>m)&&(i||a||n)},_previewFile:function(e,i,a,n,r,o){if(this.showPreview){var s,l=t.getFileName(i),d=o.type,u=o.name,c=this._parseFileType(d,l),h=this.$preview,p=i.size||0,f="text"===c||"html"===c||"image"===c?a.target.result:r,m=this.fileManager.getId(i);"html"===c&&this.purifyHtml&&window.DOMPurify&&(f=window.DOMPurify.sanitize(f)),s=this._generatePreviewTemplate(c,f,l,d,n,m,!1,p),this._clearDefaultPreview(),this._addToPreview(h,s);var v=h.find("#"+n),g=v.find("img"),w=v.attr("data-fileid");this._validateImageOrientation(g,i,n,w,u,d,p,f),this._setThumbAttr(n,u,p),this._initSortable()}},_setThumbAttr:function(t,i,a){var n=e("#"+t);n.length&&(a=a&&a>0?this._getSize(a):"",n.data({caption:i,size:a}))},_setInitThumbAttr:function(){var e,i,a,n,r=this.previewCache.data,o=this.previewCache.count(!0);if(0!==o)for(var s=0;s<o;s++)e=r.config[s],n=this.previewInitId+"-init_"+s,i=t.ifSet("caption",e,t.ifSet("filename",e)),a=t.ifSet("size",e),this._setThumbAttr(n,i,a)},_slugDefault:function(e){return t.isEmpty(e)?"":String(e).replace(/[\[\]\/\{}:;#%=\(\)\*\+\?\\\^\$\|<>&"']/g,"_")},_updateFileDetails:function(e){var i,a,n,r,o=this.$element,s=t.isIE(9)&&t.findFileName(o.val())||o[0].files[0]&&o[0].files[0].name;i=!s&&this.fileManager.count()>0?this.fileManager.getFirstFile().nameFmt:s?this.slug(s):"_",a=this.isAjaxUpload?this.fileManager.count():e,r=this.previewCache.count(!0)+a,n=1===a?i:this._getMsgSelected(r),this.isError?(this.$previewContainer.removeClass("file-thumb-loading"),this.$previewStatus.html(""),this.$captionContainer.removeClass("icon-visible")):this._showFileIcon(),this._setCaption(n,this.isError),this.$container.removeClass("file-input-new file-input-ajax-new"),1===arguments.length&&this._raise("fileselect",[e,i]),this.previewCache.count(!0)&&this._initPreviewActions()},_setThumbStatus:function(e,t){if(this.showPreview){var i="indicator"+t,a=i+"Title",n="file-preview-"+t.toLowerCase(),r=e.find(".file-upload-indicator"),o=this.fileActionSettings;e.removeClass("file-preview-success file-preview-error file-preview-loading"),"Success"===t&&e.find(".file-drag-handle").remove(),r.html(o[i]),r.attr("title",o[a]),e.addClass(n),"Error"!==t||this.retryErrorUploads||e.find(".kv-file-upload").attr("disabled",!0)}},_setProgressCancelled:function(){this._setProgress(101,this.$progress,this.msgCancelled)},_setProgress:function(e,i,a,n){if((i=i||this.$progress).length){var r,o=Math.min(e,100),s=this.progressUploadThreshold,l=e<=100?this.progressTemplate:this.progressCompleteTemplate,d=o<100?this.progressTemplate:a?this.paused?this.progressPauseTemplate:this.progressErrorTemplate:l;e>=100&&(n=""),t.isEmpty(d)||(n=n||"",r=(r=s&&o>s&&e<=100?d.setTokens({percent:s,status:this.msgUploadThreshold}):d.setTokens({percent:o,status:e>100?this.msgUploadEnd:o+"%"})).setTokens({stats:n}),i.html(r),a&&i.find('[role="progressbar"]').html(a))}},_setFileDropZoneTitle:function(){var e,i=this.$container.find(".file-drop-zone"),a=this.dropZoneTitle;this.isClickable&&(e=t.isEmpty(this.$element.attr("multiple"))?this.fileSingle:this.filePlural,a+=this.dropZoneClickTitle.replace("{files}",e)),i.find("."+this.dropZoneTitleClass).remove(),!this.showPreview||0===i.length||this.fileManager.count()>0||!this.dropZoneEnabled||!this.isAjaxUpload&&this.$element.files||(0===i.find(t.FRAMES).length&&t.isEmpty(this.defaultPreviewContent)&&i.prepend('<div class="'+this.dropZoneTitleClass+'">'+a+"</div>"),this.$container.removeClass("file-input-new"),t.addCss(this.$container,"file-input-ajax-new"))},_getStats:function(e){var i,a;return this.showUploadStats&&e&&e.bitrate?(a=this._getLayoutTemplate("stats"),i=e.elapsed&&e.bps?this.msgPendingTime.setTokens({time:t.getElapsed(Math.ceil(e.pendingBytes/e.bps))}):this.msgCalculatingTime,a.setTokens({uploadSpeed:e.bitrate,pendingTime:i})):""},_setResumableProgress:function(e,t,i){var a=this.resumableManager,n=i?a:this,r=i?i.find(".file-thumb-progress"):null;0===n.lastProgress&&(n.lastProgress=e),e<n.lastProgress&&(e=n.lastProgress),this._setProgress(e,r,null,this._getStats(t)),n.lastProgress=e},_setFileUploadStats:function(i,a,n,r){var o=this.$progress;if(this.showPreview||o&&o.length){var s,l=this.fileManager,d=l.getThumb(i),u=this.resumableManager,c=0,h=l.getTotalSize(),p=e.extend(!0,{},r);if(this.enableResumableUpload){var f,m=r.loaded,v=u.getUploadedSize(),g=u.file.size;m+=v,f=l.uploadedSize+m,a=t.round(100*m/g),r.pendingBytes=g-v,this._setResumableProgress(a,r,d),s=Math.floor(100*f/h),p.pendingBytes=h-f,this._setResumableProgress(s,p)}else l.setProgress(i,a),o=d&&d.length?d.find(".file-thumb-progress"):null,this._setProgress(a,o,null,this._getStats(r)),e.each(l.stats,function(e,t){c+=t.loaded}),p.pendingBytes=h-c,s=t.round(c/h*100),this._setProgress(s,null,null,this._getStats(p))}},_validateMinCount:function(){var e=this.isAjaxUpload?this.fileManager.count():this._inputFileCount();return!(this.validateInitialCount&&this.minFileCount>0&&this._getFileCount(e-1)<this.minFileCount)||(this._noFilesError({}),!1)},_getFileCount:function(e){return this.validateInitialCount&&!this.overwriteInitial&&(e+=this.previewCache.count(!0)),e},_getFileId:function(e){return t.getFileId(e,this.generateFileId)},_getFileName:function(e,i){var a=t.getFileName(e);return a?this.slug(a):i},_getFileNames:function(e){return this.filenames.filter(function(t){return e?void 0!==t:null!=t})},_setPreviewError:function(e,t){var i=this.removeFromPreviewOnError&&!this.retryErrorUploads;t&&!i||this.fileManager.remove(e),this.showPreview&&(i?e.remove():(this._setThumbStatus(e,"Error"),this._refreshUploadButton(e)))},_refreshUploadButton:function(e){var t=e.find(".kv-file-upload"),i=this.fileActionSettings,a=i.uploadIcon,n=i.uploadTitle;t.length&&(this.retryErrorUploads&&(a=i.uploadRetryIcon,n=i.uploadRetryTitle),t.attr("title",n).html(a))},_checkDimensions:function(e,i,a,n,r,o,s){var l,d,u,c=this[("Small"===i?"min":"max")+"Image"+o];!t.isEmpty(c)&&a.length&&(u=a[0],d="Width"===o?u.naturalWidth||u.width:u.naturalHeight||u.height,("Small"===i?d>=c:d<=c)||(l=this["msgImage"+o+i].setTokens({name:r,size:c}),this._showFileError(l,s),this._setPreviewError(n)))},_getExifObj:function(e){var i=null,a=t.logMessages.exifWarning;if("data:image/jpeg;base64,"===e.slice(0,23)||"data:image/jpg;base64,"===e.slice(0,22)){try{i=window.piexif?window.piexif.load(e):null}catch(e){i=null,a=e&&e.message||""}return i||this._log(t.logMessages.badExifParser,{details:a}),i}i=null},_validateImageOrientation:function(e,i,a,n,r,o,s,l){var d,u,c=this.autoOrientImage;(u=(d=e.length&&c?this._getExifObj(l):null)?d["0th"][piexif.ImageIFD.Orientation]:null)?(t.setImageOrientation(e,this.$preview.find("#zoom-"+a+" img"),u),this._raise("fileimageoriented",{$img:e,file:i}),this._validateImage(a,n,r,o,s,l,d)):this._validateImage(a,n,r,o,s,l,d)},_validateImage:function(t,i,a,n,r,o,s){var l,d,u,c=this,h=c.$preview,p=h.find("#"+t),f=p.attr("data-fileindex"),m=p.find("img");a=a||"Untitled",m.one("load",function(){d=p.width(),u=h.width(),d>u&&m.css("width","100%"),l={ind:f,id:t,fileId:i},c._checkDimensions(f,"Small",m,p,a,"Width",l),c._checkDimensions(f,"Small",m,p,a,"Height",l),c.resizeImage||(c._checkDimensions(f,"Large",m,p,a,"Width",l),c._checkDimensions(f,"Large",m,p,a,"Height",l)),c._raise("fileimageloaded",[t]),c.fileManager.addImage(i,{ind:f,img:m,thumb:p,pid:t,typ:n,siz:r,validated:!1,imgData:o,exifObj:s}),p.data("exif",s),c._validateAllImages()}).one("error",function(){c._raise("fileimageloaderror",[t])}).each(function(){this.complete?e(this).trigger("load"):this.error&&e(this).trigger("error")})},_validateAllImages:function(){var t,i=this,a={val:0},n=i.fileManager.getImageCount(),r=i.resizeIfSizeMoreThan;n===i.fileManager.totalImages&&(i._raise("fileimagesloaded"),i.resizeImage&&e.each(i.fileManager.loadedImages,function(e,o){o.validated||((t=o.siz)&&t>1e3*r&&i._getResizedImage(e,o,a,n),o.validated=!0)}))},_getResizedImage:function(i,a,n,r){var o,s,l,d,u,c,h,p,f,m=this,v=e(a.img)[0],g=v.naturalWidth,w=v.naturalHeight,y=1,b=m.maxImageWidth||g,_=m.maxImageHeight||w,k=!(!g||!w),x=m.imageCanvas,C=m.imageCanvasContext,T=a.typ,P=a.pid,D=a.ind,M=a.thumb,S=a.exifObj;if(u=function(e,t,i){m.isAjaxUpload?m._showFileError(e,t,i):m._showError(e,t,i),m._setPreviewError(M)},p={id:P,index:D,fileId:i},f=[i,P,D],(h=m.fileManager.getFile(i))&&k&&!(g<=b&&w<=_)||(k&&h&&m._raise("fileimageresized",f),n.val++,n.val===r&&m._raise("fileimagesresized"),k)){T=T||m.resizeDefaultImageType,s=g>b,l=w>_,y="width"===m.resizePreference?s?b/g:l?_/w:1:l?_/w:s?b/g:1,m._resetCanvas(),g*=y,w*=y,x.width=g,x.height=w;try{C.drawImage(v,0,0,g,w),d=x.toDataURL(T,m.resizeQuality),S&&(c=window.piexif.dump(S),d=window.piexif.insert(c,d)),o=t.dataURI2Blob(d),m.fileManager.setFile(i,o),m._raise("fileimageresized",f),n.val++,n.val===r&&m._raise("fileimagesresized",[void 0,void 0]),o instanceof Blob||u(m.msgImageResizeError,p,"fileimageresizeerror")}catch(e){n.val++,n.val===r&&m._raise("fileimagesresized",[void 0,void 0]),u(m.msgImageResizeException.replace("{errors}",e.message),p,"fileimageresizeexception")}}else u(m.msgImageResizeError,p,"fileimageresizeerror")},_initBrowse:function(e){var i=this.$element;this.showBrowse?this.$btnFile=e.find(".btn-file").append(i):(i.appendTo(e).attr("tabindex",-1),t.addCss(i,"file-no-browse"))},_initClickable:function(){var i,a,n=this;n.isClickable&&(i=n.$dropZone,n.isAjaxUpload||(a=n.$preview.find(".file-default-preview")).length&&(i=a),t.addCss(i,"clickable"),i.attr("tabindex",-1),n._handler(i,"click",function(t){var a=e(t.target);e(n.elErrorContainer+":visible").length||a.parents(".file-preview-thumbnails").length&&!a.parents(".file-default-preview").length||(n.$element.data("zoneClicked",!0).trigger("click"),i.blur())}))},_initCaption:function(){var e=this.initialCaption||"";return this.overwriteInitial||t.isEmpty(e)?(this.$caption.val(""),!1):(this._setCaption(e),!0)},_setCaption:function(i,a){var n,r,o,s,l,d;if(this.$caption.length){if(this.$captionContainer.removeClass("icon-visible"),a)n=e("<div>"+this.msgValidationError+"</div>").text(),(s=this.fileManager.count())?(d=this.fileManager.getFirstFile(),l=1===s&&d?d.nameFmt:this._getMsgSelected(s)):l=this._getMsgSelected(this.msgNo),r=t.isEmpty(i)?l:i,o='<span class="'+this.msgValidationErrorClass+'">'+this.msgValidationErrorIcon+"</span>";else{if(t.isEmpty(i))return;r=n=e("<div>"+i+"</div>").text(),o=this._getLayoutTemplate("fileIcon")}this.$captionContainer.addClass("icon-visible"),this.$caption.attr("title",n).val(r),this.$captionIcon.html(o)}},_createContainer:function(){var t={class:"file-input file-input-new"+(this.rtl?" kv-rtl":"")},i=e(document.createElement("div")).attr(t).html(this._renderMain());return i.insertBefore(this.$element),this._initBrowse(i),this.theme&&i.addClass("theme-"+this.theme),i},_refreshContainer:function(){var e=this.$container;this.$element.insertAfter(e),e.html(this._renderMain()),this._initBrowse(e),this._validateDisabled()},_validateDisabled:function(){this.$caption.attr({readonly:this.isDisabled})},_renderMain:function(){var e=this.dropZoneEnabled?" file-drop-zone":"file-drop-disabled",t=this.showClose?this._getLayoutTemplate("close"):"",i=this.showPreview?this._getLayoutTemplate("preview").setTokens({class:this.previewClass,dropClass:e}):"",a=this.isDisabled?this.captionClass+" file-caption-disabled":this.captionClass,n=this.captionTemplate.setTokens({class:a+" kv-fileinput-caption"});return this.mainTemplate.setTokens({class:this.mainClass+(!this.showBrowse&&this.showCaption?" no-browse":""),preview:i,close:t,caption:n,upload:this._renderButton("upload"),remove:this._renderButton("remove"),cancel:this._renderButton("cancel"),pause:this._renderButton("pause"),browse:this._renderButton("browse")})},_renderButton:function(e){var i=this._getLayoutTemplate("btnDefault"),a=this[e+"Class"],n=this[e+"Title"],r=this[e+"Icon"],o=this[e+"Label"],s=this.isDisabled?" disabled":"",l="button";switch(e){case"remove":if(!this.showRemove)return"";break;case"cancel":if(!this.showCancel)return"";a+=" kv-hidden";break;case"pause":if(!this.showPause)return"";a+=" kv-hidden";break;case"upload":if(!this.showUpload)return"";this.isAjaxUpload&&!this.isDisabled?i=this._getLayoutTemplate("btnLink").replace("{href}",this.uploadUrl):l="submit";break;case"browse":if(!this.showBrowse)return"";i=this._getLayoutTemplate("btnBrowse");break;default:return""}return a+="browse"===e?" btn-file":" fileinput-"+e+" fileinput-"+e+"-button",t.isEmpty(o)||(o=' <span class="'+this.buttonLabelClass+'">'+o+"</span>"),i.setTokens({type:l,css:a,title:n,status:s,icon:r,label:o})},_renderThumbProgress:function(){return'<div class="file-thumb-progress kv-hidden">'+this.progressInfoTemplate.setTokens({percent:101,status:this.msgUploadBegin,stats:""})+"</div>"},_renderFileFooter:function(e,i,a,n,r){var o,s,l=this.fileActionSettings,d=l.showRemove,u=l.showDrag,c=l.showUpload,h=l.showZoom,p=this._getLayoutTemplate("footer"),f=this._getLayoutTemplate("indicator"),m=r?l.indicatorError:l.indicatorNew,v=r?l.indicatorErrorTitle:l.indicatorNewTitle,g=f.setTokens({indicator:m,indicatorTitle:v});return s={type:e,caption:i,size:a=this._getSize(a),width:n,progress:"",indicator:g},this.isAjaxUpload?(s.progress=this._renderThumbProgress(),s.actions=this._renderFileActions(s,c,!1,d,h,u,!1,!1,!1)):s.actions=this._renderFileActions(s,!1,!1,!1,h,u,!1,!1,!1),o=p.setTokens(s),o=t.replaceTags(o,this.previewThumbTags)},_renderFileActions:function(e,t,i,a,n,r,o,s,l,d,u,c){if(!e.type&&d&&(e.type="image"),"function"==typeof t&&(t=t(e)),"function"==typeof i&&(i=i(e)),"function"==typeof a&&(a=a(e)),"function"==typeof n&&(n=n(e)),"function"==typeof r&&(r=r(e)),!(t||i||a||n||r))return"";var h,p=!1===s?"":' data-url="'+s+'"',f=!1===l?"":' data-key="'+l+'"',m="",v="",g="",w="",y="",b=this._getLayoutTemplate("actions"),_=this.fileActionSettings,k=this.otherActionButtons.setTokens({dataKey:f,key:l}),x=o?_.removeClass+" disabled":_.removeClass;return a&&(m=this._getLayoutTemplate("actionDelete").setTokens({removeClass:x,removeIcon:_.removeIcon,removeTitle:_.removeTitle,dataUrl:p,dataKey:f,key:l})),t&&(v=this._getLayoutTemplate("actionUpload").setTokens({uploadClass:_.uploadClass,uploadIcon:_.uploadIcon,uploadTitle:_.uploadTitle})),i&&(g=(g=this._getLayoutTemplate("actionDownload").setTokens({downloadClass:_.downloadClass,downloadIcon:_.downloadIcon,downloadTitle:_.downloadTitle,downloadUrl:u||this.initialPreviewDownloadUrl})).setTokens({filename:c,key:l})),n&&(w=this._getLayoutTemplate("actionZoom").setTokens({zoomClass:_.zoomClass,zoomIcon:_.zoomIcon,zoomTitle:_.zoomTitle})),r&&d&&(h="drag-handle-init "+_.dragClass,y=this._getLayoutTemplate("actionDrag").setTokens({dragClass:h,dragTitle:_.dragTitle,dragIcon:_.dragIcon})),b.setTokens({delete:m,upload:v,download:g,zoom:w,drag:y,other:k})},_browse:function(e){e&&e.isDefaultPrevented()||!this._raise("filebrowse")||(this.isError&&!this.isAjaxUpload&&this.clear(),this.$captionContainer.focus())},_change:function(i){var a=this;if(!a.changeTriggered){var n,r,o,s,l,d,u,c,h,p,f,m,v=a.$element,g=arguments.length>1,w=a.isAjaxUpload,y=g?arguments[1]:v.get(0).files,b=!w&&t.isEmpty(v.attr("multiple"))?1:a.maxFileCount,_=a.fileManager.count(),k=t.isEmpty(v.attr("multiple"))&&_>0;if(a.reader=null,a._resetUpload(),a._hideFileIcon(),a.dropZoneEnabled&&a.$container.find(".file-drop-zone ."+a.dropZoneTitleClass).remove(),w||(y=i.target&&void 0===i.target.files?i.target.value?[{name:i.target.value.replace(/^.+\\/,"")}]:[]:i.target.files||{}),n=y,t.isEmpty(n)||0===n.length)return w||a.clear(),void a._raise("fileselectnone");if(a._resetErrors(),o=n.length,r=a._getFileCount(w?a.fileManager.count()+o:o),b>0&&r>b){if(!a.autoReplace||o>b)return s=a.autoReplace&&o>b?o:r,l=b,m=a.msgFilesTooMany.replace("{m}",l).replace("{n}",s),a.isError=(d=m,u=null,c=null,h=null,p=e.extend(!0,{},a._getOutData(null,{},{},y),{id:c,index:h}),f={id:c,index:h,file:u,files:y},w?a._showFileError(d,p):a._showError(d,f)),a.$captionContainer.removeClass("icon-visible"),a._setCaption("",!0),void a.$container.removeClass("file-input-new file-input-ajax-new");r>b&&a._resetPreviewThumbs(w)}else!w||k?(a._resetPreviewThumbs(!1),k&&a.clearFileStack()):!w||0!==_||a.previewCache.count(!0)&&!a.overwriteInitial||a._resetPreviewThumbs(!0);a.readFiles(n)}},_abort:function(t){var i;return this.ajaxAborted&&"object"===_typeof(this.ajaxAborted)&&void 0!==this.ajaxAborted.message?((i=e.extend(!0,{},this._getOutData(null),t)).abortData=this.ajaxAborted.data||{},i.abortMessage=this.ajaxAborted.message,this._setProgress(101,this.$progress,this.msgCancelled),this._showFileError(this.ajaxAborted.message,i,"filecustomerror"),this.cancel(),!0):!!this.ajaxAborted},_resetFileStack:function(){var i=this,a=0;i._getThumbs().each(function(){var n=e(this),r=n.attr("data-fileindex"),o=n.attr("id");"-1"!==r&&-1!==r&&(i.fileManager.getFile(n.attr("data-fileid"))?n.attr({id:"uploaded-"+t.uniqId(),"data-fileindex":"-1"}):(n.attr({id:i.previewInitId+"-"+a,"data-fileindex":a}),a++),i.$preview.find("#zoom-"+o).attr({id:"zoom-"+n.attr("id"),"data-fileindex":n.attr("data-fileindex")}))})},_isFileSelectionValid:function(e){return e=e||0,this.required&&!this.getFilesCount()?(this.$errorContainer.html(""),this._showFileError(this.msgFileRequired),!1):!(this.minFileCount>0&&this._getFileCount(e)<this.minFileCount)||(this._noFilesError({}),!1)},clearFileStack:function(){return this.fileManager.clear(),this._initResumableUpload(),this.enableResumableUpload?(null===this.showPause&&(this.showPause=!0),null===this.showCancel&&(this.showCancel=!1)):(this.showPause=!1,null===this.showCancel&&(this.showCancel=!0)),this.$element},getFileStack:function(){return this.files.stack},getFileList:function(){return this.files.list()},getFilesCount:function(){var e=this.isAjaxUpload?this.fileManager.count():this._inputFileCount();return this._getFileCount(e)},readFiles:function(i){this.reader=new FileReader;var a,n=this,r=n.$element,o=n.reader,s=n.$previewContainer,l=n.$previewStatus,d=n.msgLoading,u=n.msgProgress,c=n.previewInitId,h=i.length,p=n.fileTypeSettings,f=n.fileManager.count(),m=n.allowedFileTypes,v=m?m.length:0,g=n.allowedFileExtensions,w=t.isEmpty(g)?"":g.join(", "),y=function(t,r,o,s,l){var d=e.extend(!0,{},n._getOutData(null,{},{},i),{id:o,index:s,fileId:l}),u=e("#"+o),c={id:o,index:s,fileId:l,file:r,files:i};n._previewDefault(r,o,!0),n.isAjaxUpload?setTimeout(function(){a(s+1)},n.processDelay):h=0,n._initFileActions(),u.remove(),n.isError=n.isAjaxUpload?n._showFileError(t,d):n._showError(t,c),n._updateFileDetails(h)};n.fileManager.clearImages(),e.each(i,function(e,t){var i=n.fileTypeSettings.image;i&&i(t.type)&&n.fileManager.totalImages++}),(a=function(b){if(t.isEmpty(r.attr("multiple"))&&(h=1),b>=h)return n.isAjaxUpload&&n.fileManager.count()>0?n._raise("filebatchselected",[n.fileManager.stack]):n._raise("filebatchselected",[i]),s.removeClass("file-thumb-loading"),void l.html("");var _,k,x,C,T,P,D,M,S,E,I,F,A,O=c+"-"+(f+b),$=i[b],j=p.text,z=p.image,U=p.html,R=n._getFileName($,""),N=($&&$.size||0)/1e3,B="",L=t.createObjectURL($),Y=0,V="",Z=0,H=function(){var e=u.setTokens({index:b+1,files:h,percent:50,name:R});setTimeout(function(){l.html(e),n._updateFileDetails(h),a(b+1)},n.processDelay),n._raise("fileloaded",[$,O,b,o])};if($){if(M=n.fileManager.getId($),v>0)for(k=0;k<v;k++)P=m[k],D=n.msgFileTypes[P]||P,V+=0===k?D:", "+D;if(!1!==R){if(0===R.length)return x=n.msgInvalidFileName.replace("{name}",t.htmlEncode(t.getFileName($),"[unknown]")),void y(x,$,O,b,M);if(t.isEmpty(g)||(B=new RegExp("\\.("+g.join("|")+")$","i")),_=N.toFixed(2),n.maxFileSize>0&&N>n.maxFileSize)return x=n.msgSizeTooLarge.setTokens({name:R,size:_,maxSize:n.maxFileSize}),void y(x,$,O,b,M);if(null!==n.minFileSize&&N<=t.getNum(n.minFileSize))return x=n.msgSizeTooSmall.setTokens({name:R,size:_,minSize:n.minFileSize}),void y(x,$,O,b,M);if(!t.isEmpty(m)&&t.isArray(m)){for(k=0;k<m.length;k+=1)C=m[k],Y+=(S=p[C])&&"function"==typeof S&&S($.type,t.getFileName($))?1:0;if(0===Y)return x=n.msgInvalidFileType.setTokens({name:R,types:V}),void y(x,$,O,b,M)}if(0===Y&&!t.isEmpty(g)&&t.isArray(g)&&!t.isEmpty(B)&&(T=t.compare(R,B),0===(Y+=t.isEmpty(T)?0:T.length)))return x=n.msgInvalidFileExtension.setTokens({name:R,extensions:w}),void y(x,$,O,b,M);if(n.isAjaxUpload&&n.fileManager.exists(M))return x=n.msgDuplicateFile.setTokens({name:R,size:_}),void y(x,$,O,b,M);if(!n.canPreview($))return n.isAjaxUpload&&n.fileManager.add($),n.showPreview&&(s.addClass("file-thumb-loading"),n._previewDefault($,O),n._initFileActions()),void setTimeout(function(){n._updateFileDetails(h),a(b+1),n._raise("fileloaded",[$,O,b])},10);E=j($.type,R),I=U($.type,R),F=z($.type,R),l.html(d.replace("{index}",b+1).replace("{files}",h)),s.addClass("file-thumb-loading"),o.onerror=function(e){n._errorHandler(e,R)},o.onload=function(i){var a,r,s,l,d,u,c,h,f=[];if(r={name:R,type:$.type},e.each(p,function(e,t){"object"!==e&&"other"!==e&&"function"==typeof t&&t($.type,R)&&Z++}),0===Z){for(s=new Uint8Array(i.target.result),k=0;k<s.length;k++)l=s[k].toString(16),f.push(l);if(a=f.join("").toLowerCase().substring(0,8),u=t.getMimeType(a,"",""),t.isEmpty(u)&&(d=t.arrayBuffer2String(o.result),u=t.isSvg(d)?"image/svg+xml":t.getMimeType(a,d,$.type)),r={name:R,type:u},E=j(u,""),I=U(u,""),F=z(u,""),(A=E||I)||F)return c=A,(h=new FileReader).onerror=function(e){n._errorHandler(e,R)},h.onload=function(e){n._previewFile(b,$,e,O,L,r),n._initFileActions(),H()},void(c?h.readAsText($,n.textEncoding):h.readAsDataURL($))}n._previewFile(b,$,i,O,L,r),n._initFileActions(),H()},o.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100,i=Math.ceil(t);x=u.setTokens({index:b+1,files:h,percent:i,name:R}),setTimeout(function(){l.html(x)},n.processDelay)}},E||I?o.readAsText($,n.textEncoding):F?o.readAsDataURL($):o.readAsArrayBuffer($),n.fileManager.add($)}else a(b+1)}})(0),n._updateFileDetails(h,!1)},lock:function(){var e=this.$container;return this._resetErrors(),this.disable(),e.addClass("is-locked"),this.showCancel&&e.find(".fileinput-cancel").show(),this.showPause&&e.find(".fileinput-pause").show(),this._raise("filelock",[this.fileManager.stack,this._getExtraData()]),this.$element},unlock:function(e){var t=this.$container;return void 0===e&&(e=!0),this.enable(),t.removeClass("is-locked"),this.showCancel&&t.find(".fileinput-cancel").hide(),this.showPause&&t.find(".fileinput-pause").hide(),e&&this._resetFileStack(),this._raise("fileunlock",[this.fileManager.stack,this._getExtraData()]),this.$element},pause:function(){var t,i=this,a=i.resumableManager,n=i.ajaxRequests,r=n.length;if(i.enableResumableUpload){if(a.chunkIntervalId&&clearInterval(a.chunkIntervalId),i.ajaxQueueIntervalId&&clearInterval(i.ajaxQueueIntervalId),i._raise("fileuploadpaused",[i.fileManager,a]),r>0)for(t=0;t<r;t+=1)i.paused=!0,n[t].abort();return i.showPreview&&(a.$btnUpload.removeAttr("disabled"),i._getThumbs().each(function(){var t=e(this),a=t.attr("data-fileid");t.removeClass("file-uploading"),i.fileManager.getFile(a)||(t.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled"),t.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled"))})),i._setProgress(101,i.$progress,i.msgPaused),i.$element}},cancel:function(){var t,i=this,a=i.ajaxRequests,n=i.resumableManager,r=a.length;if(i.enableResumableUpload&&n.chunkIntervalId?(clearInterval(n.chunkIntervalId),n.reset(),i._raise("fileuploadcancelled",[i.fileManager,n])):i._raise("fileuploadcancelled",[i.fileManager]),i.ajaxQueueIntervalId&&clearInterval(i.ajaxQueueIntervalId),i._initAjax(),r>0)for(t=0;t<r;t+=1)i.cancelling=!0,a[t].abort();return i._getThumbs().each(function(){var t=e(this),a=t.attr("data-fileid"),n=t.find(".file-thumb-progress");t.removeClass("file-uploading"),i._setProgress(0,n),n.hide(),i.fileManager.getFile(a)||(t.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled"),t.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled")),i.unlock()}),setTimeout(function(){i._setProgressCancelled()},i.processDelay),i.$element},clear:function(){var i,a=this;if(a._raise("fileclear"))return a.$btnUpload.removeAttr("disabled"),a._getThumbs().find("video,audio,img").each(function(){t.cleanMemory(e(this))}),a._clearFileInput(),a._resetUpload(),a.clearFileStack(),a._resetErrors(!0),a._hasInitialPreview()?(a._showFileIcon(),a._resetPreview(),a._initPreviewActions(),a.$container.removeClass("file-input-new")):(a._getThumbs().each(function(){a._clearObjects(e(this))}),a.isAjaxUpload&&(a.previewCache.data={}),a.$preview.html(""),i=!a.overwriteInitial&&a.initialCaption.length>0?a.initialCaption:"",a.$caption.attr("title","").val(i),t.addCss(a.$container,"file-input-new"),a._validateDefaultPreview()),0===a.$container.find(t.FRAMES).length&&(a._initCaption()||a.$captionContainer.removeClass("icon-visible")),a._hideFileIcon(),a.$captionContainer.focus(),a._setFileDropZoneTitle(),a._raise("filecleared"),a.$element},reset:function(){if(this._raise("filereset"))return this.lastProgress=0,this._resetPreview(),this.$container.find(".fileinput-filename").text(""),t.addCss(this.$container,"file-input-new"),(this.getFrames().length||this.dropZoneEnabled)&&this.$container.removeClass("file-input-new"),this.clearFileStack(),this._setFileDropZoneTitle(),this.$element},disable:function(){return this.isDisabled=!0,this._raise("filedisabled"),this.$element.attr("disabled","disabled"),this.$container.find(".kv-fileinput-caption").addClass("file-caption-disabled"),this.$container.find(".fileinput-remove, .fileinput-upload, .file-preview-frame button").attr("disabled",!0),t.addCss(this.$container.find(".btn-file"),"disabled"),this._initDragDrop(),this.$element},enable:function(){return this.isDisabled=!1,this._raise("fileenabled"),this.$element.removeAttr("disabled"),this.$container.find(".kv-fileinput-caption").removeClass("file-caption-disabled"),this.$container.find(".fileinput-remove, .fileinput-upload, .file-preview-frame button").removeAttr("disabled"),this.$container.find(".btn-file").removeClass("disabled"),this._initDragDrop(),this.$element},upload:function(){var i,a,n,r=this,o=r.fileManager,s=o.count(),l=r.resumableManager,d=!e.isEmptyObject(r._getExtraData()),u=r.$progress;if(r.isAjaxUpload&&!r.isDisabled&&r._isFileSelectionValid(s)){if(r.lastProgress=0,r._resetUpload(),0!==s||d){if(r.cancelling=!1,r.$progress.show(),r.lock(),n=o.count(),0===s&&d)return r._setProgress(2),void r._uploadExtraOnly();if(r.uploadAsync||r.enableResumableUpload){for(a=r._getOutData(null),r._raise("filebatchpreupload",[a]),r.fileBatchCompleted=!1,r.uploadCache={content:[],config:[],tags:[],append:!0},i=0;i<n;i++)r.uploadCache.content[i]=null,r.uploadCache.config[i]=null,r.uploadCache.tags[i]=null;r.$preview.find(".file-preview-initial").removeClass(t.SORT_CSS),r._initSortable(),r.cacheInitialPreview=r.getPreview()}if(r.enableResumableUpload){var c=!1;return r.paused?u.html(r.progressPauseTemplate.setTokens({percent:101,status:r.msgUploadResume,stats:""})):c=!0,r.paused=!1,c&&u.html(r.progressInfoTemplate.setTokens({percent:101,status:r.msgUploadBegin,stats:""})),setTimeout(function(){l.upload()},r.processDelay),r.$element}return r._setProgress(2),r.hasInitData=!1,r.uploadAsync?(i=0,void e.each(o.stack,function(e){r._uploadSingle(i,e,!0),i++})):(r._uploadBatch(),r.$element)}r._showFileError(r.msgUploadEmpty)}},destroy:function(){var t=this.$form,i=this.$container,a=this.$element,n=this.namespace;return e(document).off(n),e(window).off(n),t&&t.length&&t.off(n),this.isAjaxUpload&&this._clearFileInput(),this._cleanup(),this._initPreviewCache(),a.insertBefore(i).off(n).removeData(),i.off().remove(),a},refresh:function(i){var a=this.$element;return i="object"!==_typeof(i)||t.isEmpty(i)?this.options:e.extend(!0,{},this.options,i),this._init(i,!0),this._listen(),a},zoom:function(e){var i=this._getFrame(e),a=this.$modal;i&&(t.initModal(a),a.html(this._getModalContent()),this._setZoomContent(i),a.modal("show"),this._initZoomButtons())},getExif:function(e){var t=this._getFrame(e);return t&&t.data("exif")||null},getFrames:function(i){var a;return i=i||"",a=this.$preview.find(t.FRAMES+i),this.reversePreviewOrder&&(a=e(a.get().reverse())),a},getPreview:function(){return{content:this.initialPreview,config:this.initialPreviewConfig,tags:this.initialPreviewThumbTags}}},e.fn.fileinput=function(a){if(t.hasFileAPISupport()||t.isIE(9)){var n=Array.apply(null,arguments),r=[];switch(n.shift(),this.each(function(){var o,s=e(this),l=s.data("fileinput"),d="object"===_typeof(a)&&a,u=d.theme||s.data("theme"),c={},h={},p=d.language||s.data("language")||e.fn.fileinput.defaults.language||"en";l||(u&&(h=e.fn.fileinputThemes[u]||{}),"en"===p||t.isEmpty(e.fn.fileinputLocales[p])||(c=e.fn.fileinputLocales[p]||{}),o=e.extend(!0,{},e.fn.fileinput.defaults,h,e.fn.fileinputLocales.en,c,d,s.data()),l=new i(this,o),s.data("fileinput",l)),"string"==typeof a&&r.push(l[a].apply(l,n))}),r.length){case 0:return this;case 1:return r[0];default:return r}}},e.fn.fileinput.defaults={language:"en",showCaption:!0,showBrowse:!0,showPreview:!0,showRemove:!0,showUpload:!0,showUploadStats:!0,showCancel:null,showPause:null,showClose:!0,showUploadedThumbs:!0,browseOnZoneClick:!1,autoReplace:!1,autoOrientImage:function(){var e=window.navigator.userAgent,t=!!e.match(/WebKit/i);return!(!!e.match(/iP(od|ad|hone)/i)&&t&&!e.match(/CriOS/i))},autoOrientImageInitial:!0,required:!1,rtl:!1,hideThumbnailContent:!1,encodeUrl:!0,generateFileId:null,previewClass:"",captionClass:"",frameClass:"krajee-default",mainClass:"file-caption-main",mainTemplate:null,purifyHtml:!0,fileSizeGetter:null,initialCaption:"",initialPreview:[],initialPreviewDelimiter:"*$$*",initialPreviewAsData:!1,initialPreviewFileType:"image",initialPreviewConfig:[],initialPreviewThumbTags:[],previewThumbTags:{},initialPreviewShowDelete:!0,initialPreviewDownloadUrl:"",removeFromPreviewOnError:!1,deleteUrl:"",deleteExtraData:{},overwriteInitial:!0,sanitizeZoomCache:function(t){var i=e(document.createElement("div")).append(t);return i.find("input,select,.file-thumbnail-footer").remove(),i.html()},previewZoomButtonIcons:{prev:'<i class="glyphicon glyphicon-triangle-left"></i>',next:'<i class="glyphicon glyphicon-triangle-right"></i>',toggleheader:'<i class="glyphicon glyphicon-resize-vertical"></i>',fullscreen:'<i class="glyphicon glyphicon-fullscreen"></i>',borderless:'<i class="glyphicon glyphicon-resize-full"></i>',close:'<i class="glyphicon glyphicon-remove"></i>'},previewZoomButtonClasses:{prev:"btn btn-navigate",next:"btn btn-navigate",toggleheader:"btn btn-sm btn-kv btn-default btn-outline-secondary",fullscreen:"btn btn-sm btn-kv btn-default btn-outline-secondary",borderless:"btn btn-sm btn-kv btn-default btn-outline-secondary",close:"btn btn-sm btn-kv btn-default btn-outline-secondary"},previewTemplates:{},previewContentTemplates:{},preferIconicPreview:!1,preferIconicZoomPreview:!1,allowedFileTypes:null,allowedFileExtensions:null,allowedPreviewTypes:void 0,allowedPreviewMimeTypes:null,allowedPreviewExtensions:null,disabledPreviewTypes:void 0,disabledPreviewExtensions:["msi","exe","com","zip","rar","app","vb","scr"],disabledPreviewMimeTypes:null,defaultPreviewContent:null,customLayoutTags:{},customPreviewTags:{},previewFileIcon:'<i class="glyphicon glyphicon-file"></i>',previewFileIconClass:"file-other-icon",previewFileIconSettings:{},previewFileExtSettings:{},buttonLabelClass:"hidden-xs",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i>&nbsp;',browseClass:"btn btn-primary",removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-default btn-secondary",cancelIcon:'<i class="glyphicon glyphicon-ban-circle"></i>',cancelClass:"btn btn-default btn-secondary",pauseIcon:'<i class="glyphicon glyphicon-pause"></i>',pauseClass:"btn btn-default btn-secondary",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-default btn-secondary",uploadUrl:null,uploadUrlThumb:null,uploadAsync:!0,uploadParamNames:{chunkIndex:"chunkIndex",chunkCount:"chunkCount",chunkSize:"chunkSize",chunkSizeStart:"chunkSizeStart",chunksUploaded:"chunksUploaded",retryCount:"retryCount",fileId:"fileId",fileRelativePath:"fileRelativePath",fileSize:"fileSize",fileName:"fileName"},maxAjaxThreads:5,processDelay:100,queueDelay:10,progressDelay:0,enableResumableUpload:!1,resumableUploadOptions:{fallback:null,testUrl:null,chunkSize:2048,maxThreads:4,maxRetries:3,showErrorLog:!0},uploadExtraData:{},zoomModalHeight:480,minImageWidth:null,minImageHeight:null,maxImageWidth:null,maxImageHeight:null,resizeImage:!1,resizePreference:"width",resizeQuality:.92,resizeDefaultImageType:"image/jpeg",resizeIfSizeMoreThan:0,minFileSize:0,maxFileSize:0,maxFilePreviewSize:25600,minFileCount:0,maxFileCount:0,validateInitialCount:!1,msgValidationErrorClass:"text-danger",msgValidationErrorIcon:'<i class="glyphicon glyphicon-exclamation-sign"></i> ',msgErrorClass:"file-error-message",progressThumbClass:"progress-bar progress-bar-striped active",progressClass:"progress-bar bg-success progress-bar-success progress-bar-striped active",progressInfoClass:"progress-bar bg-info progress-bar-info progress-bar-striped active",progressCompleteClass:"progress-bar bg-success progress-bar-success",progressPauseClass:"progress-bar bg-primary progress-bar-primary progress-bar-striped active",progressErrorClass:"progress-bar bg-danger progress-bar-danger",progressUploadThreshold:99,previewFileType:"image",elCaptionContainer:null,elCaptionText:null,elPreviewContainer:null,elPreviewImage:null,elPreviewStatus:null,elErrorContainer:null,errorCloseButton:t.closeButton("kv-error-close"),slugCallback:null,dropZoneEnabled:!0,dropZoneTitleClass:"file-drop-zone-title",fileActionSettings:{},otherActionButtons:"",textEncoding:"UTF-8",ajaxSettings:{},ajaxDeleteSettings:{},showAjaxErrorDetails:!0,mergeAjaxCallbacks:!1,mergeAjaxDeleteCallbacks:!1,retryErrorUploads:!0,reversePreviewOrder:!1,usePdfRenderer:function(){var e=!!window.MSInputMethodContext&&!!document.documentMode;return!!navigator.userAgent.match(/(iPod|iPhone|iPad|Android)/i)||e},pdfRendererUrl:"",pdfRendererTemplate:'<iframe class="kv-preview-data file-preview-pdf" src="{renderer}?file={data}" {style}></iframe>'},e.fn.fileinputLocales.en={fileSingle:"file",filePlural:"files",browseLabel:"Browse &hellip;",removeLabel:"Remove",removeTitle:"Clear all unprocessed files",cancelLabel:"Cancel",cancelTitle:"Abort ongoing upload",pauseLabel:"Pause",pauseTitle:"Pause ongoing upload",uploadLabel:"Upload",uploadTitle:"Upload selected files",msgNo:"No",msgNoFilesSelected:"No files selected",msgCancelled:"Cancelled",msgPaused:"Paused",msgPlaceholder:"Select {files}...",msgZoomModalHeading:"Detailed Preview",msgFileRequired:"You must select a file to upload.",msgSizeTooSmall:'File "{name}" (<b>{size} KB</b>) is too small and must be larger than <b>{minSize} KB</b>.',msgSizeTooLarge:'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',msgFilesTooLess:"You must select at least <b>{n}</b> {files} to upload.",msgFilesTooMany:"Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.",msgFileNotFound:'File "{name}" not found!',msgFileSecured:'Security restrictions prevent reading the file "{name}".',msgFileNotReadable:'File "{name}" is not readable.',msgFilePreviewAborted:'File preview aborted for "{name}".',msgFilePreviewError:'An error occurred while reading the file "{name}".',msgInvalidFileName:'Invalid or unsupported characters in file name "{name}".',msgInvalidFileType:'Invalid type for file "{name}". Only "{types}" files are supported.',msgInvalidFileExtension:'Invalid extension for file "{name}". Only "{extensions}" files are supported.',msgFileTypes:{image:"image",html:"HTML",text:"text",video:"video",audio:"audio",flash:"flash",pdf:"PDF",object:"object"},msgUploadAborted:"The file upload was aborted",msgUploadThreshold:"Processing...",msgUploadBegin:"Initializing...",msgUploadEnd:"Done",msgUploadResume:"Resuming upload...",msgUploadEmpty:"No valid data available for upload.",msgUploadError:"Upload Error",msgDeleteError:"Delete Error",msgProgressError:"Error",msgValidationError:"Validation Error",msgLoading:"Loading file {index} of {files} &hellip;",msgProgress:"Loading file {index} of {files} - {name} - {percent}% completed.",msgSelected:"{n} {files} selected",msgFoldersNotAllowed:"Drag & drop files only! {n} folder(s) dropped were skipped.",msgImageWidthSmall:'Width of image file "{name}" must be at least {size} px.',msgImageHeightSmall:'Height of image file "{name}" must be at least {size} px.',msgImageWidthLarge:'Width of image file "{name}" cannot exceed {size} px.',msgImageHeightLarge:'Height of image file "{name}" cannot exceed {size} px.',msgImageResizeError:"Could not get the image dimensions to resize.",msgImageResizeException:"Error while resizing the image.<pre>{errors}</pre>",msgAjaxError:"Something went wrong with the {operation} operation. Please try again later!",msgAjaxProgressError:"{operation} failed",msgDuplicateFile:'File "{name}" of same size "{size} KB" has already been selected earlier. Skipping duplicate selection.',msgResumableUploadRetriesExceeded:"Upload aborted beyond <b>{max}</b> retries for file <b>{file}</b>! Error Details: <pre>{error}</pre>",msgPendingTime:"{time} remaining",msgCalculatingTime:"calculating time remaining",ajaxOperations:{deleteThumb:"file delete",uploadThumb:"file upload",uploadBatch:"batch file upload",uploadExtra:"form data upload"},dropZoneTitle:"Drag & drop files here &hellip;",dropZoneClickTitle:"<br>(or click to select {files})",previewZoomButtonTitles:{prev:"View previous file",next:"View next file",toggleheader:"Toggle header",fullscreen:"Toggle full screen",borderless:"Toggle borderless mode",close:"Close detailed preview"}},e.fn.fileinput.Constructor=i,e(document).ready(function(){var t=e("input.file[type=file]");t.length&&t.fileinput()})}),function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?exports.persianDate=t():e.persianDate=t()}(this,function(){return function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=8)}([function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(4).durationUnit,r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"toPersianDigit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.toString().replace(/\d+/g,function(e){var i=[],a=[],n=void 0,r=void 0;for(n=0;n<e.length;n+=1)i.push(e.charCodeAt(n));for(r=0;r<i.length;r+=1)a.push(String.fromCharCode(i[r]+(t&&!0===t?1584:1728)));return a.join("")})}},{key:"leftZeroFill",value:function(e,t){for(var i=e+"";i.length<t;)i="0"+i;return i}},{key:"normalizeDuration",value:function(){var e=void 0,t=void 0;return"string"==typeof arguments[0]?(e=arguments[0],t=arguments[1]):(t=arguments[0],e=arguments[1]),n.year.indexOf(e)>-1?e="year":n.month.indexOf(e)>-1?e="month":n.day.indexOf(e)>-1?e="day":n.hour.indexOf(e)>-1?e="hour":n.minute.indexOf(e)>-1?e="minute":n.second.indexOf(e)>-1?e="second":n.millisecond.indexOf(e)>-1&&(e="millisecond"),{unit:e,value:t}}},{key:"absRound",value:function(e){return e<0?Math.ceil(e):Math.floor(e)}},{key:"absFloor",value:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)}}]),e}();e.exports=r},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(10),r=i(2),o=i(0),s=i(5),l=(new o).toPersianDigit,d=(new o).leftZeroFill,u=(new o).normalizeDuration,c=i(7),h=i(6),p=function(){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendarType=t.calendarType,this.localType=t.localType,this.leapYearMode=t.leapYearMode,this.algorithms=new r(this),this.version="1.0.5",this._utcMode=!1,"fa"!==this.localType?this.formatPersian=!1:this.formatPersian="_default",this.setup(e),this.ON=this.algorithms.ON,this}return a(t,[{key:"setup",value:function(e){if(n.isDate(e))this._gDateToCalculators(e);else if(n.isArray(e))this.algorithmsCalc([e[0],e[1]?e[1]:1,e[2]?e[2]:1,e[3],e[4],e[5],e[6]?e[6]:0]);else if(n.isNumber(e)){var i=new Date(e);this._gDateToCalculators(i)}else if(e instanceof t)this.algorithmsCalc([e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]);else if(e&&"/Date("===e.substring(0,6)){var a=new Date(parseInt(e.substr(6)));this._gDateToCalculators(a)}else{var r=new Date;this._gDateToCalculators(r)}}},{key:"_getSyncedClass",value:function(e){return new(t.toCalendar(this.calendarType).toLocale(this.localType).toLeapYearMode(this.leapYearMode))(e)}},{key:"_gDateToCalculators",value:function(e){this.algorithms.calcGregorian([e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()])}},{key:"rangeName",value:function(){var e=this.calendarType;return"fa"===this.localType?"persian"===e?c.persian:c.gregorian:"persian"===e?h.persian:h.gregorian}},{key:"toLeapYearMode",value:function(e){return this.leapYearMode=e,"astronomical"===e&&"persian"==this.calendarType?this.leapYearMode="astronomical":"algorithmic"===e&&"persian"==this.calendarType&&(this.leapYearMode="algorithmic"),this.algorithms.updateFromGregorian(),this}},{key:"toCalendar",value:function(e){return this.calendarType=e,this.algorithms.updateFromGregorian(),this}},{key:"toLocale",value:function(e){return this.localType=e,"fa"!==this.localType?this.formatPersian=!1:this.formatPersian="_default",this}},{key:"_locale",value:function(){var e=this.calendarType;return"fa"===this.localType?"persian"===e?c.persian:c.gregorian:"persian"===e?h.persian:h.gregorian}},{key:"_weekName",value:function(e){return this._locale().weekdays[e-1]}},{key:"_weekNameShort",value:function(e){return this._locale().weekdaysShort[e-1]}},{key:"_weekNameMin",value:function(e){return this._locale().weekdaysMin[e-1]}},{key:"_dayName",value:function(e){return this._locale().persianDaysName[e-1]}},{key:"_monthName",value:function(e){return this._locale().months[e-1]}},{key:"_monthNameShort",value:function(e){return this._locale().monthsShort[e-1]}},{key:"isPersianDate",value:function(e){return e instanceof t}},{key:"clone",value:function(){return this._getSyncedClass(this.ON.gDate)}},{key:"algorithmsCalc",value:function(e){return this.isPersianDate(e)&&(e=[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]),"persian"===this.calendarType&&"algorithmic"==this.leapYearMode?this.algorithms.calcPersian(e):"persian"===this.calendarType&&"astronomical"==this.leapYearMode?this.algorithms.calcPersiana(e):"gregorian"===this.calendarType?(e[1]=e[1]-1,this.algorithms.calcGregorian(e)):void 0}},{key:"calendar",value:function(){var e=void 0;return"persian"==this.calendarType?"astronomical"==this.leapYearMode?e="persianAstro":"algorithmic"==this.leapYearMode&&(e="persianAlgo"):e="gregorian",this.ON[e]}},{key:"duration",value:function(e,t){return new s(e,t)}},{key:"isDuration",value:function(e){return e instanceof s}},{key:"years",value:function(e){return this.year(e)}},{key:"year",value:function(e){return e||0===e?(this.algorithmsCalc([e,this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]),this):this.calendar().year}},{key:"month",value:function(e){return e||0===e?(this.algorithmsCalc([this.year(),e,this.date()]),this):this.calendar().month+1}},{key:"days",value:function(){return this.day()}},{key:"day",value:function(){return this.calendar().weekday}},{key:"dates",value:function(e){return this.date(e)}},{key:"date",value:function(e){return e||0===e?(this.algorithmsCalc([this.year(),this.month(),e]),this):this.calendar().day}},{key:"hour",value:function(e){return this.hours(e)}},{key:"hours",value:function(e){return e||0===e?(this.algorithmsCalc([this.year(),this.month(),this.date(),e]),this):this.ON.gDate.getHours()}},{key:"minute",value:function(e){return this.minutes(e)}},{key:"minutes",value:function(e){return e||0===e?(this.algorithmsCalc([this.year(),this.month(),this.date(),this.hour(),e]),this):this.ON.gDate.getMinutes()}},{key:"second",value:function(e){return this.seconds(e)}},{key:"seconds",value:function(e){return e||0===e?(this.algorithmsCalc([this.year(),this.month(),this.date(),this.hour(),this.minute(),e]),this):this.ON.gDate.getSeconds()}},{key:"millisecond",value:function(e){return this.milliseconds(e)}},{key:"milliseconds",value:function(e){return e||0===e?(this.algorithmsCalc([this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),e]),this):this.ON.gregorian.millisecond}},{key:"unix",value:function(e){var t=void 0;if(e)return this._getSyncedClass(1e3*e);var i=this.ON.gDate.valueOf().toString();return t=i.substring(0,i.length-3),parseInt(t)}},{key:"valueOf",value:function(){return this.ON.gDate.valueOf()}},{key:"getFirstWeekDayOfMonth",value:function(e,t){return this._getSyncedClass([e,t,1]).day()}},{key:"diff",value:function(e,t,i){var a=e,n=this.ON.gDate-a.toDate()-0,r=this.year()-a.year(),o=this.month()-a.month(),s=-1*(this.date()-a.date()),l=void 0;return(l="months"===t||"month"===t?12*r+o+s/30:"years"===t||"year"===t?r+(o+s/30)/12:"seconds"===t||"second"===t?n/1e3:"minutes"===t||"minute"===t?n/6e4:"hours"===t||"hour"===t?n/36e5:"days"===t||"day"===t?n/864e5:"weeks"===t||"week"===t?n/6048e5:n)<0&&(l*=-1),i?l:Math.round(l)}},{key:"startOf",value:function(e){var i=t.toCalendar(this.calendarType).toLocale(this.localType);switch(e){case"years":case"year":return new i([this.year(),1,1]);case"months":case"month":return new i([this.year(),this.month(),1]);case"days":case"day":return new i([this.year(),this.month(),this.date(),0,0,0]);case"hours":case"hour":return new i([this.year(),this.month(),this.date(),this.hours(),0,0]);case"minutes":case"minute":return new i([this.year(),this.month(),this.date(),this.hours(),this.minutes(),0]);case"seconds":case"second":return new i([this.year(),this.month(),this.date(),this.hours(),this.minutes(),this.seconds()]);case"weeks":case"week":return new i([this.year(),this.month(),this.date()-(this.calendar().weekday-1)]);default:return this.clone()}}},{key:"endOf",value:function(e){var i=t.toCalendar(this.calendarType).toLocale(this.localType);switch(e){case"years":case"year":var a=this.isLeapYear()?30:29;return new i([this.year(),12,a,23,59,59]);case"months":case"month":var n=this.daysInMonth(this.year(),this.month());return new i([this.year(),this.month(),n,23,59,59]);case"days":case"day":return new i([this.year(),this.month(),this.date(),23,59,59]);case"hours":case"hour":return new i([this.year(),this.month(),this.date(),this.hours(),59,59]);case"minutes":case"minute":return new i([this.year(),this.month(),this.date(),this.hours(),this.minutes(),59]);case"seconds":case"second":return new i([this.year(),this.month(),this.date(),this.hours(),this.minutes(),this.seconds()]);case"weeks":case"week":var r=this.calendar().weekday;return new i([this.year(),this.month(),this.date()+(7-r)]);default:return this.clone()}}},{key:"sod",value:function(){return this.startOf("day")}},{key:"eod",value:function(){return this.endOf("day")}},{key:"zone",value:function(e){return e||0===e?(this.ON.zone=e,this):this.ON.zone}},{key:"local",value:function(){var e=void 0;if(this._utcMode){var i=new Date(this.toDate()).getTimezoneOffset(),a=60*i*1e3;e=i<0?this.valueOf()-a:this.valueOf()+a,this.toCalendar(t.calendarType);var n=new Date(e);return this._gDateToCalculators(n),this._utcMode=!1,this.zone(i),this}return this}},{key:"utc",value:function(e){var t=void 0;if(e)return this._getSyncedClass(e).utc();if(this._utcMode)return this;var i=60*this.zone()*1e3;t=this.zone()<0?this.valueOf()+i:this.valueOf()-i;var a=new Date(t),n=this._getSyncedClass(a);return this.algorithmsCalc(n),this._utcMode=!0,this.zone(0),this}},{key:"isUtc",value:function(){return this._utcMode}},{key:"isDST",value:function(){var e=this.month(),t=this.date();return 1==e&&t>1||6==e&&t<31||e<6&&e>=2}},{key:"isLeapYear",value:function(e){return void 0===e&&(e=this.year()),"persian"==this.calendarType&&"algorithmic"===this.leapYearMode?this.algorithms.leap_persian(e):"persian"==this.calendarType&&"astronomical"===this.leapYearMode?this.algorithms.leap_persiana(e):"gregorian"==this.calendarType?this.algorithms.leap_gregorian(e):void 0}},{key:"daysInMonth",value:function(e,t){var i=e||this.year(),a=t||this.month();return"persian"===this.calendarType?a<1||a>12?0:a<7?31:a<12?30:this.isLeapYear(i)?30:29:"gregorian"===this.calendarType?new Date(i,a,0).getDate():void 0}},{key:"toDate",value:function(){return this.ON.gDate}},{key:"toArray",value:function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]}},{key:"formatNumber",value:function(){var t=void 0;return"_default"===this.formatPersian?t=void 0!==e&&void 0!==e.exports?!1!==this.formatPersian:!1!==window.formatPersian:!0===this.formatPersian?t=!0:!1===this.formatPersian?t=!1:Error('Invalid Config "formatPersian" !!'),t}},{key:"format",value:function(e){var t=this,i=/([[^[]*])|(\\)?(Mo|MM?M?M?|Do|DD?D?D?|dddddd?|ddddd?|dddd?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?|X|LT|ll?l?l?|LL?L?L?)/g,a={year:t.year(),month:t.month(),hour:t.hours(),minute:t.minutes(),second:t.seconds(),date:t.date(),timezone:t.zone(),unix:t.unix()},n=t.formatNumber(),r=function(e){return n?l(e):e};function o(e){switch(e){case"a":return n?a.hour>=12?" ":" ":a.hour>=12?"PM":"AM";case"H":return r(a.hour);case"HH":return r(d(a.hour,2));case"h":return r(a.hour%12);case"hh":return r(d(a.hour%12,2));case"m":case"mm":return r(d(a.minute,2));case"s":return r(a.second);case"ss":return r(d(a.second,2));case"D":return r(d(a.date));case"DD":return r(d(a.date,2));case"DDD":var i=t.startOf("year");return r(d(t.diff(i,"days"),3));case"DDDD":var o=t.startOf("year");return r(d(t.diff(o,"days"),3));case"d":return r(t.calendar().weekday);case"ddd":return t._weekNameShort(t.calendar().weekday);case"dddd":return t._weekName(t.calendar().weekday);case"ddddd":return t._dayName(t.calendar().day);case"dddddd":return t._weekNameMin(t.calendar().weekday);case"w":var s=t.startOf("year"),l=parseInt(t.diff(s,"days")/7)+1;return r(l);case"ww":var u=t.startOf("year"),c=d(parseInt(t.diff(u,"days")/7)+1,2);return r(c);case"M":return r(a.month);case"MM":return r(d(a.month,2));case"MMM":return t._monthNameShort(a.month);case"MMMM":return t._monthName(a.month);case"YY":var h=a.year.toString().split("");return r(h[2]+h[3]);case"YYYY":return r(a.year);case"Z":var p="+",f=Math.round(a.timezone/60),m=a.timezone%60;m<0&&(m*=-1),f<0&&(p="-",f*=-1);var v=p+d(f,2)+":"+d(m,2);return r(v);case"ZZ":var g="+",w=Math.round(a.timezone/60),y=a.timezone%60;y<0&&(y*=-1),w<0&&(g="-",w*=-1);var b=g+d(w,2)+""+d(y,2);return r(b);case"X":return t.unix();case"LT":return t.format("H:m a");case"L":return t.format("YYYY/MM/DD");case"l":return t.format("YYYY/M/D");case"LL":return t.format("MMMM DD YYYY");case"ll":return t.format("MMM DD YYYY");case"LLL":return t.format("MMMM YYYY DD   H:m  a");case"lll":return t.format("MMM YYYY DD   H:m  a");case"LLLL":return t.format("dddd D MMMM YYYY  H:m  a");case"llll":return t.format("ddd D MMM YYYY  H:m  a")}}if(e)return e.replace(i,o);return"YYYY-MM-DD HH:mm:ss a".replace(i,o)}},{key:"add",value:function(e,t){var i=new s(e,t)._data,a=u(e,t).unit;if(t=u(e,t).value,"year"===a||"month"===a){if(i.years>0){var n=this.year()+i.years;this.year(n)}if(i.months>0){var r=this.date(),o=this.month()+i.months,l=this.daysInMonth(this.year(),o);r>=l&&(r=l),this.date(r),this.month(o)}}if("day"===a){var d=this.hour(),c=this.valueOf()+24*t*60*60*1e3;return this.unix(c/1e3).hour(d)}if("hour"===a){var h=this.valueOf()+60*t*60*1e3;return this.unix(h/1e3)}if("minute"===a){var p=this.valueOf()+60*t*1e3;return this.unix(p/1e3)}if("second"===a){var f=this.valueOf()+1e3*t;return this.unix(f/1e3)}if("millisecond"===a){var m=this.valueOf()+t;return this.unix(m/1e3)}return this._getSyncedClass(this.valueOf())}},{key:"subtract",value:function(e,t){var i=new s(e,t)._data,a=u(e,t).unit;if(t=u(e,t).value,"year"===a||"month"===a){if(i.years>0){var n=this.year()-i.years;this.year(n)}if(i.months>0){var r=this.date(),o=this.month()-i.months;this.month(o);var l=this.daysInMonth(this.year(),this.month());r>l&&(r=l),this.date(r)}}if("day"===a){var d=this.hour(),c=this.valueOf()-24*t*60*60*1e3;return this.unix(c/1e3).hour(d)}if("hour"===a){var h=this.valueOf()-60*t*60*1e3;return this.unix(h/1e3)}if("minute"===a){var p=this.valueOf()-60*t*1e3;return this.unix(p/1e3)}if("second"===a){var f=this.valueOf()-1e3*t;return this.unix(f/1e3)}if("millisecond"===a){var m=this.valueOf()-t;return this.unix(m/1e3)}return this._getSyncedClass(this.valueOf())}},{key:"isSameDay",value:function(e){return this&&e&&this.date()==e.date()&&this.year()==e.year()&&this.month()==e.month()}},{key:"isSameMonth",value:function(e){return this&&e&&this.year()==this.year()&&this.month()==e.month()}}],[{key:"rangeName",value:function(){var e=t,i=e.calendarType;return"fa"===e.localType?"persian"===i?c.persian:c.gregorian:"persian"===i?h.persian:h.gregorian}},{key:"toLeapYearMode",value:function(e){var i=t;return i.leapYearMode=e,i}},{key:"toCalendar",value:function(e){var i=t;return i.calendarType=e,i}},{key:"toLocale",value:function(e){var i=t;return i.localType=e,"fa"!==i.localType?i.formatPersian=!1:i.formatPersian="_default",i}},{key:"isPersianDate",value:function(e){return e instanceof t}},{key:"duration",value:function(e,t){return new s(e,t)}},{key:"isDuration",value:function(e){return e instanceof s}},{key:"unix",value:function(e){return e?new t(1e3*e):(new t).unix()}},{key:"getFirstWeekDayOfMonth",value:function(e,i){return new t([e,i,1]).day()}},{key:"utc",value:function(e){return e?new t(e).utc():(new t).utc()}},{key:"isSameDay",value:function(e,t){return e&&t&&e.date()==t.date()&&e.year()==t.year()&&e.month()==t.month()}},{key:"isSameMonth",value:function(e,t){return e&&t&&e.year()==t.year()&&e.month()==t.month()}}]),t}();e.exports=p},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(3),r=i(9),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=t,this.ASTRO=new n,this.ON=new r,this.J0000=1721424.5,this.J1970=2440587.5,this.JMJD=2400000.5,this.NormLeap=[!1,!0],this.GREGORIAN_EPOCH=1721425.5,this.PERSIAN_EPOCH=1948320.5}return a(e,[{key:"leap_gregorian",value:function(e){return e%4==0&&!(e%100==0&&e%400!=0)}},{key:"gregorian_to_jd",value:function(e,t,i){return this.GREGORIAN_EPOCH-1+365*(e-1)+Math.floor((e-1)/4)+-Math.floor((e-1)/100)+Math.floor((e-1)/400)+Math.floor((367*t-362)/12+(t<=2?0:this.leap_gregorian(e)?-1:-2)+i)}},{key:"jd_to_gregorian",value:function(e){var t,i,a,n,r,o,s,l,d,u,c,h,p=void 0;return i=(t=Math.floor(e-.5)+.5)-this.GREGORIAN_EPOCH,a=Math.floor(i/146097),n=this.ASTRO.mod(i,146097),r=Math.floor(n/36524),o=this.ASTRO.mod(n,36524),s=Math.floor(o/1461),l=this.ASTRO.mod(o,1461),p=400*a+100*r+4*s+(d=Math.floor(l/365)),4!==r&&4!==d&&p++,u=t-this.gregorian_to_jd(p,1,1),c=t<this.gregorian_to_jd(p,3,1)?0:this.leap_gregorian(p)?1:2,[p,h=Math.floor((12*(u+c)+373)/367),t-this.gregorian_to_jd(p,h,1)+1]}},{key:"tehran_equinox",value:function(e){var t;return 52.5/360,(t=this.ASTRO.equinox(e,0))-this.ASTRO.deltat(e)/86400+this.ASTRO.equationOfTime(t)+52.5/360}},{key:"tehran_equinox_jd",value:function(e){var t;return t=this.tehran_equinox(e),Math.floor(t)}},{key:"persiana_year",value:function(e){var t=this.jd_to_gregorian(e)[0]-2,i=void 0,a=void 0;for(i=this.tehran_equinox_jd(t);i>e;)t--,i=this.tehran_equinox_jd(t);for(a=i-1;!(i<=e&&e<a);)i=a,t++,a=this.tehran_equinox_jd(t);return[Math.round((i-this.PERSIAN_EPOCH)/this.ASTRO.TropicalYear)+1,i]}},{key:"jd_to_persiana",value:function(e){var t,i,a,n,r;return e=Math.floor(e)+.5,t=(a=this.persiana_year(e))[0],n=a[1],Math.floor((e-n)/30)+1,[t,i=(r=Math.floor(e)-this.persiana_to_jd(t,1,1)+1)<=186?Math.ceil(r/31):Math.ceil((r-6)/30),Math.floor(e)-this.persiana_to_jd(t,i,1)+1]}},{key:"persiana_to_jd",value:function(e,t,i){var a=void 0,n=void 0;for(n=this.PERSIAN_EPOCH-1+this.ASTRO.TropicalYear*(e-1-1),a=[e-1,0];a[0]<e;)n=(a=this.persiana_year(n))[1]+(this.ASTRO.TropicalYear+2);return a[1]+(t<=7?31*(t-1):30*(t-1)+6)+(i-1)}},{key:"leap_persiana",value:function(e){return this.persiana_to_jd(e+1,1,1)-this.persiana_to_jd(e,1,1)>365}},{key:"leap_persian",value:function(e){return 682*((e-(e>0?474:473))%2820+474+38)%2816<682}},{key:"persian_to_jd",value:function(e,t,i){var a,n;return a=e-(e>=0?474:473),n=474+this.ASTRO.mod(a,2820),i+(t<=7?31*(t-1):30*(t-1)+6)+Math.floor((682*n-110)/2816)+365*(n-1)+1029983*Math.floor(a/2820)+(this.PERSIAN_EPOCH-1)}},{key:"jd_to_persian",value:function(e){var t,i,a,n,r,o=void 0,s=void 0,l=void 0,d=void 0;return i=(e=Math.floor(e)+.5)-this.persian_to_jd(475,1,1),a=Math.floor(i/1029983),1029982===(n=this.ASTRO.mod(i,1029983))?s=2820:(l=Math.floor(n/366),d=this.ASTRO.mod(n,366),s=Math.floor((2134*l+2816*d+2815)/1028522)+l+1),(o=s+2820*a+474)<=0&&o--,[o,t=(r=e-this.persian_to_jd(o,1,1)+1)<=186?Math.ceil(r/31):Math.ceil((r-6)/30),e-this.persian_to_jd(o,t,1)+1]}},{key:"gWeekDayToPersian",value:function(e){return e+2===8?1:e+2===7?7:e+2}},{key:"updateFromGregorian",value:function(){var e,t,i,a,n,r=void 0,o=void 0;t=this.ON.gregorian.year,i=this.ON.gregorian.month,a=this.ON.gregorian.day,this.ON.gDate=new Date(t,i,a,this.ON.gregorian.hour,this.ON.gregorian.minute,this.ON.gregorian.second,this.ON.gregorian.millisecond),!1===this.parent._utcMode&&(this.ON.zone=this.ON.gDate.getTimezoneOffset()),this.ON.gregorian.year=this.ON.gDate.getFullYear(),this.ON.gregorian.month=this.ON.gDate.getMonth(),this.ON.gregorian.day=this.ON.gDate.getDate(),e=this.gregorian_to_jd(t,i+1,a)+Math.floor(.5)/86400,this.ON.julianday=e,this.ON.modifiedjulianday=e-this.JMJD,r=this.ASTRO.jwday(e),this.ON.gregorian.weekday=r+1,this.ON.gregorian.leap=this.NormLeap[this.leap_gregorian(t)?1:0],r=this.ASTRO.jwday(e),"persian"==this.parent.calendarType&&"algorithmic"==this.parent.leapYearMode&&(o=this.jd_to_persian(e),this.ON.persian.year=o[0],this.ON.persian.month=o[1]-1,this.ON.persian.day=o[2],this.ON.persian.weekday=this.gWeekDayToPersian(r),this.ON.persian.leap=this.NormLeap[this.leap_persian(o[0])?1:0]),"persian"==this.parent.calendarType&&"astronomical"==this.parent.leapYearMode&&(o=this.jd_to_persiana(e),this.ON.persianAstro.year=o[0],this.ON.persianAstro.month=o[1]-1,this.ON.persianAstro.day=o[2],this.ON.persianAstro.weekday=this.gWeekDayToPersian(r),this.ON.persianAstro.leap=this.NormLeap[this.leap_persiana(o[0])?1:0]),null!==this.ON.gregserial.day&&(this.ON.gregserial.day=e-this.J0000),n=864e5*(e-this.J1970),this.ON.unixtime=Math.round(n/1e3)}},{key:"calcGregorian",value:function(e){(e[0]||0===e[0])&&(this.ON.gregorian.year=e[0]),(e[1]||0===e[1])&&(this.ON.gregorian.month=e[1]),(e[2]||0===e[2])&&(this.ON.gregorian.day=e[2]),(e[3]||0===e[3])&&(this.ON.gregorian.hour=e[3]),(e[4]||0===e[4])&&(this.ON.gregorian.minute=e[4]),(e[5]||0===e[5])&&(this.ON.gregorian.second=e[5]),(e[6]||0===e[6])&&(this.ON.gregorian.millisecond=e[6]),this.updateFromGregorian()}},{key:"calcJulian",value:function(){var e,t;e=this.ON.julianday,t=this.jd_to_gregorian(e),this.ON.gregorian.year=t[0],this.ON.gregorian.month=t[1]-1,this.ON.gregorian.day=t[2],this.updateFromGregorian()}},{key:"setJulian",value:function(e){this.ON.julianday=e,this.calcJulian()}},{key:"calcPersian",value:function(e){e[0]&&(this.ON.persian.year=e[0]),e[1]&&(this.ON.persian.month=e[1]),e[2]&&(this.ON.persian.day=e[2]),e[3]&&(this.ON.gregorian.hour=e[3]),e[4]&&(this.ON.gregorian.minute=e[4]),e[5]&&(this.ON.gregorian.second=e[5]),e[6]&&(this.ON.gregorian.millisecond=e[6]),this.setJulian(this.persian_to_jd(this.ON.persian.year,this.ON.persian.month,this.ON.persian.day))}},{key:"calcPersiana",value:function(e){e[0]&&(this.ON.persianAstro.year=e[0]),e[1]&&(this.ON.persianAstro.month=e[1]),e[2]&&(this.ON.persianAstro.day=e[2]),e[3]&&(this.ON.gregorian.hour=e[3]),e[4]&&(this.ON.gregorian.minute=e[4]),e[5]&&(this.ON.gregorian.second=e[5]),e[6]&&(this.ON.gregorian.millisecond=e[6]),this.setJulian(this.persiana_to_jd(this.ON.persianAstro.year,this.ON.persianAstro.month,this.ON.persianAstro.day+.5))}}]),e}();e.exports=o},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.J2000=2451545,this.JulianCentury=36525,this.JulianMillennium=10*this.JulianCentury,this.TropicalYear=365.24219878,this.oterms=[-4680.93,-1.55,1999.25,-51.38,-249.67,-39.05,7.12,27.87,5.79,2.45],this.nutArgMult=[0,0,0,0,1,-2,0,0,2,2,0,0,0,2,2,0,0,0,0,2,0,1,0,0,0,0,0,1,0,0,-2,1,0,2,2,0,0,0,2,1,0,0,1,2,2,-2,-1,0,2,2,-2,0,1,0,0,-2,0,0,2,1,0,0,-1,2,2,2,0,0,0,0,0,0,1,0,1,2,0,-1,2,2,0,0,-1,0,1,0,0,1,2,1,-2,0,2,0,0,0,0,-2,2,1,2,0,0,2,2,0,0,2,2,2,0,0,2,0,0,-2,0,1,2,2,0,0,0,2,0,-2,0,0,2,0,0,0,-1,2,1,0,2,0,0,0,2,0,-1,0,1,-2,2,0,2,2,0,1,0,0,1,-2,0,1,0,1,0,-1,0,0,1,0,0,2,-2,0,2,0,-1,2,1,2,0,1,2,2,0,1,0,2,2,-2,1,1,0,0,0,-1,0,2,2,2,0,0,2,1,2,0,1,0,0,-2,0,2,2,2,-2,0,1,2,1,2,0,-2,0,1,2,0,0,0,1,0,-1,1,0,0,-2,-1,0,2,1,-2,0,0,0,1,0,0,2,2,1,-2,0,2,0,1,-2,1,0,2,1,0,0,1,-2,0,-1,0,1,0,0,-2,1,0,0,0,1,0,0,0,0,0,0,1,2,0,-1,-1,1,0,0,0,1,1,0,0,0,-1,1,2,2,2,-1,-1,2,2,0,0,-2,2,2,0,0,3,2,2,2,-1,0,2,2],this.nutArgCoeff=[-171996,-1742,92095,89,-13187,-16,5736,-31,-2274,-2,977,-5,2062,2,-895,5,1426,-34,54,-1,712,1,-7,0,-517,12,224,-6,-386,-4,200,0,-301,0,129,-1,217,-5,-95,3,-158,0,0,0,129,1,-70,0,123,0,-53,0,63,0,0,0,63,1,-33,0,-59,0,26,0,-58,-1,32,0,-51,0,27,0,48,0,0,0,46,0,-24,0,-38,0,16,0,-31,0,13,0,29,0,0,0,29,0,-12,0,26,0,0,0,-22,0,0,0,21,0,-10,0,17,-1,0,0,16,0,-8,0,-16,1,7,0,-15,0,9,0,-13,0,7,0,-12,0,6,0,11,0,0,0,-10,0,5,0,-8,0,3,0,7,0,-3,0,-7,0,0,0,-7,0,3,0,-7,0,3,0,6,0,0,0,6,0,-3,0,6,0,-3,0,-6,0,3,0,-6,0,3,0,5,0,0,0,-5,0,3,0,-5,0,3,0,-5,0,3,0,4,0,0,0,4,0,0,0,4,0,0,0,-4,0,0,0,-4,0,0,0,-4,0,0,0,3,0,0,0,-3,0,0,0,-3,0,0,0,-3,0,0,0,-3,0,0,0,-3,0,0,0,-3,0,0,0,-3,0,0,0],this.deltaTtab=[121,112,103,95,88,82,77,72,68,63,60,56,53,51,48,46,44,42,40,38,35,33,31,29,26,24,22,20,18,16,14,12,11,10,9,8,7,7,7,7,7,7,8,8,9,9,9,9,9,10,10,10,10,10,10,10,10,11,11,11,11,11,12,12,12,12,13,13,13,14,14,14,14,15,15,15,15,15,16,16,16,16,16,16,16,16,15,15,14,13,13.1,12.5,12.2,12,12,12,12,12,12,11.9,11.6,11,10.2,9.2,8.2,7.1,6.2,5.6,5.4,5.3,5.4,5.6,5.9,6.2,6.5,6.8,7.1,7.3,7.5,7.6,7.7,7.3,6.2,5.2,2.7,1.4,-1.2,-2.8,-3.8,-4.8,-5.5,-5.3,-5.6,-5.7,-5.9,-6,-6.3,-6.5,-6.2,-4.7,-2.8,-.1,2.6,5.3,7.7,10.4,13.3,16,18.2,20.2,21.1,22.4,23.5,23.8,24.3,24,23.9,23.9,23.7,24,24.3,25.3,26.2,27.3,28.2,29.1,30,30.7,31.4,32.2,33.1,34,35,36.5,38.3,40.2,42.2,44.5,46.5,48.5,50.5,52.2,53.8,54.9,55.8,56.9,58.3,60,61.6,63,65,66.6],this.EquinoxpTerms=[485,324.96,1934.136,203,337.23,32964.467,199,342.08,20.186,182,27.85,445267.112,156,73.14,45036.886,136,171.52,22518.443,77,222.54,65928.934,74,296.72,3034.906,70,243.58,9037.513,58,119.81,33718.147,52,297.17,150.678,50,21.02,2281.226,45,247.54,29929.562,44,325.15,31555.956,29,60.93,4443.417,18,155.12,67555.328,17,288.79,4562.452,16,198.04,62894.029,14,199.76,31436.921,12,95.39,14577.848,12,287.11,31931.756,12,320.81,34777.259,9,227.73,1222.114,8,15.45,16859.074],this.JDE0tab1000=[new Array(1721139.29189,365242.1374,.06134,.00111,-71e-5),new Array(1721233.25401,365241.72562,-.05323,.00907,25e-5),new Array(1721325.70455,365242.49558,-.11677,-.00297,74e-5),new Array(1721414.39987,365242.88257,-.00769,-.00933,-6e-5)],this.JDE0tab2000=[new Array(2451623.80984,365242.37404,.05169,-.00411,-57e-5),new Array(2451716.56767,365241.62603,.00325,.00888,-3e-4),new Array(2451810.21715,365242.01767,-.11575,.00337,78e-5),new Array(2451900.05952,365242.74049,-.06223,-.00823,32e-5)]}return a(e,[{key:"dtr",value:function(e){return e*Math.PI/180}},{key:"rtd",value:function(e){return 180*e/Math.PI}},{key:"fixangle",value:function(e){return e-360*Math.floor(e/360)}},{key:"fixangr",value:function(e){return e-2*Math.PI*Math.floor(e/(2*Math.PI))}},{key:"dsin",value:function(e){return Math.sin(this.dtr(e))}},{key:"dcos",value:function(e){return Math.cos(this.dtr(e))}},{key:"mod",value:function(e,t){return e-t*Math.floor(e/t)}},{key:"jwday",value:function(e){return this.mod(Math.floor(e+1.5),7)}},{key:"obliqeq",value:function(e){var t,i,a,n;if(a=i=(e-this.J2000)/(100*this.JulianCentury),t=23.43929111111111,Math.abs(i)<1)for(n=0;n<10;n++)t+=this.oterms[n]/3600*a,a*=i;return t}},{key:"nutation",value:function(e){var t,i,a,n,r,o,s=(e-2451545)/36525,l=[],d=0,u=0;for(n=s*(a=s*s),l[0]=this.dtr(297.850363+445267.11148*s-.0019142*a+n/189474),l[1]=this.dtr(357.52772+35999.05034*s-1603e-7*a-n/3e5),l[2]=this.dtr(134.96298+477198.867398*s+.0086972*a+n/56250),l[3]=this.dtr(93.27191+483202.017538*s-.0036825*a+n/327270),l[4]=this.dtr(125.04452-1934.136261*s+.0020708*a+n/45e4),t=0;t<5;t++)l[t]=this.fixangr(l[t]);for(r=s/10,t=0;t<63;t++){for(o=0,i=0;i<5;i++)0!==this.nutArgMult[5*t+i]&&(o+=this.nutArgMult[5*t+i]*l[i]);d+=(this.nutArgCoeff[4*t+0]+this.nutArgCoeff[4*t+1]*r)*Math.sin(o),u+=(this.nutArgCoeff[4*t+2]+this.nutArgCoeff[4*t+3]*r)*Math.cos(o)}return[d/36e6,u/36e6]}},{key:"deltat",value:function(e){var t,i,a,n;return e>=1620&&e<=2e3?(i=(e-1620)/2-(a=Math.floor((e-1620)/2)),t=this.deltaTtab[a]+(this.deltaTtab[a+1]-this.deltaTtab[a])*i):(n=(e-2e3)/100,e<948?t=2177+497*n+44.1*n*n:(t=102+102*n+25.3*n*n,e>2e3&&e<2100&&(t+=.37*(e-2100)))),t}},{key:"equinox",value:function(e,t){var i,a,n,r,o=void 0,s=void 0,l=void 0,d=void 0,u=void 0;for(e<1e3?(l=this.JDE0tab1000,u=e/1e3):(l=this.JDE0tab2000,u=(e-2e3)/1e3),r=35999.373*(n=((a=l[t][0]+l[t][1]*u+l[t][2]*u*u+l[t][3]*u*u*u+l[t][4]*u*u*u*u)-2451545)/36525)-2.47,i=1+.0334*this.dcos(r)+7e-4*this.dcos(2*r),d=0,o=s=0;o<24;o++)d+=this.EquinoxpTerms[s]*this.dcos(this.EquinoxpTerms[s+1]+this.EquinoxpTerms[s+2]*n),s+=3;return a+1e-5*d/i}},{key:"sunpos",value:function(e){var t,i,a,n,r,o,s,l,d,u,c,h,p=void 0,f=void 0,m=void 0,v=void 0;return p=280.46646+36000.76983*(t=(e-this.J2000)/this.JulianCentury)+3032e-7*(i=t*t),p=this.fixangle(p),f=357.52911+35999.05029*t+-1537e-7*i,f=this.fixangle(f),a=.016708634+-42037e-9*t+-1.267e-7*i,r=p+(n=(1.914602+-.004817*t+-14e-6*i)*this.dsin(f)+(.019993-101e-6*t)*this.dsin(2*f)+289e-6*this.dsin(3*f)),o=f+n,s=1.000001018*(1-a*a)/(1+a*this.dcos(o)),l=125.04-1934.136*t,d=r+-.00569+-.00478*this.dsin(l),u=(c=this.obliqeq(e))+.00256*this.dcos(l),m=this.rtd(Math.atan2(this.dcos(c)*this.dsin(r),this.dcos(r))),m=this.fixangle(m),h=this.rtd(Math.asin(this.dsin(c)*this.dsin(r))),v=this.rtd(Math.atan2(this.dcos(u)*this.dsin(d),this.dcos(d))),[p,f,a,n,r,o,s,d,m,h,v=this.fixangle(v),this.rtd(Math.asin(this.dsin(u)*this.dsin(d)))]}},{key:"equationOfTime",value:function(e){var t,i,a,n,r=void 0,o=void 0;return o=280.4664567+360007.6982779*(n=(e-this.J2000)/this.JulianMillennium)+.03032028*n*n+n*n*n/49931+-n*n*n*n/15300+-n*n*n*n*n/2e6,o=this.fixangle(o),t=this.sunpos(e)[10],i=this.nutation(e)[0],a=this.obliqeq(e)+this.nutation(e)[1],r=o+-.0057183+-t+i*this.dcos(a),r-=20*Math.floor(r/20),r/=1440}}]),e}();e.exports=n},function(e,t,i){"use strict";e.exports={durationUnit:{year:["y","years","year"],month:["M","months","month"],day:["d","days","day"],hour:["h","hours","hour"],minute:["m","minutes","minute"],second:["s","second","seconds"],millisecond:["ms","milliseconds","millisecond"],week:["w","","weeks","week"]}}},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(0),r=(new n).normalizeDuration,o=(new n).absRound,s=(new n).absFloor,l=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a,n={},l=this._data={},d=r(t,i);n[d.unit]=d.value,a=n.milliseconds||n.millisecond||n.ms||0;var u=n.years||n.year||n.y||0,c=n.months||n.month||n.M||0,h=n.weeks||n.w||n.week||0,p=n.days||n.d||n.day||0,f=n.hours||n.hour||n.h||0,m=n.minutes||n.minute||n.m||0,v=n.seconds||n.second||n.s||0;return this._milliseconds=a+1e3*v+6e4*m+36e5*f,this._days=p+7*h,this._months=c+12*u,l.milliseconds=a%1e3,v+=s(a/1e3),l.seconds=v%60,m+=o(v/60),l.minutes=m%60,f+=o(m/60),l.hours=f%24,p+=o(f/24),p+=7*h,l.days=p%30,c+=o(p/30),l.months=c%12,u+=o(c/12),l.years=u,this}return a(e,[{key:"valueOf",value:function(){return this._milliseconds+864e5*this._days+2592e6*this._months}}]),e}();e.exports=l},function(e,t,i){"use strict";e.exports={gregorian:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysMin:["Su","Mo","Tu","We","Th","Fr","Sa"]},persian:{months:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Dey","Bahman","Esfand"],monthsShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Dey","Bah","Esf"],weekdays:["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],persianDaysName:["Urmazd","Bahman","Ordibehesht","Shahrivar","Sepandarmaz","Khurdad","Amordad","Dey-be-azar","Azar","Aban","Khorshid","Mah","Tir","Gush","Dey-be-mehr","Mehr","Sorush","Rashn","Farvardin","Bahram","Ram","Bad","Dey-be-din","Din","Ord","Ashtad","Asman","Zamyad","Mantre-sepand","Anaram","Ziadi"]}}},function(e,t,i){"use strict";e.exports={gregorian:{months:"___________".split("_"),monthsShort:"___________".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_")},persian:{months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],weekdays:["","",""," "," ","",""],weekdaysShort:["","","","","","",""],weekdaysMin:["","","","","","",""],persianDaysName:["","","","","","","","  ","","","","","","","  ","","","","","","","","  ","","","","",""," ","",""]}}},function(e,t,i){"use strict";var a=i(1);a.calendarType="persian",a.leapYearMode="astronomical",a.localType="fa",e.exports=a},function(e,t,i){"use strict";e.exports=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gDate=null,this.modifiedjulianday=0,this.julianday=0,this.gregserial={day:0},this.zone=0,this.gregorian={year:0,month:0,day:0,hour:0,minute:0,second:0,millisecond:0,weekday:0,unix:0,leap:0},this.juliancalendar={year:0,month:0,day:0,leap:0,weekday:0},this.islamic={year:0,month:0,day:0,leap:0,weekday:0},this.persianAlgo=this.persian={year:0,month:0,day:0,leap:0,weekday:0},this.persianAstro={year:0,month:0,day:0,leap:0,weekday:0},this.isoweek={year:0,week:0,day:0},this.isoday={year:0,day:0}}},function(e,t,i){"use strict";e.exports={isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isNumber:function(e){return"number"==typeof e},isDate:function(e){return e instanceof Date}}}])}),function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?exports.persianDatepicker=t():e.persianDatepicker=t()}(this,function(){return function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=5)}([function(e,t,i){"use strict";var a,n,r={debounce:function(e,t,i){var a;return function(){var n=this,r=arguments,o=i&&!a;clearTimeout(a),a=setTimeout(function(){a=null,i||e.apply(n,r)},t),o&&e.apply(n,r)}},log:function(e){console.log(e)},isMobile:(n=!1,a=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(n=!0),n),debug:function(e,t){window.persianDatepickerDebug&&(e.constructor.name?console.log("Debug: "+e.constructor.name+" : "+t):console.log("Debug: "+t))},delay:function(e,t){clearTimeout(window.datepickerTimer),window.datepickerTimer=setTimeout(e,t)}};e.exports=r},function(e,t,i){"use strict";e.exports='\n<div id="plotId" class="datepicker-plot-area {{cssClass}}">\n    {{#navigator.enabled}}\n        <div data-navigator class="datepicker-navigator">\n            <div class="pwt-btn pwt-btn-next">{{navigator.text.btnNextText}}</div>\n            <div class="pwt-btn pwt-btn-switch">{{navigator.switch.text}}</div>\n            <div class="pwt-btn pwt-btn-prev">{{navigator.text.btnPrevText}}</div>\n        </div>\n    {{/navigator.enabled}}\n    <div class="datepicker-grid-view" >\n    {{#days.enabled}}\n        {{#days.viewMode}}\n        <div class="datepicker-day-view" >    \n            <div class="month-grid-box">\n                <div class="header">\n                    <div class="title"></div>\n                    <div class="header-row">\n                        {{#weekdays.list}}\n                            <div class="header-row-cell">{{.}}</div>\n                        {{/weekdays.list}}\n                    </div>\n                </div>    \n                <table cellspacing="0" class="table-days">\n                    <tbody>\n                        {{#days.list}}\n                           \n                            <tr>\n                                {{#.}}\n                                    {{#enabled}}\n                                        <td data-date="{{dataDate}}" data-unix="{{dataUnix}}" >\n                                            <span  class="{{#otherMonth}}other-month{{/otherMonth}}">{{title}}</span>\n                                            {{#altCalendarShowHint}}\n                                            <i  class="alter-calendar-day">{{alterCalTitle}}</i>\n                                            {{/altCalendarShowHint}}\n                                        </td>\n                                    {{/enabled}}\n                                    {{^enabled}}\n                                        <td data-date="{{dataDate}}" data-unix="{{dataUnix}}" class="disabled">\n                                            <span class="{{#otherMonth}}other-month{{/otherMonth}}">{{title}}</span>\n                                            {{#altCalendarShowHint}}\n                                            <i  class="alter-calendar-day">{{alterCalTitle}}</i>\n                                            {{/altCalendarShowHint}}\n                                        </td>\n                                    {{/enabled}}\n                                    \n                                {{/.}}\n                            </tr>\n                        {{/days.list}}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n        {{/days.viewMode}}\n    {{/days.enabled}}\n    \n    {{#month.enabled}}\n        {{#month.viewMode}}\n            <div class="datepicker-month-view">\n                {{#month.list}}\n                    {{#enabled}}               \n                        <div data-month="{{dataMonth}}" class="month-item {{#selected}}selected{{/selected}}">{{title}}</small></div>\n                    {{/enabled}}\n                    {{^enabled}}               \n                        <div data-month="{{dataMonth}}" class="month-item month-item-disable {{#selected}}selected{{/selected}}">{{title}}</small></div>\n                    {{/enabled}}\n                {{/month.list}}\n            </div>\n        {{/month.viewMode}}\n    {{/month.enabled}}\n    \n    {{#year.enabled }}\n        {{#year.viewMode }}\n            <div class="datepicker-year-view" >\n                {{#year.list}}\n                    {{#enabled}}\n                        <div data-year="{{dataYear}}" class="year-item {{#selected}}selected{{/selected}}">{{title}}</div>\n                    {{/enabled}}\n                    {{^enabled}}\n                        <div data-year="{{dataYear}}" class="year-item year-item-disable {{#selected}}selected{{/selected}}">{{title}}</div>\n                    {{/enabled}}                    \n                {{/year.list}}\n            </div>\n        {{/year.viewMode }}\n    {{/year.enabled }}\n    \n    </div>\n    {{#time}}\n    {{#enabled}}\n    <div class="datepicker-time-view">\n        {{#hour.enabled}}\n            <div class="hour time-segment" data-time-key="hour">\n                <div class="up-btn" data-time-key="hour"></div>\n                <input disabled value="{{hour.title}}" type="text" placeholder="hour" class="hour-input">\n                <div class="down-btn" data-time-key="hour"></div>                    \n            </div>       \n            <div class="divider">\n                <span>:</span>\n            </div>\n        {{/hour.enabled}}\n        {{#minute.enabled}}\n            <div class="minute time-segment" data-time-key="minute" >\n                <div class="up-btn" data-time-key="minute"></div>\n                <input disabled value="{{minute.title}}" type="text" placeholder="minute" class="minute-input">\n                <div class="down-btn" data-time-key="minute"></div>\n            </div>        \n            <div class="divider second-divider">\n                <span>:</span>\n            </div>\n        {{/minute.enabled}}\n        {{#second.enabled}}\n            <div class="second time-segment" data-time-key="second"  >\n                <div class="up-btn" data-time-key="second" ></div>\n                <input disabled value="{{second.title}}"  type="text" placeholder="second" class="second-input">\n                <div class="down-btn" data-time-key="second" ></div>\n            </div>\n            <div class="divider meridian-divider"></div>\n            <div class="divider meridian-divider"></div>\n        {{/second.enabled}}\n        {{#meridian.enabled}}\n            <div class="meridian time-segment" data-time-key="meridian" >\n                <div class="up-btn" data-time-key="meridian"></div>\n                <input disabled value="{{meridian.title}}" type="text" class="meridian-input">\n                <div class="down-btn" data-time-key="meridian"></div>\n            </div>\n        {{/meridian.enabled}}\n    </div>\n    {{/enabled}}\n    {{/time}}\n    \n    {{#toolbox}}\n    {{#enabled}}\n    <div class="toolbox">\n        {{#toolbox.submitButton.enabled}}\n            <div class="pwt-btn-submit">{{submitButtonText}}</div>\n        {{/toolbox.submitButton.enabled}}        \n        {{#toolbox.todayButton.enabled}}\n            <div class="pwt-btn-today">{{todayButtonText}}</div>\n        {{/toolbox.todayButton.enabled}}        \n        {{#toolbox.calendarSwitch.enabled}}\n            <div class="pwt-btn-calendar">{{calendarSwitchText}}</div>\n        {{/toolbox.calendarSwitch.enabled}}\n    </div>\n    {{/enabled}}\n    {{^enabled}}\n        {{#onlyTimePicker}}\n        <div class="toolbox">\n            <div class="pwt-btn-submit">{{submitButtonText}}</div>\n        </div>\n        {{/onlyTimePicker}}\n    {{/enabled}}\n    {{/toolbox}}\n</div>\n'},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(11),r=i(12),o=i(13),s=i(6),l=i(3),d=i(7),u=i(8),c=i(10),h=function(){function e(t,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.components(t,i)}return a(e,[{key:"components",value:function(e,t){return this.initialUnix=null,this.inputElement=e,this.options=new u(t,this),this.PersianDate=new c(this),this.state=new n(this),this.api=new l(this),this.input=new s(this,e),this.view=new o(this),this.toolbox=new r(this),this.updateInput=function(e){this.input.update(e)},this.state.setViewDateTime("unix",this.input.getOnInitState()),this.state.setSelectedDateTime("unix",this.input.getOnInitState()),this.view.render(),this.navigator=new d(this),this.api}}]),e}();e.exports=h},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t}return a(e,[{key:"show",value:function(){return this.model.view.show(),this.model.options.onShow(this.model),this.model}},{key:"getState",value:function(){return this.model.state}},{key:"hide",value:function(){return this.model.view.hide(),this.model.options.onHide(this.model),this.model}},{key:"toggle",value:function(){return this.model.view.toggle(),this.model.options.onToggle(this.model),this.model}},{key:"destroy",value:function(){this.model&&(this.model.view.destroy(),this.model.options.onDestroy(this.model),delete this.model)}},{key:"setDate",value:function(e){return this.model.state.setSelectedDateTime("unix",e),this.model.state.setViewDateTime("unix",e),this.model.state.setSelectedDateTime("unix",e),this.model.view.render(this.view),this.model.options.onSet(e),this.model}},{key:"options",get:function(){return this.model.options},set:function(e){var t=$.extend(!0,this.model.options,e);this.model.view.destroy(),this.model.components(this.model.inputElement,t)}}]),e}();e.exports=n},function(e,t,i){"use strict";var a=i(0),n={calendarType:"persian",calendar:{persian:{locale:"fa",showHint:!1,leapYearMode:"algorithmic"},gregorian:{locale:"en",showHint:!1}},responsive:!0,inline:!1,initialValue:!0,initialValueType:"gregorian",persianDigit:!0,viewMode:"day",format:"LLLL",formatter:function(e){return this.model.PersianDate.date(e).format(this.format)},altField:!1,altFormat:"unix",altFieldFormatter:function(e){var t=this.altFormat.toLowerCase();return"gregorian"===t||"g"===t?new Date(e):"unix"===t||"u"===t?e:this.model.PersianDate.date(e).format(this.altFormat)},minDate:null,maxDate:null,navigator:{enabled:!0,scroll:{enabled:!0},text:{btnNextText:"<",btnPrevText:">"},onNext:function(e){a.debug(e,"Event: onNext")},onPrev:function(e){a.debug(e,"Event: onPrev")},onSwitch:function(e){a.debug(e,"dayPicker Event: onSwitch")}},toolbox:{enabled:!0,text:{btnToday:""},submitButton:{enabled:a.isMobile,text:{fa:"",en:"submit"},onSubmit:function(e){a.debug(e,"dayPicker Event: onSubmit")}},todayButton:{enabled:!0,text:{fa:"",en:"today"},onToday:function(e){a.debug(e,"dayPicker Event: onToday")}},calendarSwitch:{enabled:!0,format:"MMMM",onSwitch:function(e){a.debug(e,"dayPicker Event: onSwitch")}},onToday:function(e){a.debug(e,"dayPicker Event: onToday")}},onlyTimePicker:!1,onlySelectOnDate:!0,checkDate:function(){return!0},checkMonth:function(){return!0},checkYear:function(){return!0},timePicker:{enabled:!1,step:1,hour:{enabled:!0,step:null},minute:{enabled:!0,step:null},second:{enabled:!0,step:null},meridian:{enabled:!1}},dayPicker:{enabled:!0,titleFormat:"YYYY MMMM",titleFormatter:function(e,t){return this.model.PersianDate.date([e,t]).format(this.model.options.dayPicker.titleFormat)},onSelect:function(e){a.debug(this,"dayPicker Event: onSelect : "+e)}},monthPicker:{enabled:!0,titleFormat:"YYYY",titleFormatter:function(e){return this.model.PersianDate.date(e).format(this.model.options.monthPicker.titleFormat)},onSelect:function(e){a.debug(this,"monthPicker Event: onSelect : "+e)}},yearPicker:{enabled:!0,titleFormat:"YYYY",titleFormatter:function(e){var t=12*parseInt(e/12,10),i=this.model.PersianDate.date([t]),a=this.model.PersianDate.date([t+11]);return i.format(this.model.options.yearPicker.titleFormat)+"-"+a.format(this.model.options.yearPicker.titleFormat)},onSelect:function(e){a.debug(this,"yearPicker Event: onSelect : "+e)}},onSelect:function(e){a.debug(this,"datepicker Event: onSelect : "+e)},onSet:function(e){a.debug(this,"datepicker Event: onSet : "+e)},position:"auto",onShow:function(e){a.debug(e,"Event: onShow ")},onHide:function(e){a.debug(e,"Event: onHide ")},onToggle:function(e){a.debug(e,"Event: onToggle ")},onDestroy:function(e){a.debug(e,"Event: onDestroy ")},autoClose:!1,template:null,observer:!1,inputDelay:800};e.exports=n},function(e,t,i){"use strict";var a,n=i(2);(a=jQuery).fn.persianDatepicker=a.fn.pDatepicker=function(e){var t=Array.prototype.slice.call(arguments),i=this;return this||a.error("Invalid selector"),a(this).each(function(){var r=t.concat([]),o=a(this).data("datepicker"),s=null;o&&"string"==typeof r[0]?(s=r[0],o[s](r[0])):i.pDatePicker=new n(this,e)}),a(this).data("datepicker",i.pDatePicker),i.pDatePicker}},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(0),r=i(9),o=function(){function e(t,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this._firstUpdate=!0,this.elem=i,this.model.options.observer&&this.observe(),this.addInitialClass(),this.initialUnix=null,0==this.model.options.inline&&this._attachInputElementEvents(),this}return a(e,[{key:"addInitialClass",value:function(){$(this.elem).addClass("pwt-datepicker-input-element")}},{key:"parseInput",value:function(e){var t=new r;if(void 0!==t.parse(e)){var i=this.model.PersianDate.date(t.parse(e)).valueOf();this.model.state.setSelectedDateTime("unix",i),this.model.state.setViewDateTime("unix",i),this.model.view.render()}}},{key:"observe",value:function(){var e=this;$(e.elem).bind("paste",function(t){n.delay(function(){e.parseInput(t.target.value)},60)});var t=void 0,i=e.model.options.inputDelay,a=!1,r=[17,91];$(document).keydown(function(e){$.inArray(e.keyCode,r)>0&&(a=!0)}).keyup(function(e){$.inArray(e.keyCode,r)>0&&(a=!1)}),$(e.elem).bind("keyup",function(n){var o=$(this),s=!1;(8===n.keyCode||n.keyCode<105&&n.keyCode>96||n.keyCode<58&&n.keyCode>47||a&&(86==n.keyCode||$.inArray(n.keyCode,r)>0))&&(s=!0),s&&(clearTimeout(t),t=setTimeout(function(){!function(t){e.parseInput(t.val())}(o)},i))}),$(e.elem).on("keydown",function(){clearTimeout(t)})}},{key:"_attachInputElementEvents",value:function(){var e=this,t=function t(i){$(i.target).is(e.elem)||$(i.target).is(e.model.view.$container)||0!=$(i.target).closest("#"+e.model.view.$container.attr("id")).length||$(i.target).is($(e.elem).children())||(e.model.api.hide(),$("body").unbind("click",t))};$(this.elem).on("focus click",n.debounce(function(i){return e.model.api.show(),!1===e.model.state.ui.isInline&&$("body").unbind("click",t).bind("click",t),n.isMobile&&$(this).blur(),i.stopPropagation(),!1},200)),$(this.elem).on("keydown",n.debounce(function(t){if(9===t.which)return e.model.api.hide(),!1},200))}},{key:"getInputPosition",value:function(){return $(this.elem).offset()}},{key:"getInputSize",value:function(){return{width:$(this.elem).outerWidth(),height:$(this.elem).outerHeight()}}},{key:"_updateAltField",value:function(e){var t=this.model.options.altFieldFormatter(e);$(this.model.options.altField).val(t)}},{key:"_updateInputField",value:function(e){var t=this.model.options.formatter(e);$(this.elem).val()!=t&&$(this.elem).val(t)}},{key:"update",value:function(e){0==this.model.options.initialValue&&this._firstUpdate?this._firstUpdate=!1:(this._updateInputField(e),this._updateAltField(e))}},{key:"getOnInitState",value:function(){var e=null,t=$(this.elem),i=void 0;if((i="INPUT"===t[0].nodeName?t[0].getAttribute("value"):t.data("date"))&&i.match("^([0-1][0-9]|2[0-3]):([0-5][0-9])(?::([0-5][0-9]))?$")){var a=i.split(":"),n=new Date;n.setHours(a[0]),n.setMinutes(a[1]),a[2]?n.setSeconds(a[2]):n.setSeconds(0),this.initialUnix=n.valueOf()}else{if("persian"===this.model.options.initialValueType&&i){var o=new r,s=new persianDate(o.parse(i)).valueOf();e=new Date(s).valueOf()}else"unix"===this.model.options.initialValueType&&i?e=parseInt(i):i&&(e=new Date(i).valueOf());this.initialUnix=e&&"undefined"!=e?e:(new Date).valueOf()}return this.initialUnix}}]),e}();e.exports=o},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(14),r=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.liveAttach(),this._attachEvents(),this}return a(e,[{key:"liveAttach",value:function(){if(this.model.options.navigator.scroll.enabled){var e=this,t=$("#"+e.model.view.id+" .datepicker-grid-view")[0];n(t).wheel(function(t,i){i>0?e.model.state.navigate("next"):e.model.state.navigate("prev"),e.model.view.render(),t.preventDefault()}),this.model.options.timePicker.enabled&&$("#"+e.model.view.id+" .time-segment").each(function(){n(this).wheel(function(t,i){var a=$(t.target),n=a.data("time-key")?a.data("time-key"):a.parents("[data-time-key]").data("time-key");n&&(i>0?e.timeUp(n):e.timeDown(n)),e.model.view.render(),t.preventDefault()})})}}},{key:"timeUp",value:function(e){if(null!=this.model.options.timePicker[e]){var t=void 0,i=void 0,a=this;"meridian"==e?(t=12,i="PM"==this.model.state.view.meridian?this.model.PersianDate.date(this.model.state.selected.unixDate).add("hour",t).valueOf():this.model.PersianDate.date(this.model.state.selected.unixDate).subtract("hour",t).valueOf(),this.model.state.meridianToggle()):(t=this.model.options.timePicker[e].step,i=this.model.PersianDate.date(this.model.state.selected.unixDate).add(e,t).valueOf()),this.model.state.setViewDateTime("unix",i),this.model.state.setSelectedDateTime("unix",i),this.model.view.renderTimePartial(),clearTimeout(this.scrollDelayTimeDown),this.scrollDelayTimeUp=setTimeout(function(){a.model.view.markSelectedDay()},300)}}},{key:"timeDown",value:function(e){if(null!=this.model.options.timePicker[e]){var t=void 0,i=void 0,a=this;"meridian"==e?(t=12,i="AM"==this.model.state.view.meridian?this.model.PersianDate.date(this.model.state.selected.unixDate).add("hour",t).valueOf():this.model.PersianDate.date(this.model.state.selected.unixDate).subtract("hour",t).valueOf(),this.model.state.meridianToggle()):(t=this.model.options.timePicker[e].step,i=this.model.PersianDate.date(this.model.state.selected.unixDate).subtract(e,t).valueOf()),this.model.state.setViewDateTime("unix",i),this.model.state.setSelectedDateTime("unix",i),this.model.view.renderTimePartial(),clearTimeout(this.scrollDelayTimeDown),this.scrollDelayTimeDown=setTimeout(function(){a.model.view.markSelectedDay()},300)}}},{key:"_attachEvents",value:function(){var e=this;this.model.options.navigator.enabled&&$(document).on("click","#"+e.model.view.id+" .pwt-btn",function(){$(this).is(".pwt-btn-next")?(e.model.state.navigate("next"),e.model.view.render(),e.model.options.navigator.onNext(e.model)):$(this).is(".pwt-btn-switch")?(e.model.state.switchViewMode(),e.model.view.render(),e.model.options.navigator.onSwitch(e.model)):$(this).is(".pwt-btn-prev")&&(e.model.state.navigate("prev"),e.model.view.render(),e.model.options.navigator.onPrev(e.model))}),this.model.options.timePicker.enabled&&($(document).on("click","#"+e.model.view.id+" .up-btn",function(){var t=$(this).data("time-key");e.timeUp(t),e.model.options.onSelect(e.model.state.selected.unixDate)}),$(document).on("click","#"+e.model.view.id+" .down-btn",function(){var t=$(this).data("time-key");e.timeDown(t),e.model.options.onSelect(e.model.state.selected.unixDate)})),this.model.options.dayPicker.enabled&&$(document).on("click","#"+e.model.view.id+" .datepicker-day-view td:not(.disabled)",function(){var t=$(this).data("unix"),i=void 0;e.model.state.setSelectedDateTime("unix",t),i=e.model.state.selected.month!==e.model.state.view.month,e.model.state.setViewDateTime("unix",e.model.state.selected.unixDate),e.model.options.autoClose&&(e.model.view.hide(),e.model.options.onHide(e)),i?e.model.view.render():e.model.view.markSelectedDay(),e.model.options.dayPicker.onSelect(t),e.model.options.onSelect(t)}),this.model.options.monthPicker.enabled&&$(document).on("click","#"+e.model.view.id+" .datepicker-month-view .month-item:not(.month-item-disable)",function(){var t=$(this).data("month");e.model.state.switchViewModeTo("day"),e.model.options.onlySelectOnDate||(e.model.state.setSelectedDateTime("month",t),e.model.options.autoClose&&(e.model.view.hide(),e.model.options.onHide(e))),e.model.state.setViewDateTime("month",t),e.model.view.render(),e.model.options.monthPicker.onSelect(t),e.model.options.onSelect(e.model.state.selected.unixDate)}),this.model.options.yearPicker.enabled&&$(document).on("click","#"+e.model.view.id+" .datepicker-year-view .year-item:not(.year-item-disable)",function(){var t=$(this).data("year");e.model.state.switchViewModeTo("month"),e.model.options.onlySelectOnDate||(e.model.state.setSelectedDateTime("year",t),e.model.options.autoClose&&(e.model.view.hide(),e.model.options.onHide(e))),e.model.state.setViewDateTime("year",t),e.model.view.render(),e.model.options.yearPicker.onSelect(t),e.model.options.onSelect(e.model.state.selected.unixDate)})}}]),e}();e.exports=r},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=i(4),r=i(1),o=function(){function e(t,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=i,this._compatibility($.extend(!0,this,n,t))}return a(e,[{key:"_compatibility",value:function(e){e.inline&&(e.toolbox.submitButton.enabled=!1),e.template||(e.template=r),persianDate.toCalendar(e.calendarType),persianDate.toLocale(e.calendar[e.calendarType].locale),e.onlyTimePicker&&(e.dayPicker.enabled=!1,e.monthPicker.enabled=!1,e.yearPicker.enabled=!1,e.navigator.enabled=!1,e.toolbox.enabled=!1,e.timePicker.enabled=!0),null===e.timePicker.hour.step&&(e.timePicker.hour.step=e.timePicker.step),null===e.timePicker.minute.step&&(e.timePicker.minute.step=e.timePicker.step),null===e.timePicker.second.step&&(e.timePicker.second.step=e.timePicker.step),!1===e.dayPicker.enabled&&(e.onlySelectOnDate=!1),e._viewModeList=[],e.dayPicker.enabled&&e._viewModeList.push("day"),e.monthPicker.enabled&&e._viewModeList.push("month"),e.yearPicker.enabled&&e._viewModeList.push("year")}}]),e}();e.exports=o},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pattern={iso:/^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(\\.[0-9]+)?(Z)?$/g,jalali:/^[1-4]\d{3}(\/|-|\.)((0?[1-6](\/|-|\.)((3[0-1])|([1-2][0-9])|(0?[1-9])))|((1[0-2]|(0?[7-9]))(\/|-|\.)(30|([1-2][0-9])|(0?[1-9]))))$/g}}return a(e,[{key:"parse",value:function(e){var t=new RegExp(this.pattern.iso),i=new RegExp(this.pattern.jalali);return String.prototype.toEnglishDigits=function(){var e="".charCodeAt(0);return this.replace(/[-]/g,function(t){return t.charCodeAt(0)-e})},e=e.toEnglishDigits(),i.test(e)?e.split(/\/|-|\,|\./).map(Number):t.test(e)?e.split(/\/|-|\,|\:|\T|\Z/g).map(Number):void 0}}]),e}();e.exports=n},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.model.options.calendar_=this.model.options.calendarType,this.model.options.locale_=this.model.options.calendar[this.model.options.calendarType].locale,this}return a(e,[{key:"date",value:function(e){window.inspdCount||0===window.inspdCount?window.inspdCount++:window.inspdCount=0;var t=void 0;return t=persianDate.toCalendar(this.model.options.calendar_),this.model.options.calendar[this.model.options.calendarType].leapYearMode&&t.toLeapYearMode(this.model.options.calendar[this.model.options.calendarType].leapYearMode),new t(e).toLocale(this.model.options.locale_)}}]),e}();e.exports=n},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.filetredDate=this.model.options.minDate||this.model.options.maxDate,this.viewModeList=this.model.options._viewModeList,this.viewMode=this.viewModeList.indexOf(t.options.viewMode)>0?t.options.viewMode:this.viewModeList[0],this.viewModeIndex=this.viewModeList.indexOf(t.options.viewMode)>0?this.viewModeList.indexOf(t.options.viewMode):0,this.filterDate={start:{year:0,month:0,date:0,hour:0,minute:0,second:0,unixDate:0},end:{year:0,month:0,date:0,hour:0,minute:0,second:0,unixDate:0}},this.view={year:0,month:0,date:0,hour:0,minute:0,second:0,unixDate:0,dateObject:null,meridian:"AM"},this.selected={year:0,month:0,date:0,hour:0,hour12:0,minute:0,second:0,unixDate:0,dateObject:null},this.ui={isOpen:!1,isInline:this.model.options.inline},this._setFilterDate(this.model.options.minDate,this.model.options.maxDate),this}return a(e,[{key:"_setFilterDate",value:function(e,t){e||(e=-2e15),t||(t=2e15);var i=this.model.PersianDate.date(e);this.filterDate.start.unixDate=e,this.filterDate.start.hour=i.hour(),this.filterDate.start.minute=i.minute(),this.filterDate.start.second=i.second(),this.filterDate.start.month=i.month(),this.filterDate.start.date=i.date(),this.filterDate.start.year=i.year();var a=this.model.PersianDate.date(t);this.filterDate.end.unixDate=t,this.filterDate.end.hour=a.hour(),this.filterDate.end.minute=a.minute(),this.filterDate.end.second=a.second(),this.filterDate.end.month=a.month(),this.filterDate.end.date=a.date(),this.filterDate.end.year=a.year()}},{key:"navigate",value:function(e){if("next"==e){if("year"==this.viewMode&&this.setViewDateTime("year",this.view.year+12),"month"==this.viewMode){var t=this.view.year+1;0===t&&(t=1),this.setViewDateTime("year",t)}if("day"==this.viewMode){var i=this.view.year+1;0===i&&(i=1),this.view.month+1==13?(this.setViewDateTime("year",i),this.setViewDateTime("month",1)):this.setViewDateTime("month",this.view.month+1)}}else{if("year"==this.viewMode&&this.setViewDateTime("year",this.view.year-12),"month"==this.viewMode){var a=this.view.year-1;0===a&&(a=-1),this.setViewDateTime("year",a)}if("day"==this.viewMode)if(this.view.month-1<=0){var n=this.view.year-1;0===n&&(n=-1),this.setViewDateTime("year",n),this.setViewDateTime("month",12)}else this.setViewDateTime("month",this.view.month-1)}}},{key:"switchViewMode",value:function(){return this.viewModeIndex=this.viewModeIndex+1>=this.viewModeList.length?0:this.viewModeIndex+1,this.viewMode=this.viewModeList[this.viewModeIndex]?this.viewModeList[this.viewModeIndex]:this.viewModeList[0],this._setViewDateTimeUnix(),this}},{key:"switchViewModeTo",value:function(e){this.viewModeList.indexOf(e)>=0&&(this.viewMode=e,this.viewModeIndex=this.viewModeList.indexOf(e))}},{key:"setSelectedDateTime",value:function(e,t){switch(e){case"unix":this.selected.unixDate=t;var i=this.model.PersianDate.date(t);this.selected.year=i.year(),this.selected.month=i.month(),this.selected.date=i.date(),this.selected.hour=i.hour(),this.selected.hour12=i.format("hh"),this.selected.minute=i.minute(),this.selected.second=i.second();break;case"year":this.selected.year=t;break;case"month":this.selected.month=t;break;case"date":this.selected.date=t;break;case"hour":this.selected.hour=t;break;case"minute":this.selected.minute=t;break;case"second":this.selected.second=t}return this._updateSelectedUnix(),this}},{key:"_updateSelectedUnix",value:function(){return this.selected.dateObject=this.model.PersianDate.date([this.selected.year,this.selected.month,this.selected.date,this.view.hour,this.view.minute,this.view.second]),this.selected.unixDate=this.selected.dateObject.valueOf(),this.model.updateInput(this.selected.unixDate),this}},{key:"_setViewDateTimeUnix",value:function(){return this.view.dateObject=this.model.PersianDate.date([this.view.year,this.view.month,this.view.date,this.view.hour,this.view.minute,this.view.second]),this.view.year=this.view.dateObject.year(),this.view.month=this.view.dateObject.month(),this.view.date=this.view.dateObject.date(),this.view.hour=this.view.dateObject.hour(),this.view.hour12=this.view.dateObject.format("hh"),this.view.minute=this.view.dateObject.minute(),this.view.second=this.view.dateObject.second(),this.view.unixDate=this.view.dateObject.valueOf(),this}},{key:"setViewDateTime",value:function(e,t){switch(e){case"unix":var i=this.model.PersianDate.date(t);this.view.year=i.year(),this.view.month=i.month(),this.view.date=i.date(),this.view.hour=i.hour(),this.view.minute=i.minute(),this.view.second=i.second();break;case"year":this.view.year=t;break;case"month":this.view.month=t;break;case"date":this.view.date=t;break;case"hour":this.view.hour=t;break;case"minute":this.view.minute=t;break;case"second":this.view.second=t}return this._setViewDateTimeUnix(),this}},{key:"meridianToggle",value:function(){"AM"===this.view.meridian?this.view.meridian="PM":"PM"===this.view.meridian&&(this.view.meridian="AM")}}]),e}();e.exports=n},function(e,t,i){"use strict";var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var n=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this._attachEvents(),this}return a(e,[{key:"_toggleCalendartype",value:function(){"persian"==this.model.options.calendar_?(this.model.options.calendar_="gregorian",this.model.options.locale_=this.model.options.calendar.gregorian.locale):(this.model.options.calendar_="persian",this.model.options.locale_=this.model.options.calendar.persian.locale)}},{key:"_attachEvents",value:function(){var e=this;$(document).on("click","#"+e.model.view.id+" .pwt-btn-today",function(){e.model.state.setSelectedDateTime("unix",(new Date).valueOf()),e.model.state.setViewDateTime("unix",(new Date).valueOf()),e.model.view.reRender(),e.model.options.toolbox.onToday(e.model),e.model.options.toolbox.todayButton.onToday(e.model)}),$(document).on("click","#"+e.model.view.id+" .pwt-btn-calendar",function(){e._toggleCalendartype(),e.model.state.setSelectedDateTime("unix",e.model.state.selected.unixDate),e.model.state.setViewDateTime("unix",e.model.state.view.unixDate),e.model.view.render(),e.model.options.toolbox.calendarSwitch.onSwitch(e.model)}),$(document).on("click","#"+e.model.view.id+" .pwt-btn-submit",function(){e.model.view.hide(),e.model.options.toolbox.submitButton.onSubmit(e.model),e.model.options.onHide(this)})}}]),e}();e.exports=n},function(e,t,i){"use strict";var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],a=!0,n=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);a=!0);}catch(e){n=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw r}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}();var r=i(1),o=i(0),s=i(15),l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.yearsViewCount=12,this.model=t,this.rendered=null,this.$container=null,this.id="persianDateInstance-"+parseInt(1e3*Math.random(100));return this.model.state.ui.isInline?this.$container=$('<div  id="'+this.id+'" class="datepicker-container-inline"></div>').appendTo(this.model.inputElement):(this.$container=$('<div  id="'+this.id+'" class="datepicker-container"></div>').appendTo("body"),this.hide(),this.setPickerBoxPosition(),this.addCompatibilityClass()),this}return n(e,[{key:"addCompatibilityClass",value:function(){o.isMobile&&this.model.options.responsive&&this.$container.addClass("pwt-mobile-view")}},{key:"destroy",value:function(){this.$container.remove()}},{key:"setPickerBoxPosition",value:function(){var e=this.model.input.getInputPosition(),t=this.model.input.getInputSize();if(o.isMobile&&this.model.options.responsive)return!1;"auto"===this.model.options.position?this.$container.css({left:e.left+"px",top:t.height+e.top+"px"}):this.$container.css({left:this.model.options.position[1]+e.left+"px",top:this.model.options.position[0]+e.top+"px"})}},{key:"show",value:function(){this.$container.removeClass("pwt-hide"),this.setPickerBoxPosition()}},{key:"hide",value:function(){this.$container.addClass("pwt-hide")}},{key:"toggle",value:function(){this.$container.toggleClass("pwt-hide")}},{key:"_getNavSwitchText",value:function(e){var t=void 0;return"day"==this.model.state.viewMode?t=this.model.options.dayPicker.titleFormatter.call(this,e.year,e.month):"month"==this.model.state.viewMode?t=this.model.options.monthPicker.titleFormatter.call(this,e.dateObject.valueOf()):"year"==this.model.state.viewMode&&(t=this.model.options.yearPicker.titleFormatter.call(this,e.year)),t}},{key:"checkYearAccess",value:function(e){if(this.model.state.filetredDate){var t=this.model.state.filterDate.start.year,i=this.model.state.filterDate.end.year;if(t&&e<t)return!1;if(i&&e>i)return!1}return this.model.options.checkYear(e)}},{key:"_getYearViewModel",value:function(e){var t=this,i=this.model.options.yearPicker.enabled;if(!i)return{enabled:!1};var a=[].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(Array(this.yearsViewCount).keys())).map(function(i){return i+parseInt(e.year/t.yearsViewCount)*t.yearsViewCount}),n=[],r=this.model.PersianDate.date(),o=!0,s=!1,l=void 0;try{for(var d,u=a[Symbol.iterator]();!(o=(d=u.next()).done);o=!0){var c=d.value;r.year([c]),n.push({title:r.format("YYYY"),enabled:this.checkYearAccess(c),dataYear:c,selected:this.model.state.selected.year==c})}}catch(e){s=!0,l=e}finally{try{!o&&u.return&&u.return()}finally{if(s)throw l}}return{enabled:i,viewMode:"year"==this.model.state.viewMode,list:n}}},{key:"checkMonthAccess",value:function(e){e+=1;var t=this.model.state.view.year;if(this.model.state.filetredDate){var i=this.model.state.filterDate.start.month,a=this.model.state.filterDate.end.month,n=this.model.state.filterDate.start.year,r=this.model.state.filterDate.end.year;if(i&&a&&(t==r&&e>a||t>r)||t==n&&e<i||t<n)return!1;if(a&&(t==r&&e>a||t>r))return!1;if(i&&(t==n&&e<i||t<n))return!1}return this.model.options.checkMonth(e,t)}},{key:"_getMonthViewModel",value:function(){var e=this.model.options.monthPicker.enabled;if(!e)return{enabled:!1};var t=[],i=!0,n=!1,r=void 0;try{for(var o,s=this.model.PersianDate.date().rangeName().months.entries()[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var l=a(o.value,2),d=l[0],u=l[1];t.push({title:u,enabled:this.checkMonthAccess(d),year:this.model.state.view.year,dataMonth:d+1,selected:this.model.state.selected.year==this.model.state.view.year&&this.model.state.selected.month==d+1})}}catch(e){n=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw r}}return{enabled:e,viewMode:"month"==this.model.state.viewMode,list:t}}},{key:"checkDayAccess",value:function(e){if(this.minDate=this.model.options.minDate,this.maxDate=this.model.options.maxDate,this.model.state.filetredDate)if(this.minDate&&this.maxDate){if(this.minDate=this.model.PersianDate.date(this.minDate).startOf("day").valueOf(),this.maxDate=this.model.PersianDate.date(this.maxDate).endOf("day").valueOf(),!(e>=this.minDate&&e<=this.maxDate))return!1}else if(this.minDate){if(this.minDate=this.model.PersianDate.date(this.minDate).startOf("day").valueOf(),e<=this.minDate)return!1}else if(this.maxDate&&(this.maxDate=this.model.PersianDate.date(this.maxDate).endOf("day").valueOf(),e>=this.maxDate))return!1;return this.model.options.checkDate(e)}},{key:"_getDayViewModel",value:function(){if("day"!=this.model.state.viewMode)return[];var e=this.model.options.dayPicker.enabled;if(!e)return{enabled:!1};var t=this.model.state.view.month,i=this.model.state.view.year,n=this.model.PersianDate.date(),r=n.daysInMonth(i,t),o=n.getFirstWeekDayOfMonth(i,t)-1,s=[],l=0,d=0,u=this._getAnotherCalendar(),c=this.model.PersianDate.date(),h=!0,p=!1,f=void 0;try{for(var m,v=[["null","null","null","null","null","null","null"],["null","null","null","null","null","null","null"],["null","null","null","null","null","null","null"],["null","null","null","null","null","null","null"],["null","null","null","null","null","null","null"],["null","null","null","null","null","null","null"]].entries()[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){var g=a(m.value,2),w=g[0],y=g[1];s[w]=[];var b=!0,_=!1,k=void 0;try{for(var x,C=y.entries()[Symbol.iterator]();!(b=(x=C.next()).done);b=!0){var T=a(x.value,1)[0],P=void 0,D=void 0;0===w&&T<o?(P=c.unix(this.model.state.view.dateObject.startOf("month").startOf("day").valueOf()/1e3).subtract("days",o-T),D=!0):0===w&&T>=o||w<=5&&l<r?(l+=1,P=c.year(this.model.state.view.year).month(this.model.state.view.month).date(l),D=!1):(d+=1,P=c.unix(this.model.state.view.dateObject.endOf("month").startOf("day").valueOf()/1e3).add("days",d),D=!0),s[w].push({title:P.format("D"),alterCalTitle:new persianDate(P.valueOf()).toCalendar(u[0]).toLocale(u[1]).format("D"),dataDate:[P.year(),P.month(),P.date()].join(","),dataUnix:P.valueOf(),otherMonth:D,enabled:this.checkDayAccess(P.valueOf())})}}catch(e){_=!0,k=e}finally{try{!b&&C.return&&C.return()}finally{if(_)throw k}}}}catch(e){p=!0,f=e}finally{try{!h&&v.return&&v.return()}finally{if(p)throw f}}return{enabled:e,viewMode:"day"==this.model.state.viewMode,list:s}}},{key:"markSelectedDay",value:function(){var e=this.model.state.selected;this.$container.find(".table-days td").each(function(){$(this).data("date")==[e.year,e.month,e.date].join(",")?$(this).addClass("selected"):$(this).removeClass("selected")})}},{key:"markToday",value:function(){var e=new persianDate;this.$container.find(".table-days td").each(function(){$(this).data("date")==[e.year(),e.month(),e.date()].join(",")?$(this).addClass("today"):$(this).removeClass("today")})}},{key:"_getTimeViewModel",value:function(){var e=this.model.options.timePicker.enabled;if(!e)return{enabled:!1};return{enabled:e,hour:{title:this.model.options.timePicker.meridian.enabled?this.model.state.view.dateObject.format("hh"):this.model.state.view.dateObject.format("HH"),enabled:this.model.options.timePicker.hour.enabled},minute:{title:this.model.state.view.dateObject.format("mm"),enabled:this.model.options.timePicker.minute.enabled},second:{title:this.model.state.view.dateObject.format("ss"),enabled:this.model.options.timePicker.second.enabled},meridian:{title:this.model.state.view.dateObject.format("a"),enabled:this.model.options.timePicker.meridian.enabled}}}},{key:"_getWeekViewModel",value:function(){return{enabled:!0,list:this.model.PersianDate.date().rangeName().weekdaysMin}}},{key:"getCssClass",value:function(){return[this.model.state.ui.isInline?"datepicker-plot-area-inline-view":"",this.model.options.timePicker.meridian.enabled?"":"datepicker-state-no-meridian",this.model.options.onlyTimePicker?"datepicker-state-only-time":"",this.model.options.timePicker.second.enabled?"":"datepicker-state-no-second","gregorian"==this.model.options.calendar_?"datepicker-gregorian":"datepicker-persian"].join(" ")}},{key:"getViewModel",value:function(e){var t=this._getAnotherCalendar();return{plotId:"",navigator:{enabled:this.model.options.navigator.enabled,switch:{enabled:!0,text:this._getNavSwitchText(e)},text:this.model.options.navigator.text},selected:this.model.state.selected,time:this._getTimeViewModel(e),days:this._getDayViewModel(e),weekdays:this._getWeekViewModel(e),month:this._getMonthViewModel(e),year:this._getYearViewModel(e),toolbox:this.model.options.toolbox,cssClass:this.getCssClass(),onlyTimePicker:this.model.options.onlyTimePicker,altCalendarShowHint:this.model.options.calendar[t[0]].showHint,calendarSwitchText:this.model.state.view.dateObject.toCalendar(t[0]).toLocale(t[1]).format(this.model.options.toolbox.calendarSwitch.format),todayButtonText:this._getButtonText().todayButtontext,submitButtonText:this._getButtonText().submitButtonText}}},{key:"_getButtonText",value:function(){var e={};return"fa"==this.model.options.locale_?(e.todayButtontext=this.model.options.toolbox.todayButton.text.fa,e.submitButtonText=this.model.options.toolbox.submitButton.text.fa):"en"==this.model.options.locale_&&(e.todayButtontext=this.model.options.toolbox.todayButton.text.en,e.submitButtonText=this.model.options.toolbox.submitButton.text.en),e}},{key:"_getAnotherCalendar",value:function(){var e=void 0,t=void 0;return"persian"==this.model.options.calendar_?(e="gregorian",t=this.model.options.calendar.gregorian.locale):(e="persian",t=this.model.options.calendar.persian.locale),[e,t]}},{key:"renderTimePartial",value:function(){var e=this._getTimeViewModel(this.model.state.view);this.$container.find('[data-time-key="hour"] input').val(e.hour.title),this.$container.find('[data-time-key="minute"] input').val(e.minute.title),this.$container.find('[data-time-key="second"] input').val(e.second.title),this.$container.find('[data-time-key="meridian"] input').val(e.meridian.title)}},{key:"render",value:function(e){e||(e=this.model.state.view),o.debug(this,"render"),s.parse(r),this.rendered=$(s.render(this.model.options.template,this.getViewModel(e))),this.$container.empty().append(this.rendered),this.markSelectedDay(),this.markToday(),this.afterRender()}},{key:"reRender",value:function(){var e=this.model.state.view;this.render(e)}},{key:"afterRender",value:function(){this.model.navigator&&this.model.navigator.liveAttach()}}]),e}();e.exports=l},function(e,t,i){!function(t,i){"use strict";var a,n,r=function e(t){return new e.Instance(t)};r.SUPPORT="wheel",r.ADD_EVENT="addEventListener",r.REMOVE_EVENT="removeEventListener",r.PREFIX="",r.READY=!1,(r.Instance=function(e){return r.READY||(r.normalise.browser(),r.READY=!0),this.element=e,this.handlers=[],this}).prototype={wheel:function(e,t){return r.event.add(this,r.SUPPORT,e,t),"DOMMouseScroll"===r.SUPPORT&&r.event.add(this,"MozMousePixelScroll",e,t),this},unwheel:function(e,t){return void 0===e&&(e=this.handlers.slice(-1)[0])&&(e=e.original),r.event.remove(this,r.SUPPORT,e,t),"DOMMouseScroll"===r.SUPPORT&&r.event.remove(this,"MozMousePixelScroll",e,t),this}},r.event={add:function(e,i,a,n){var o=a;a=function(e){e||(e=t.event);var i=r.normalise.event(e),a=r.normalise.delta(e);return o(i,a[0],a[1],a[2])},e.element[r.ADD_EVENT](r.PREFIX+i,a,n||!1),e.handlers.push({original:o,normalised:a})},remove:function(e,t,i,a){for(var n,o=i,s={},l=0,d=e.handlers.length;l<d;++l)s[e.handlers[l].original]=e.handlers[l];for(var u in i=(n=s[o]).normalised,e.element[r.REMOVE_EVENT](r.PREFIX+t,i,a||!1),e.handlers)if(e.handlers[u]==n){e.handlers.splice(u,1);break}}},r.normalise={browser:function(){"onwheel"in i||i.documentMode>=9||(r.SUPPORT=void 0!==i.onmousewheel?"mousewheel":"DOMMouseScroll"),t.addEventListener||(r.ADD_EVENT="attachEvent",r.REMOVE_EVENT="detachEvent",r.PREFIX="on")},event:function(e){var t={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"===e.type?0:1,deltaX:0,deltaZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){e.stopPropagation?e.stopPropagation():e.cancelBubble=!1}};return e.wheelDelta&&(t.deltaY=-.025*e.wheelDelta),e.wheelDeltaX&&(t.deltaX=-.025*e.wheelDeltaX),e.detail&&(t.deltaY=e.detail),t},delta:function(e){var t,i,r,o=0,s=0,l=0;return e.deltaY&&(o=l=-1*e.deltaY),e.deltaX&&(o=-1*(s=e.deltaX)),e.wheelDelta&&(o=e.wheelDelta),e.wheelDeltaY&&(l=e.wheelDeltaY),e.wheelDeltaX&&(s=-1*e.wheelDeltaX),e.detail&&(o=-1*e.detail),0===o?[0,0,0]:(t=Math.abs(o),(!a||t<a)&&(a=t),i=Math.max(Math.abs(l),Math.abs(s)),(!n||i<n)&&(n=i),r=o>0?"floor":"ceil",[o=Math[r](o/a),s=Math[r](s/n),l=Math[r](l/n)])}},"function"==typeof t.define&&t.define.amd?t.define("hamster",[],function(){return r}):e.exports=r}(window,window.document)},function(e,t,i){var a,n,r,o;o=function(e){var t=Object.prototype.toString,i=Array.isArray||function(e){return"[object Array]"===t.call(e)};function a(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return null!=e&&"object"===_typeof(e)&&t in e}var o=RegExp.prototype.test,s=/\S/;function l(e){return!function(e,t){return o.call(e,t)}(s,e)}var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},u=/\s*/,c=/\s+/,h=/\s*=/,p=/\s*\}/,f=/#|\^|\/|>|\{|&|=|!/;function m(e){this.string=e,this.tail=e,this.pos=0}function v(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function g(){this.cache={}}m.prototype.eos=function(){return""===this.tail},m.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var i=t[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},m.prototype.scanUntil=function(e){var t,i=this.tail.search(e);switch(i){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=t.length,t},v.prototype.push=function(e){return new v(e,this)},v.prototype.lookup=function(e){var t,i,n,o=this.cache;if(o.hasOwnProperty(e))t=o[e];else{for(var s,l,d,u=this,c=!1;u;){if(e.indexOf(".")>0)for(s=u.view,l=e.split("."),d=0;null!=s&&d<l.length;)d===l.length-1&&(c=r(s,l[d])||(i=s,n=l[d],null!=i&&"object"!==_typeof(i)&&i.hasOwnProperty&&i.hasOwnProperty(n))),s=s[l[d++]];else s=u.view[e],c=r(u.view,e);if(c){t=s;break}u=u.parent}o[e]=t}return a(t)&&(t=t.call(this.view)),t},g.prototype.clearCache=function(){this.cache={}},g.prototype.parse=function(t,a){var r=this.cache,o=t+":"+(a||e.tags).join(":"),s=r[o];return null==s&&(s=r[o]=function(t,a){if(!t)return[];var r,o,s,d=[],v=[],g=[],w=!1,y=!1;function b(){if(w&&!y)for(;g.length;)delete v[g.pop()];else g=[];w=!1,y=!1}function _(e){if("string"==typeof e&&(e=e.split(c,2)),!i(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(n(e[0])+"\\s*"),o=new RegExp("\\s*"+n(e[1])),s=new RegExp("\\s*"+n("}"+e[1]))}_(a||e.tags);for(var k,x,C,T,P,D,M=new m(t);!M.eos();){if(k=M.pos,C=M.scanUntil(r))for(var S=0,E=C.length;S<E;++S)l(T=C.charAt(S))?g.push(v.length):y=!0,v.push(["text",T,k,k+1]),k+=1,"\n"===T&&b();if(!M.scan(r))break;if(w=!0,x=M.scan(f)||"name",M.scan(u),"="===x?(C=M.scanUntil(h),M.scan(h),M.scanUntil(o)):"{"===x?(C=M.scanUntil(s),M.scan(p),M.scanUntil(o),x="&"):C=M.scanUntil(o),!M.scan(o))throw new Error("Unclosed tag at "+M.pos);if(P=[x,C,k,M.pos],v.push(P),"#"===x||"^"===x)d.push(P);else if("/"===x){if(!(D=d.pop()))throw new Error('Unopened section "'+C+'" at '+k);if(D[1]!==C)throw new Error('Unclosed section "'+D[1]+'" at '+k)}else"name"===x||"{"===x||"&"===x?y=!0:"="===x&&_(C)}if(D=d.pop())throw new Error('Unclosed section "'+D[1]+'" at '+M.pos);return function(e){for(var t,i=[],a=i,n=[],r=0,o=e.length;r<o;++r)switch((t=e[r])[0]){case"#":case"^":a.push(t),n.push(t),a=t[4]=[];break;case"/":n.pop()[5]=t[2],a=n.length>0?n[n.length-1][4]:i;break;default:a.push(t)}return i}(function(e){for(var t,i,a=[],n=0,r=e.length;n<r;++n)(t=e[n])&&("text"===t[0]&&i&&"text"===i[0]?(i[1]+=t[1],i[3]=t[3]):(a.push(t),i=t));return a}(v))}(t,a)),s},g.prototype.render=function(e,t,i,a){var n=this.parse(e,a),r=t instanceof v?t:new v(t);return this.renderTokens(n,r,i,e,a)},g.prototype.renderTokens=function(e,t,i,a,n){for(var r,o,s,l="",d=0,u=e.length;d<u;++d)s=void 0,"#"===(o=(r=e[d])[0])?s=this.renderSection(r,t,i,a):"^"===o?s=this.renderInverted(r,t,i,a):">"===o?s=this.renderPartial(r,t,i,n):"&"===o?s=this.unescapedValue(r,t):"name"===o?s=this.escapedValue(r,t):"text"===o&&(s=this.rawValue(r)),void 0!==s&&(l+=s);return l},g.prototype.renderSection=function(e,t,n,r){var o=this,s="",l=t.lookup(e[1]);if(l){if(i(l))for(var d=0,u=l.length;d<u;++d)s+=this.renderTokens(e[4],t.push(l[d]),n,r);else if("object"===_typeof(l)||"string"==typeof l||"number"==typeof l)s+=this.renderTokens(e[4],t.push(l),n,r);else if(a(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(t.view,r.slice(e[3],e[5]),function(e){return o.render(e,t,n)}))&&(s+=l)}else s+=this.renderTokens(e[4],t,n,r);return s}},g.prototype.renderInverted=function(e,t,a,n){var r=t.lookup(e[1]);if(!r||i(r)&&0===r.length)return this.renderTokens(e[4],t,a,n)},g.prototype.renderPartial=function(e,t,i,n){if(i){var r=a(i)?i(e[1]):i[e[1]];return null!=r?this.renderTokens(this.parse(r,n),t,i,r):void 0}},g.prototype.unescapedValue=function(e,t){var i=t.lookup(e[1]);if(null!=i)return i},g.prototype.escapedValue=function(t,i){var a=i.lookup(t[1]);if(null!=a)return e.escape(a)},g.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="3.0.1",e.tags=["{{","}}"];var w=new g;return e.clearCache=function(){return w.clearCache()},e.parse=function(e,t){return w.parse(e,t)},e.render=function(e,t,a,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(i(r=e)?"array":_typeof(r))+'" was given as the first argument for mustache#render(template, view, partials)');var r;return w.render(e,t,a,n)},e.to_html=function(t,i,n,r){var o=e.render(t,i,n);if(!a(r))return o;r(o)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return d[e]})},e.Scanner=m,e.Context=v,e.Writer=g,e},"object"===_typeof(t)&&t&&"string"!=typeof t.nodeName?o(t):(n=[t],void 0===(r="function"==typeof(a=o)?a.apply(t,n):a)||(e.exports=r))}])}),$(document).ready(function(){$(document).on("click","#btnEditUserPhoto",function(){$("#UserProfilePhoto").trigger("click")}),$(document).on("click","#uploadProfilePhotoAjaxSubmit",function(){$(".profilePhotoUploadProgressBar").fadeIn(),mApp.block(".userProfilePicWraper",{type:"loader",state:"success"});var e=$("#profilePhotoAjaxForm"),t=new FormData(e[0]);$.ajax({url:e.attr("action"),type:"POST",data:t,dataType:"json",mimeType:"multipart/form-data",cache:!1,contentType:!1,processData:!1,success:function(e){if(e.error){var t=e.error.message;toastr.error("    .<br>"+t)}else updateUserCompletionProgress(e.user.info.completion),toastr.success("   ."),1===e.user.lockProfile&&window.location.reload();mApp.unblock(".userProfilePicWraper")},xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;$(".profilePhotoUploadProgressBar .progress-bar").css("width",t+"%")}},!1),e}})});var e=$("#profilePhotoAjaxForm");function t(e){var t=document.location.href.split("#")[0];t+="#"+e,history.pushState("data to be passed","Title of the page",t)}function i(){t("_"),$(".profileMenuPage.profileMenuPage-filmVaJozve").fadeOut(0),$(".profileMenuPage.profileMenuPage-setting").fadeOut(0),$(".profileMenuPage.profileMenuPage-sabteRotbe").fadeIn(),$([document.documentElement,document.body]).animate({scrollTop:$(".profileMenuPage.profileMenuPage-sabteRotbe").offset().top-$("#m_header").height()-30},500)}function a(){t("_"),$(".profileMenuPage.profileMenuPage-filmVaJozve").fadeOut(0),$(".profileMenuPage.profileMenuPage-sabteRotbe").fadeOut(0),$(".profileMenuPage.profileMenuPage-setting").fadeIn(),$([document.documentElement,document.body]).animate({scrollTop:$(".profileMenuPage.profileMenuPage-setting").offset().top-$("#m_header").height()-30},500)}$("#UserProfilePhoto").fileinput({theme:"fas",showUpload:!1,showCaption:!1,uploadAsync:!1,uploadUrl:e.attr("action"),uploadExtraData:function(){return{updateType:"photo"}},browseClass:"fileinput-btnBrowseUserImage",removeClass:"fileinput-btnRemoveUserImage",captionClass:"fileinput-captionClass",previewClass:"fileinput-previewClass",frameClass:"fileinput-frameClass",mainClass:"fileinput-mainClass",fileType:"any",overwriteInitial:!0,initialPreviewAsData:!0}),$(document).on("change","#UserProfilePhoto",function(e){($(this)[0].files[0].size/1024).toFixed(4)<500?($(".imgUserProfileImage").fadeOut(0),$(".file-input.theme-fas").fadeIn(),$(".submitProfilePic").fadeIn()):(toastr.warning("   500  "),mUtil.scrollTop())}),$("#birthdate").persianDatepicker({observer:!0,format:"YYYY/MM/DD",altField:"#birthdateAlt"}),$(document).on("click","#btnUpdateProfileInfoForm",function(){var e,t,i,a,n=(e=!0,t="",i=$('#profileForm-setting input[name="postalCode"]'),a=$('#profileForm-setting input[name="email"]'),isNaN(i.val())?(e=!1,t+="     .<br>",i.parents(".form-group").addClass("has-danger")):i.val().trim().length>0&&10!==i.val().trim().length?(e=!1,t+="      .<br>",i.parents(".form-group").addClass("has-danger")):i.parents(".form-group").removeClass("has-danger"),/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a.val())||0===a.val().trim().length?a.parents(".form-group").removeClass("has-danger"):(e=!1,t+="    .<br>",a.parents(".form-group").addClass("has-danger")),{status:e,message:t});if(!n.status)return toastr.warning(n.message),!1;var r=$("#profileForm-setting"),o=getFormData(r);mApp.block(".profileMenuPage.profileMenuPage-setting",{overlayColor:"#000000",type:"loader",state:"success",message:"  ..."}),$.ajax({type:r.attr("method"),url:r.attr("action"),data:o,dataType:"json",success:function(e){if(e.error){var t=e.error.message;toastr.warning("    .<br>"+t)}else updateUserCompletionProgress(e.user.info.completion),toastr.success("   ."),1===e.user.lockProfile&&window.location.reload();mApp.unblock(".profileMenuPage.profileMenuPage-setting")},error:function(e,t,i){var a="";a="The given data was invalid."===e.responseJSON.message?function(e){var t="";for(var i in e)for(var a in e[i])isNaN(a)||(t+=e[i][a]+"<br>");return t}(e.responseJSON.errors):"    .",toastr.warning(a),mApp.unblock(".profileMenuPage.profileMenuPage-setting")}})}),$(document).on("click","#btnSabteRotbe1",function(){var e=$("#frmSabteRotbe"),t=getFormData(e);mApp.block(".profileMenuPage.profileMenuPage-sabteRotbe",{overlayColor:"#000000",type:"loader",state:"success",message:"  ..."}),$.ajax({type:e.attr("method"),url:e.attr("action"),data:t,success:function(e){if(e.error){var t=e.error.message;toastr.error("    .<br>"+t)}else toastr.success("   .");mApp.unblock(".profileMenuPage.profileMenuPage-sabteRotbe")},error:function(e,t,i){toastr.error("    ."),mApp.unblock(".SendMobileVerificationCodeWarper")}})}),$(document).on("click","#btnSendMobileVerificationCode",function(){mApp.block(".SendMobileVerificationCodeWarper",{overlayColor:"#000000",type:"loader",state:"success",message:"  ..."}),$.ajax({type:"GET",url:$("#SendMobileVerificationCodeActionUrl").val(),dataType:"json",data:{},success:function(e){if(e.error){var t=e.error.message;toastr.error("    .<br>"+t)}else $("#btnSendMobileVerificationCode").fadeOut(),$(".inputVerificationWarper").fadeIn(),toastr.info("       ."),$(".inputVerificationWarper").removeClass("d-none");mUtil.scrollTo(".SendMobileVerificationCodeWarper",300),mApp.unblock(".SendMobileVerificationCodeWarper")},error:function(e,t,i){var a="";a=429===e.status?"          .       .":"    .",toastr.warning(a),mApp.unblock(".SendMobileVerificationCodeWarper")}})}),$(document).on("click","#btnVerifyMobileVerificationCode",function(){var e=$("#txtMobileVerificationCode").val();if(0===e.trim().length)return toastr.warning("    ."),!1;mApp.block(".SendMobileVerificationCodeWarper",{overlayColor:"#000000",type:"loader",state:"success",message:"  ..."}),$.ajax({type:"POST",url:$("#VerifyMobileVerificationCodeActionUrl").val(),data:{code:e},dataType:"json",success:function(e){if(e.error){var t=e.error.message;toastr.error("    .<br>"+t)}else $(".inputVerificationWarper").fadeOut(),$(".SendMobileVerificationCodeWarper").fadeOut(),$(".mobileUnVerifyMessage").removeClass("d-block"),$(".mobileUnVerifyMessage").addClass("d-none"),$(".mobileVerifyMessage").removeClass("d-none"),$(".mobileVerifyMessage").addClass("d-block"),updateUserCompletionProgress(e.user.info.completion),toastr.success("    ."),1===e.user.lockProfile&&window.location.reload();mApp.unblock(".SendMobileVerificationCodeWarper"),mUtil.scrollTo(".SendMobileVerificationCodeWarper",300)},error:function(e,t,i){var a="";a=403===e.status?"    .":422===e.status?"    .":"    .",toastr.error(a),mApp.unblock(".SendMobileVerificationCodeWarper")}})}),$(document).on("click",".profile-usermenu button",function(){var e=$(this).attr("menu");"profileMenuPage-sabteRotbe"===e?i():"profileMenuPage-filmVaJozve"===e||"profileMenuPage-setting"===e&&a()}),$(document).on("submit","#frmSabteRotbe",function(e){var t,i,a,n,r=(t=!0,i="",a=$('#frmSabteRotbe input[name="rank"]'),n=$('#frmSabteRotbe input[name="reportFile"]'),0===a.val().trim().length?(t=!1,i+="_  .<br>",a.parents(".form-group").addClass("has-danger")):isNaN(parseInt(a.val().toLocaleString("en").replace(",","")))||isNaN(a.val())?(t=!1,i+="    .<br>",a.parents(".form-group").addClass("has-danger")):a.parents(".form-group").removeClass("has-danger"),0===document.getElementById("reportFile").files.length?(t=!1,i+="    .<br>",n.parents(".form-group").addClass("has-danger")):n.parents(".form-group").removeClass("has-danger"),{status:t,message:i});if(!r.status)return toastr.warning(r.message),e.preventDefault(),!1});var n=decodeURIComponent(window.location.hash);"#_"===n?(console.log("sabte rotbe"),i()):"#_"===n?(console.log("etelaate shakhsi"),a()):(console.log("else"),a()),$(window).on("hashchange",function(){"#_"===window.location.hash?i():"#_"===window.location.hash&&a()})});
