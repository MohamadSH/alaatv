!function (e, t) {
    "function" == typeof define && define.amd ? define([], t.bind(this, e, e.videojs)) : "undefined" != typeof module && module.exports ? module.exports = t(e, e.videojs) : t(e, e.videojs)
}(window, function (e, t) {
    "use strict";
    e.videojs_pic2pic = {version: "0.3"};
    t.registerPlugin("pic2pic", function (s) {
        var n = this, i = n.el(), o = (document, {
            closeallow: !0,
            setting: !1,
            resolution: !1,
            logo: !1,
            audio: !1,
            subs: !1,
            desc: !1,
            chapters: !1,
            grid: !1,
            mirror: !1,
            share: !1,
            slide: !1,
            mute: !1,
            theater: !1,
            aspect: .5635,
            playback: !1,
            container: "block"
        });
        try {
            i.offsetHeight > 0 && i.offsetWidth > 0 && (o.aspect = i.offsetHeight / i.offsetWidth)
        } catch (e) {
        }
        var d, a, l = t.mergeOptions || t.util.mergeOptions;

        function c(e, t) {
            try {
                if (e) {
                    e.length || (e = [e]);
                    for (var s = 0, n = e.length; s < n; s++) null == r(e[s], t) && (e[s].className += " " + t, e[s].className.replace(/\s+/g, " "))
                }
            } catch (e) {
            }
        }

        function r(t, s) {
            if (t) {
                var n = new RegExp("(\\s|^)" + s + "(\\s|$)");
                return (void 0 === t.className ? e.event.srcElement : t).className.match(n)
            }
        }

        function v(e, t) {
            try {
                if (e && (e.classList.remove(t), r(e, t))) {
                    var s = new RegExp("(\\s|^)" + t + "(\\s|$)");
                    e.className = e.className.replace(s, " "), e.className.replace(/\s+/g, " ")
                }
            } catch (e) {
            }
        }

        function p(e, t) {
            return t || (t = document), t.querySelector(e)
        }

        s = l(o, s || {});

        var u = ".vjs-pic2pic {z-index:999998;cursor:pointer;position:fixed!important;max-width:360px!important;width:60%!important;padding:0!important;bottom:1%!important;right:0!important;}";

        u += ".vjs-global-close{border-bottom:solid 1px #444;background:#000;color:#fff;position:absolute;top:0;left:0;padding:0 5px;text-align:right;width:100%;z-index:10001;font-size:25px;height:30px;line-height:30px;font-family:sans-serif,Arial;font-weight:normal;}",
            u += ".vjs-global-close span {cursor:pointer;padding:0 5px}.vjs-global-close span:hover{color:#ccc}",
            function (e) {
            var t = document.head || document.getElementsByTagName("head")[0], s = document.createElement("style");
            s.type = "text/css", s.styleSheet ? s.styleSheet.cssText = e : s.appendChild(document.createTextNode(e)), t.appendChild(s)
        }(u += ".vjs-p2p-back {float:left;font-size:22px}.scale7{transform:scale(0.7);-webkit-transform:scale(0.7);-moz-transform:scale(0.7);o-transform:scale(0.7);-ms-transform:scale(0.7);}");

        var h, m, j, f, g, b = !1, y = "";

        return this.on("ready", function () {
            function t() {
                i.setAttribute("style", y), s.mute && (n.volume(s.def_volume), n.muted(s.def_muted)), v(i, "vjs-pic2pic"), v(p(".vjs-control-bar", i), "vjs-hidden"), v(p(".vjs-big-play-button", i), "vjs-hidden"), v(p(".vjs-info", i), "vjs-abs-hidden"), s.logo && v(p(".vjs-logo", i), "vjs-hidden"), s.settings && v(p(".vjs-cog-menu-button", i), "vjs-hidden"), s.resolution && v(p(".vjs-quality-button", i), "vjs-hidden"), s.theater && v(p(".vjs-mode-control", i), "vjs-hidden"), s.audio && v(p(".vjs-audio-button", i), "vjs-hidden"), s.subs && v(p(".vjs-subs-caps-button", i), "vjs-hidden"), s.desc && v(p(".vjs-descriptions-button", i), "vjs-hidden"), s.chapters && v(p(".vjs-chapters-button", i), "vjs-hidden"), s.slide && v(p(".vjs-progress-slide", i), "vjs-hidden"), s.mirror && v(p(".vjs-mirror-button", i), "vjs-hidden"), v(p(".vjs-big-play-button", i), "scale7"), p("video").style.top = "0px", p("video").style.maxHeight = "none", e.addEventListener ? (e.removeEventListener("resize", o), s.closeallow && a.removeEventListener("click", r), d.removeEventListener("click", l)) : e.detachEvent && (e.detachEvent("onresize", o), s.closeallow && a.detachEvent("onclick", p2p_click), d.detachEvent("onclick", l)), h.parentNode.removeChild(h)
            }

            function o() {
                if (1 == s.playback && b) {
                    var e = i.offsetWidth * s.aspect;
                    i.style.height = e + "px"
                }
            }

            function l() {
                b && (b = !1, t(), e.scrollTo(g, f))
            }

            function r() {
                b && (b = !1, t(), e.addEventListener ? e.removeEventListener("scroll", u) : e.detachEvent && e.detachEvent("scroll", u), e.scrollTo(g, f))
            }

            function u() {
                if (1 == s.playback) {
                    var u = e.scrollY || e.pageYOffset || document.documentElement.scrollTop;
                    u >= m ? function () {
                        if (!b) {
                            var t;
                            s.def_volume = n.volume(), s.def_muted = n.muted(), s.mute && n.muted(!0), p(".vjs-logo", i) && (s.logo = !0, c(p(".vjs-logo", i), "vjs-hidden")), p(".vjs-cog-menu-button", i) && (s.settings = !0, c(p(".vjs-cog-menu-button", i), "vjs-hidden")), p(".vjs-quality-button", i) && (s.resolution = !0, c(p(".vjs-quality-button", i), "vjs-hidden")), p(".vjs-mode-control", i) && (s.theater = !0, c(p(".vjs-mode-control", i), "vjs-hidden")), p(".vjs-mirror-button", i) && (s.theater = !0, c(p(".vjs-mirror-button", i), "vjs-hidden")), (t = p(".vjs-audio-button", i)) && -1 === t.className.indexOf("vjs-hidden") && (s.audio = !0, c(t, "vjs-hidden")), (t = p(".vjs-chapters-button", i)) && -1 === t.className.indexOf("vjs-hidden") && (s.audio = !0, c(t, "vjs-hidden")), (t = p(".vjs-descriptions-button", i)) && -1 === t.className.indexOf("vjs-hidden") && (s.audio = !0, c(t, "vjs-hidden")), p(".vjs-progress-slide", i) && c(p(".vjs-progress-slide", i), "vjs-hidden"), p(".vjs-info", i) && c(p(".vjs-info", i), "vjs-abs-hidden");
                            var u = p(".vjs-grid", i);
                            if (u) {
                                var m = u.className;
                                -1 == m.indexOf("vjs-hidden") && (c(u, "vjs-hidden"), v(p(".vjs-control-bar", i), "vjs-hidden"), v(p(".vjs-big-play-button", i), "vjs-hidden"))
                            }
                            var j = p(".vjs-sharing-overlay", i);
                            if (j) {
                                var f = j.className;
                                -1 == f.indexOf("vjs-hidden") && (c(j, "vjs-hidden"), v(p(".vjs-control-bar", i), "vjs-hidden"), v(p(".vjs-big-play-button", i), "vjs-hidden"))
                            }
                            i.className, c(p(".vjs-big-play-button", i), "scale7"), c(i, "vjs-pic2pic");
                            var g = i.offsetWidth * s.aspect;
                            i.style.height = g + 30 + "px", (h = document.createElement("div")).className = "vjs-global-close", (d = document.createElement("span")).innerHTML = "&nwarr;", d.className = "vjs-p2p-back", h.appendChild(d), d.setAttribute("title", n.localize("Back to video")), s.closeallow && ((a = document.createElement("span")).innerHTML = "x", a.setAttribute("title", n.localize("Close mini player")), h.appendChild(a)), i.appendChild(h), p("video").style.top = "30px", p("video").style.maxHeight = g + "px", d[e.addEventListener ? "addEventListener" : "attachEvent"](e.addEventListener ? "click" : "onclick", l, !1), s.closeallow && a[e.addEventListener ? "addEventListener" : "attachEvent"](e.addEventListener ? "click" : "onclick", r, !1), e[e.addEventListener ? "addEventListener" : "attachEvent"](e.addEventListener ? "resize" : "onresize", o, !1), b = !0
                        }
                    }() : b && u <= j && (b = !1, t())
                }
            }

            this.on("playing", function () {
                if (!s.playback) {
                    s.playback = !0;
                    var t = i.getBoundingClientRect(), n = t.bottom - t.top,
                        o = e.scrollY || e.pageYOffset || document.documentElement.scrollTop,
                        d = e.scrollX || e.pageXOffset || document.documentElement.scrollLeft;
                    m = t.top + o + .9 * n, f = t.top + o, j = m, "inline" == s.container && (j = t.top + o), g = t.left + d, f < 0 && (f = 0), t.top;
                    try {
                        y = i.getAttribute("style")
                    } catch (e) {
                    }
                    "" != y && (y = "visibility:visible;" + y),
                        e[e.addEventListener ? "addEventListener" : "attachEvent"](e.addEventListener ? "scroll" : "onscroll", u, !1)
                }
            })
        }), this
    })
});